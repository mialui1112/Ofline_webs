function n(n,t){return n.replace(/\{([^}]+)\}/g,(n,e)=>{if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];return null!=n?String(n):""}throw new Error(`Key '${e}' not found in valueMap.`)})}function t(n,e,o){for(let s=0;s<e.length-1;s++){const i=e[s];if(i.endsWith("[]")){const l=i.slice(0,-2);if(!(l in n)){if(!Array.isArray(o))throw new Error(`Value must be a list given an array path ${i}`);n[l]=Array.from({length:o.length},()=>({}))}if(Array.isArray(n[l])){const i=n[l];if(Array.isArray(o))for(let n=0;n<i.length;n++)t(i[n],e.slice(s+1),o[n]);else for(const n of i)t(n,e.slice(s+1),o)}return}if(i.endsWith("[0]")){const l=i.slice(0,-3);return l in n||(n[l]=[{}]),void t(n[l][0],e.slice(s+1),o)}n[i]&&"object"==typeof n[i]||(n[i]={}),n=n[i]}const i=e[e.length-1],l=n[i];if(void 0!==l){if(!o||"object"==typeof o&&0===Object.keys(o).length)return;if(o===l)return;if("object"!=typeof l||"object"!=typeof o||null===l||null===o)throw new Error(`Cannot set value for an existing key. Key: ${i}`);Object.assign(l,o)}else n[i]=o}function e(n,t){try{if(1===t.length&&"_self"===t[0])return n;for(let o=0;o<t.length;o++){if("object"!=typeof n||null===n)return;const i=t[o];if(i.endsWith("[]")){const l=i.slice(0,-2);if(l in n){const i=n[l];if(!Array.isArray(i))return;return i.map(n=>e(n,t.slice(o+1)))}return}n=n[i]}return n}catch(o){if(o instanceof TypeError)return;throw o}}function o(n,t){if(!t||"string"!=typeof t)throw new Error("model is required and must be a string");if(n.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}return`publishers/google/models/${t}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function i(n,t){const e=o(n,t);return e?e.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:e.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${e}`:e:""}function l(n){return Array.isArray(n)?n.map(n=>s(n)):[s(n)]}function s(n){if("object"==typeof n&&null!==n)return n;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof n)}function r(n){const t=s(n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function a(n){const t=s(n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function u(n){if(null==n)throw new Error("PartUnion is required");if("object"==typeof n)return n;if("string"==typeof n)return{text:n};throw new Error("Unsupported part type: "+typeof n)}function c(n){if(null==n||Array.isArray(n)&&0===n.length)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(n=>u(n)):[u(n)]}function p(n){return null!=n&&"object"==typeof n&&"parts"in n&&Array.isArray(n.parts)}function d(n){return null!=n&&"object"==typeof n&&"functionCall"in n}function f(n){return null!=n&&"object"==typeof n&&"functionResponse"in n}function m(n){if(null==n)throw new Error("ContentUnion is required");return p(n)?n:{role:"user",parts:c(n)}}function h(n,t){if(!t)return[];if(n.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const t=m(n);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(n.isVertexAI()){const n=m(t);return n.parts&&n.parts.length>0&&void 0!==n.parts[0].text?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>m(n)):[m(t)]}function g(n){if(null==n||Array.isArray(n)&&0===n.length)throw new Error("contents are required");if(!Array.isArray(n)){if(d(n)||f(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[m(n)]}const t=[],e=[],o=p(n[0]);for(const i of n){const n=p(i);if(n!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(n)t.push(i);else{if(d(i)||f(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");e.push(i)}}return o||t.push({role:"user",parts:c(e)}),t}function y(n){const t={},e=["items"],o=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;null!=l&&2==l.length&&("null"===l[0].type?(t.nullable=!0,n=l[1]):"null"===l[1].type&&(t.nullable=!0,n=l[0])),n.type instanceof Array&&function(n,t){n.includes("null")&&(t.nullable=!0);const e=n.filter(n=>"null"!==n);if(1===e.length)t.type=Object.values(Et).includes(e[0].toUpperCase())?e[0].toUpperCase():Et.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of e)t.anyOf.push({type:Object.values(Et).includes(n.toUpperCase())?n.toUpperCase():Et.TYPE_UNSPECIFIED})}}(n.type,t);for(const[s,r]of Object.entries(n))if(null!=r)if("type"==s){if("null"===r)throw new Error("type: null can not be the only possible type for the field.");if(r instanceof Array)continue;t.type=Object.values(Et).includes(r.toUpperCase())?r.toUpperCase():Et.TYPE_UNSPECIFIED}else if(e.includes(s))t[s]=y(r);else if(o.includes(s)){const n=[];for(const e of r)"null"!=e.type?n.push(y(e)):t.nullable=!0;t[s]=n}else if(i.includes(s)){const n={};for(const[t,e]of Object.entries(r))n[t]=y(e);t[s]=n}else{if("additionalProperties"===s)continue;t[s]=r}return t}function v(n){return y(n)}function C(n){if("object"==typeof n)return n;if("string"==typeof n)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error("Unsupported speechConfig type: "+typeof n)}function T(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function E(n){if(n.functionDeclarations)for(const t of n.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=y(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=y(t.response));return n}function A(n){if(null==n)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const t=[];for(const e of n)t.push(e);return t}function _(n,t){if("string"!=typeof t)throw new Error("name must be a string");return function(n,t,e,o=1){const i=!t.startsWith(`${e}/`)&&t.split("/").length===o;return n.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${n.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}/${t}`:t:i?`${e}/${t}`:t}(n,t,"cachedContents")}function O(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function S(n){if("string"!=typeof n)throw new Error("fromImageBytes must be a string");return n}function I(n){var t,e;let o;if(null!=(e=n)&&"object"==typeof e&&"name"in e&&(o=n.name),!(function(n){return null!=n&&"object"==typeof n&&"uri"in n}(n)&&(o=n.uri,void 0===o)||function(n){return null!=n&&"object"==typeof n&&"video"in n}(n)&&(o=null===(t=n.video)||void 0===t?void 0:t.uri,void 0===o))){if("string"==typeof n&&(o=n),void 0===o)throw new Error("Could not extract file name from the provided input.");if(o.startsWith("https://")){const n=o.split("files/")[1].match(/[a-z0-9]+/);if(null===n)throw new Error(`Could not extract file name from URI ${o}`);o=n[0]}else o.startsWith("files/")&&(o=o.split("files/")[1]);return o}}function b(n,t){let e;return e=n.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",e}function N(n){for(const t of["models","tunedModels","publisherModels"])if(P(n,t))return n[t];return[]}function P(n,t){return null!==n&&"object"==typeof n&&t in n}function w(n,t={}){const e=n,o={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return t.behavior&&(o.behavior=t.behavior),{functionDeclarations:[o]}}function R(n,t){if("string"!=typeof t&&!Array.isArray(t)){if(n&&n.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}if(Array.isArray(t))return{inlinedRequests:t};if("string"==typeof t){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}throw new Error(`Unsupported source: ${t}`)}function M(n,t){const e=t;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(e))return e.split("/").pop();throw new Error(`Invalid batch job name: ${e}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(e))return e.split("/").pop();if(/^\d+$/.test(e))return e;throw new Error(`Invalid batch job name: ${e}.`)}function D(n){return"BATCH_STATE_UNSPECIFIED"===n?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===n?"JOB_STATE_PENDING":"BATCH_STATE_SUCCEEDED"===n?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===n?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===n?"JOB_STATE_CANCELLED":n}function U(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}function x(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["behavior"]);null!=i&&t(o,["behavior"],i);const l=e(n,["description"]);null!=l&&t(o,["description"],l);const s=e(n,["name"]);null!=s&&t(o,["name"],s);const r=e(n,["parameters"]);null!=r&&t(o,["parameters"],r);const a=e(n,["parametersJsonSchema"]);null!=a&&t(o,["parametersJsonSchema"],a);const u=e(n,["response"]);null!=u&&t(o,["response"],u);const c=e(n,["responseJsonSchema"]);return null!=c&&t(o,["responseJsonSchema"],c),o}(n))),t(o,["functionDeclarations"],n)}if(void 0!==e(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const l=e(n,["googleSearch"]);null!=l&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(l));const s=e(n,["googleSearchRetrieval"]);if(null!=s&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(s)),void 0!==e(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==e(n,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const r=e(n,["codeExecution"]);null!=r&&t(o,["codeExecution"],r);const a=e(n,["computerUse"]);return null!=a&&t(o,["computerUse"],a),o}function L(n){const o={},i=e(n,["functionCallingConfig"]);null!=i&&t(o,["functionCallingConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["allowedFunctionNames"]);return null!=l&&t(o,["allowedFunctionNames"],l),o}(i));const l=e(n,["retrievalConfig"]);return null!=l&&t(o,["retrievalConfig"],function(n){const o={},i=e(n,["latLng"]);null!=i&&t(o,["latLng"],function(n){const o={},i=e(n,["latitude"]);null!=i&&t(o,["latitude"],i);const l=e(n,["longitude"]);return null!=l&&t(o,["longitude"],l),o}(i));const l=e(n,["languageCode"]);return null!=l&&t(o,["languageCode"],l),o}(l)),o}function q(n){const o={},i=e(n,["prebuiltVoiceConfig"]);return null!=i&&t(o,["prebuiltVoiceConfig"],function(n){const o={},i=e(n,["voiceName"]);return null!=i&&t(o,["voiceName"],i),o}(i)),o}function k(n,o,i){const l={},s=e(o,["systemInstruction"]);void 0!==i&&null!=s&&t(i,["systemInstruction"],U(m(s)));const r=e(o,["temperature"]);null!=r&&t(l,["temperature"],r);const a=e(o,["topP"]);null!=a&&t(l,["topP"],a);const u=e(o,["topK"]);null!=u&&t(l,["topK"],u);const c=e(o,["candidateCount"]);null!=c&&t(l,["candidateCount"],c);const p=e(o,["maxOutputTokens"]);null!=p&&t(l,["maxOutputTokens"],p);const d=e(o,["stopSequences"]);null!=d&&t(l,["stopSequences"],d);const f=e(o,["responseLogprobs"]);null!=f&&t(l,["responseLogprobs"],f);const h=e(o,["logprobs"]);null!=h&&t(l,["logprobs"],h);const g=e(o,["presencePenalty"]);null!=g&&t(l,["presencePenalty"],g);const y=e(o,["frequencyPenalty"]);null!=y&&t(l,["frequencyPenalty"],y);const T=e(o,["seed"]);null!=T&&t(l,["seed"],T);const O=e(o,["responseMimeType"]);null!=O&&t(l,["responseMimeType"],O);const S=e(o,["responseSchema"]);null!=S&&t(l,["responseSchema"],function(n){const o={},i=e(n,["anyOf"]);null!=i&&t(o,["anyOf"],i);const l=e(n,["default"]);null!=l&&t(o,["default"],l);const s=e(n,["description"]);null!=s&&t(o,["description"],s);const r=e(n,["enum"]);null!=r&&t(o,["enum"],r);const a=e(n,["example"]);null!=a&&t(o,["example"],a);const u=e(n,["format"]);null!=u&&t(o,["format"],u);const c=e(n,["items"]);null!=c&&t(o,["items"],c);const p=e(n,["maxItems"]);null!=p&&t(o,["maxItems"],p);const d=e(n,["maxLength"]);null!=d&&t(o,["maxLength"],d);const f=e(n,["maxProperties"]);null!=f&&t(o,["maxProperties"],f);const m=e(n,["maximum"]);null!=m&&t(o,["maximum"],m);const h=e(n,["minItems"]);null!=h&&t(o,["minItems"],h);const g=e(n,["minLength"]);null!=g&&t(o,["minLength"],g);const y=e(n,["minProperties"]);null!=y&&t(o,["minProperties"],y);const v=e(n,["minimum"]);null!=v&&t(o,["minimum"],v);const C=e(n,["nullable"]);null!=C&&t(o,["nullable"],C);const T=e(n,["pattern"]);null!=T&&t(o,["pattern"],T);const E=e(n,["properties"]);null!=E&&t(o,["properties"],E);const A=e(n,["propertyOrdering"]);null!=A&&t(o,["propertyOrdering"],A);const _=e(n,["required"]);null!=_&&t(o,["required"],_);const O=e(n,["title"]);null!=O&&t(o,["title"],O);const S=e(n,["type"]);return null!=S&&t(o,["type"],S),o}(v(S)));const I=e(o,["responseJsonSchema"]);if(null!=I&&t(l,["responseJsonSchema"],I),void 0!==e(o,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==e(o,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=e(o,["safetySettings"]);if(void 0!==i&&null!=b){let n=b;Array.isArray(n)&&(n=n.map(n=>function(n){const o={};if(void 0!==e(n,["method"]))throw new Error("method parameter is not supported in Gemini API.");const i=e(n,["category"]);null!=i&&t(o,["category"],i);const l=e(n,["threshold"]);return null!=l&&t(o,["threshold"],l),o}(n))),t(i,["safetySettings"],n)}const N=e(o,["tools"]);if(void 0!==i&&null!=N){let n=A(N);Array.isArray(n)&&(n=n.map(n=>x(E(n)))),t(i,["tools"],n)}const P=e(o,["toolConfig"]);if(void 0!==i&&null!=P&&t(i,["toolConfig"],L(P)),void 0!==e(o,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const w=e(o,["cachedContent"]);void 0!==i&&null!=w&&t(i,["cachedContent"],_(n,w));const R=e(o,["responseModalities"]);null!=R&&t(l,["responseModalities"],R);const M=e(o,["mediaResolution"]);null!=M&&t(l,["mediaResolution"],M);const D=e(o,["speechConfig"]);if(null!=D&&t(l,["speechConfig"],function(n){const o={},i=e(n,["voiceConfig"]);null!=i&&t(o,["voiceConfig"],q(i));const l=e(n,["multiSpeakerVoiceConfig"]);null!=l&&t(o,["multiSpeakerVoiceConfig"],function(n){const o={},i=e(n,["speakerVoiceConfigs"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["speaker"]);null!=i&&t(o,["speaker"],i);const l=e(n,["voiceConfig"]);return null!=l&&t(o,["voiceConfig"],q(l)),o}(n))),t(o,["speakerVoiceConfigs"],n)}return o}(l));const s=e(n,["languageCode"]);return null!=s&&t(o,["languageCode"],s),o}(C(D))),void 0!==e(o,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=e(o,["thinkingConfig"]);return null!=k&&t(l,["thinkingConfig"],function(n){const o={},i=e(n,["includeThoughts"]);null!=i&&t(o,["includeThoughts"],i);const l=e(n,["thinkingBudget"]);return null!=l&&t(o,["thinkingBudget"],l),o}(k)),l}function G(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["src"]);null!=r&&t(l,["batch","inputConfig"],function(n,i){const l={};if(void 0!==e(i,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==e(i,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==e(i,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=e(i,["fileName"]);null!=s&&t(l,["fileName"],s);const r=e(i,["inlinedRequests"]);if(null!=r){let i=r;Array.isArray(i)&&(i=i.map(i=>function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["request","model"],o(n,s));const r=e(i,["contents"]);if(null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>U(n))),t(l,["request","contents"],n)}const a=e(i,["config"]);return null!=a&&t(l,["request","generationConfig"],k(n,a,l)),l}(n,i))),t(l,["requests","requests"],i)}return l}(n,R(n,r)));const a=e(i,["config"]);return null!=a&&t(l,["config"],function(n,o){const i=e(n,["displayName"]);if(void 0!==o&&null!=i&&t(o,["batch","displayName"],i),void 0!==e(n,["dest"]))throw new Error("dest parameter is not supported in Gemini API.");return{}}(a,l)),l}function F(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["model"],o(n,s));const r=e(i,["src"]);null!=r&&t(l,["inputConfig"],function(n){const o={},i=e(n,["format"]);null!=i&&t(o,["instancesFormat"],i);const l=e(n,["gcsUri"]);null!=l&&t(o,["gcsSource","uris"],l);const s=e(n,["bigqueryUri"]);if(null!=s&&t(o,["bigquerySource","inputUri"],s),void 0!==e(n,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==e(n,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return o}(R(n,r)));const a=e(i,["config"]);return null!=a&&t(l,["config"],function(n,o){const i=e(n,["displayName"]);void 0!==o&&null!=i&&t(o,["displayName"],i);const l=e(n,["dest"]);return void 0!==o&&null!=l&&t(o,["outputConfig"],function(n){const o={},i=e(n,["format"]);null!=i&&t(o,["predictionsFormat"],i);const l=e(n,["gcsUri"]);null!=l&&t(o,["gcsDestination","outputUriPrefix"],l);const s=e(n,["bigqueryUri"]);if(null!=s&&t(o,["bigqueryDestination","outputUri"],s),void 0!==e(n,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==e(n,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return o}(function(n){const t=n;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}(l))),{}}(a,l)),l}function j(n){const o={},i=e(n,["content"]);null!=i&&t(o,["content"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(i));const l=e(n,["citationMetadata"]);null!=l&&t(o,["citationMetadata"],function(n){const o={},i=e(n,["citationSources"]);return null!=i&&t(o,["citations"],i),o}(l));const s=e(n,["tokenCount"]);null!=s&&t(o,["tokenCount"],s);const r=e(n,["finishReason"]);null!=r&&t(o,["finishReason"],r);const a=e(n,["urlContextMetadata"]);null!=a&&t(o,["urlContextMetadata"],function(n){const o={},i=e(n,["urlMetadata"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["retrievedUrl"]);null!=i&&t(o,["retrievedUrl"],i);const l=e(n,["urlRetrievalStatus"]);return null!=l&&t(o,["urlRetrievalStatus"],l),o}(n))),t(o,["urlMetadata"],n)}return o}(a));const u=e(n,["avgLogprobs"]);null!=u&&t(o,["avgLogprobs"],u);const c=e(n,["groundingMetadata"]);null!=c&&t(o,["groundingMetadata"],c);const p=e(n,["index"]);null!=p&&t(o,["index"],p);const d=e(n,["logprobsResult"]);null!=d&&t(o,["logprobsResult"],d);const f=e(n,["safetyRatings"]);return null!=f&&t(o,["safetyRatings"],f),o}function V(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["metadata","displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["metadata","state"]);null!=s&&t(o,["state"],D(s));const r=e(n,["metadata","createTime"]);null!=r&&t(o,["createTime"],r);const a=e(n,["metadata","endTime"]);null!=a&&t(o,["endTime"],a);const u=e(n,["metadata","updateTime"]);null!=u&&t(o,["updateTime"],u);const c=e(n,["metadata","model"]);null!=c&&t(o,["model"],c);const p=e(n,["metadata","output"]);return null!=p&&t(o,["dest"],function(n){const o={},i=e(n,["responsesFile"]);null!=i&&t(o,["fileName"],i);const l=e(n,["inlinedResponses","inlinedResponses"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["response"]);return null!=i&&t(o,["response"],function(n){const o={},i=e(n,["candidates"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>j(n))),t(o,["candidates"],n)}const l=e(n,["modelVersion"]);null!=l&&t(o,["modelVersion"],l);const s=e(n,["promptFeedback"]);null!=s&&t(o,["promptFeedback"],s);const r=e(n,["usageMetadata"]);return null!=r&&t(o,["usageMetadata"],r),o}(i)),null!=e(n,["error"])&&t(o,["error"],{}),o}(n))),t(o,["inlinedResponses"],n)}return o}(p)),o}function J(n){const o={},i=e(n,["details"]);null!=i&&t(o,["details"],i);const l=e(n,["code"]);null!=l&&t(o,["code"],l);const s=e(n,["message"]);return null!=s&&t(o,["message"],s),o}function B(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["state"]);null!=s&&t(o,["state"],D(s));const r=e(n,["error"]);null!=r&&t(o,["error"],J(r));const a=e(n,["createTime"]);null!=a&&t(o,["createTime"],a);const u=e(n,["startTime"]);null!=u&&t(o,["startTime"],u);const c=e(n,["endTime"]);null!=c&&t(o,["endTime"],c);const p=e(n,["updateTime"]);null!=p&&t(o,["updateTime"],p);const d=e(n,["model"]);null!=d&&t(o,["model"],d);const f=e(n,["inputConfig"]);null!=f&&t(o,["src"],function(n){const o={},i=e(n,["instancesFormat"]);null!=i&&t(o,["format"],i);const l=e(n,["gcsSource","uris"]);null!=l&&t(o,["gcsUri"],l);const s=e(n,["bigquerySource","inputUri"]);return null!=s&&t(o,["bigqueryUri"],s),o}(f));const m=e(n,["outputConfig"]);return null!=m&&t(o,["dest"],function(n){const o={},i=e(n,["predictionsFormat"]);null!=i&&t(o,["format"],i);const l=e(n,["gcsDestination","outputUriPrefix"]);null!=l&&t(o,["gcsUri"],l);const s=e(n,["bigqueryDestination","outputUri"]);return null!=s&&t(o,["bigqueryUri"],s),o}(m)),o}function H(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}function Y(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["behavior"]);null!=i&&t(o,["behavior"],i);const l=e(n,["description"]);null!=l&&t(o,["description"],l);const s=e(n,["name"]);null!=s&&t(o,["name"],s);const r=e(n,["parameters"]);null!=r&&t(o,["parameters"],r);const a=e(n,["parametersJsonSchema"]);null!=a&&t(o,["parametersJsonSchema"],a);const u=e(n,["response"]);null!=u&&t(o,["response"],u);const c=e(n,["responseJsonSchema"]);return null!=c&&t(o,["responseJsonSchema"],c),o}(n))),t(o,["functionDeclarations"],n)}if(void 0!==e(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const l=e(n,["googleSearch"]);null!=l&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(l));const s=e(n,["googleSearchRetrieval"]);if(null!=s&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(s)),void 0!==e(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==e(n,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const r=e(n,["codeExecution"]);null!=r&&t(o,["codeExecution"],r);const a=e(n,["computerUse"]);return null!=a&&t(o,["computerUse"],a),o}function K(n){const o={},i=e(n,["functionCallingConfig"]);null!=i&&t(o,["functionCallingConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["allowedFunctionNames"]);return null!=l&&t(o,["allowedFunctionNames"],l),o}(i));const l=e(n,["retrievalConfig"]);return null!=l&&t(o,["retrievalConfig"],function(n){const o={},i=e(n,["latLng"]);null!=i&&t(o,["latLng"],function(n){const o={},i=e(n,["latitude"]);null!=i&&t(o,["latitude"],i);const l=e(n,["longitude"]);return null!=l&&t(o,["longitude"],l),o}(i));const l=e(n,["languageCode"]);return null!=l&&t(o,["languageCode"],l),o}(l)),o}function W(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["data"]);null!=l&&t(o,["data"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["fileUri"]);null!=l&&t(o,["fileUri"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}function $(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={};if(void 0!==e(n,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const i=e(n,["description"]);null!=i&&t(o,["description"],i);const l=e(n,["name"]);null!=l&&t(o,["name"],l);const s=e(n,["parameters"]);null!=s&&t(o,["parameters"],s);const r=e(n,["parametersJsonSchema"]);null!=r&&t(o,["parametersJsonSchema"],r);const a=e(n,["response"]);null!=a&&t(o,["response"],a);const u=e(n,["responseJsonSchema"]);return null!=u&&t(o,["responseJsonSchema"],u),o}(n))),t(o,["functionDeclarations"],n)}const l=e(n,["retrieval"]);null!=l&&t(o,["retrieval"],l);const s=e(n,["googleSearch"]);null!=s&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(s));const r=e(n,["googleSearchRetrieval"]);null!=r&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(r)),null!=e(n,["enterpriseWebSearch"])&&t(o,["enterpriseWebSearch"],{});const a=e(n,["googleMaps"]);null!=a&&t(o,["googleMaps"],function(n){const o={},i=e(n,["authConfig"]);return null!=i&&t(o,["authConfig"],function(n){const o={},i=e(n,["apiKeyConfig"]);null!=i&&t(o,["apiKeyConfig"],function(n){const o={},i=e(n,["apiKeyString"]);return null!=i&&t(o,["apiKeyString"],i),o}(i));const l=e(n,["authType"]);null!=l&&t(o,["authType"],l);const s=e(n,["googleServiceAccountConfig"]);null!=s&&t(o,["googleServiceAccountConfig"],s);const r=e(n,["httpBasicAuthConfig"]);null!=r&&t(o,["httpBasicAuthConfig"],r);const a=e(n,["oauthConfig"]);null!=a&&t(o,["oauthConfig"],a);const u=e(n,["oidcConfig"]);return null!=u&&t(o,["oidcConfig"],u),o}(i)),o}(a)),null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const u=e(n,["codeExecution"]);null!=u&&t(o,["codeExecution"],u);const c=e(n,["computerUse"]);return null!=c&&t(o,["computerUse"],c),o}function z(n){const o={},i=e(n,["functionCallingConfig"]);null!=i&&t(o,["functionCallingConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["allowedFunctionNames"]);return null!=l&&t(o,["allowedFunctionNames"],l),o}(i));const l=e(n,["retrievalConfig"]);return null!=l&&t(o,["retrievalConfig"],function(n){const o={},i=e(n,["latLng"]);null!=i&&t(o,["latLng"],function(n){const o={},i=e(n,["latitude"]);null!=i&&t(o,["latitude"],i);const l=e(n,["longitude"]);return null!=l&&t(o,["longitude"],l),o}(i));const l=e(n,["languageCode"]);return null!=l&&t(o,["languageCode"],l),o}(l)),o}function X(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["model"]);null!=s&&t(o,["model"],s);const r=e(n,["createTime"]);null!=r&&t(o,["createTime"],r);const a=e(n,["updateTime"]);null!=a&&t(o,["updateTime"],a);const u=e(n,["expireTime"]);null!=u&&t(o,["expireTime"],u);const c=e(n,["usageMetadata"]);return null!=c&&t(o,["usageMetadata"],c),o}function Z(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["model"]);null!=s&&t(o,["model"],s);const r=e(n,["createTime"]);null!=r&&t(o,["createTime"],r);const a=e(n,["updateTime"]);null!=a&&t(o,["updateTime"],a);const u=e(n,["expireTime"]);null!=u&&t(o,["expireTime"],u);const c=e(n,["usageMetadata"]);return null!=c&&t(o,["usageMetadata"],c),o}function Q(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],o=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function nn(n){return this instanceof nn?(this.v=n,this):new nn(n)}function tn(n,t,e){function o(n,t){u[n]&&(a[n]=function(t){return new Promise(function(e,o){c.push([n,t,e,o])>1||i(n,t)})},t&&(a[n]=t(a[n])))}function i(n,t){try{(e=u[n](t)).value instanceof nn?Promise.resolve(e.value.v).then(l,s):r(c[0][2],e)}catch(o){r(c[0][3],o)}var e}function l(n){i("next",n)}function s(n){i("throw",n)}function r(n,t){n(t),c.shift(),c.length&&i(c[0][0],c[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,u=e.apply(n,t||[]),c=[];return a=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(n){return function(t){return Promise.resolve(t).then(n,s)}}),a[Symbol.asyncIterator]=function(){return this},a}function en(n){function t(t){e[t]=n[t]&&function(e){return new Promise(function(o,i){!function(n,t,e,o){Promise.resolve(o).then(function(t){n({value:t,done:e})},t)}(o,i,(e=n[t](e)).done,e.value)})}}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,o=n[Symbol.asyncIterator];return o?o.call(n):(n="function"==typeof Q?Q(n):n[Symbol.iterator](),e={},t("next"),t("throw"),t("return"),e[Symbol.asyncIterator]=function(){return this},e)}function on(n){var t;if(null==n.candidates||0===n.candidates.length)return!1;const e=null===(t=n.candidates[0])||void 0===t?void 0:t.content;return void 0!==e&&ln(e)}function ln(n){if(void 0===n.parts||0===n.parts.length)return!1;for(const t of n.parts){if(void 0===t||0===Object.keys(t).length)return!1;if(!t.thought&&void 0!==t.text&&""===t.text)return!1}return!0}function sn(n){if(void 0===n||0===n.length)return[];const t=[],e=n.length;let o=0;for(;o<e;)if("user"===n[o].role)t.push(n[o]),o++;else{const i=[];let l=!0;for(;o<e&&"model"===n[o].role;)i.push(n[o]),l&&!ln(n[o])&&(l=!1),o++;l?t.push(...i):t.pop()}return t}function rn(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["mimeType"]);null!=s&&t(o,["mimeType"],s);const r=e(n,["sizeBytes"]);null!=r&&t(o,["sizeBytes"],r);const a=e(n,["createTime"]);null!=a&&t(o,["createTime"],a);const u=e(n,["expirationTime"]);null!=u&&t(o,["expirationTime"],u);const c=e(n,["updateTime"]);null!=c&&t(o,["updateTime"],c);const p=e(n,["sha256Hash"]);null!=p&&t(o,["sha256Hash"],p);const d=e(n,["uri"]);null!=d&&t(o,["uri"],d);const f=e(n,["downloadUri"]);null!=f&&t(o,["downloadUri"],f);const m=e(n,["state"]);null!=m&&t(o,["state"],m);const h=e(n,["source"]);null!=h&&t(o,["source"],h);const g=e(n,["videoMetadata"]);null!=g&&t(o,["videoMetadata"],g);const y=e(n,["error"]);return null!=y&&t(o,["error"],function(n){const o={},i=e(n,["details"]);null!=i&&t(o,["details"],i);const l=e(n,["message"]);null!=l&&t(o,["message"],l);const s=e(n,["code"]);return null!=s&&t(o,["code"],s),o}(y)),o}function an(n){const o={},i=e(n,["prebuiltVoiceConfig"]);return null!=i&&t(o,["prebuiltVoiceConfig"],function(n){const o={},i=e(n,["voiceName"]);return null!=i&&t(o,["voiceName"],i),o}(i)),o}function un(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["behavior"]);null!=i&&t(o,["behavior"],i);const l=e(n,["description"]);null!=l&&t(o,["description"],l);const s=e(n,["name"]);null!=s&&t(o,["name"],s);const r=e(n,["parameters"]);null!=r&&t(o,["parameters"],r);const a=e(n,["parametersJsonSchema"]);null!=a&&t(o,["parametersJsonSchema"],a);const u=e(n,["response"]);null!=u&&t(o,["response"],u);const c=e(n,["responseJsonSchema"]);return null!=c&&t(o,["responseJsonSchema"],c),o}(n))),t(o,["functionDeclarations"],n)}if(void 0!==e(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const l=e(n,["googleSearch"]);null!=l&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(l));const s=e(n,["googleSearchRetrieval"]);if(null!=s&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(s)),void 0!==e(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==e(n,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const r=e(n,["codeExecution"]);null!=r&&t(o,["codeExecution"],r);const a=e(n,["computerUse"]);return null!=a&&t(o,["computerUse"],a),o}function cn(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={};if(void 0!==e(n,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const i=e(n,["description"]);null!=i&&t(o,["description"],i);const l=e(n,["name"]);null!=l&&t(o,["name"],l);const s=e(n,["parameters"]);null!=s&&t(o,["parameters"],s);const r=e(n,["parametersJsonSchema"]);null!=r&&t(o,["parametersJsonSchema"],r);const a=e(n,["response"]);null!=a&&t(o,["response"],a);const u=e(n,["responseJsonSchema"]);return null!=u&&t(o,["responseJsonSchema"],u),o}(n))),t(o,["functionDeclarations"],n)}const l=e(n,["retrieval"]);null!=l&&t(o,["retrieval"],l);const s=e(n,["googleSearch"]);null!=s&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(s));const r=e(n,["googleSearchRetrieval"]);null!=r&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(r)),null!=e(n,["enterpriseWebSearch"])&&t(o,["enterpriseWebSearch"],{});const a=e(n,["googleMaps"]);null!=a&&t(o,["googleMaps"],function(n){const o={},i=e(n,["authConfig"]);return null!=i&&t(o,["authConfig"],function(n){const o={},i=e(n,["apiKeyConfig"]);null!=i&&t(o,["apiKeyConfig"],function(n){const o={},i=e(n,["apiKeyString"]);return null!=i&&t(o,["apiKeyString"],i),o}(i));const l=e(n,["authType"]);null!=l&&t(o,["authType"],l);const s=e(n,["googleServiceAccountConfig"]);null!=s&&t(o,["googleServiceAccountConfig"],s);const r=e(n,["httpBasicAuthConfig"]);null!=r&&t(o,["httpBasicAuthConfig"],r);const a=e(n,["oauthConfig"]);null!=a&&t(o,["oauthConfig"],a);const u=e(n,["oidcConfig"]);return null!=u&&t(o,["oidcConfig"],u),o}(i)),o}(a)),null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const u=e(n,["codeExecution"]);null!=u&&t(o,["codeExecution"],u);const c=e(n,["computerUse"]);return null!=c&&t(o,["computerUse"],c),o}function pn(n,o){const i=e(n,["generationConfig"]);void 0!==o&&null!=i&&t(o,["setup","generationConfig"],i);const l=e(n,["responseModalities"]);void 0!==o&&null!=l&&t(o,["setup","generationConfig","responseModalities"],l);const s=e(n,["temperature"]);void 0!==o&&null!=s&&t(o,["setup","generationConfig","temperature"],s);const r=e(n,["topP"]);void 0!==o&&null!=r&&t(o,["setup","generationConfig","topP"],r);const a=e(n,["topK"]);void 0!==o&&null!=a&&t(o,["setup","generationConfig","topK"],a);const u=e(n,["maxOutputTokens"]);void 0!==o&&null!=u&&t(o,["setup","generationConfig","maxOutputTokens"],u);const c=e(n,["mediaResolution"]);void 0!==o&&null!=c&&t(o,["setup","generationConfig","mediaResolution"],c);const p=e(n,["seed"]);void 0!==o&&null!=p&&t(o,["setup","generationConfig","seed"],p);const d=e(n,["speechConfig"]);void 0!==o&&null!=d&&t(o,["setup","generationConfig","speechConfig"],function(n){const o={},i=e(n,["voiceConfig"]);null!=i&&t(o,["voiceConfig"],an(i));const l=e(n,["multiSpeakerVoiceConfig"]);null!=l&&t(o,["multiSpeakerVoiceConfig"],function(n){const o={},i=e(n,["speakerVoiceConfigs"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["speaker"]);null!=i&&t(o,["speaker"],i);const l=e(n,["voiceConfig"]);return null!=l&&t(o,["voiceConfig"],an(l)),o}(n))),t(o,["speakerVoiceConfigs"],n)}return o}(l));const s=e(n,["languageCode"]);return null!=s&&t(o,["languageCode"],s),o}(T(d)));const f=e(n,["enableAffectiveDialog"]);void 0!==o&&null!=f&&t(o,["setup","generationConfig","enableAffectiveDialog"],f);const h=e(n,["systemInstruction"]);void 0!==o&&null!=h&&t(o,["setup","systemInstruction"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(m(h)));const g=e(n,["tools"]);if(void 0!==o&&null!=g){let n=A(g);Array.isArray(n)&&(n=n.map(n=>un(E(n)))),t(o,["setup","tools"],n)}const y=e(n,["sessionResumption"]);void 0!==o&&null!=y&&t(o,["setup","sessionResumption"],function(n){const o={},i=e(n,["handle"]);if(null!=i&&t(o,["handle"],i),void 0!==e(n,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return o}(y));const v=e(n,["inputAudioTranscription"]);void 0!==o&&null!=v&&t(o,["setup","inputAudioTranscription"],{});const C=e(n,["outputAudioTranscription"]);void 0!==o&&null!=C&&t(o,["setup","outputAudioTranscription"],{});const _=e(n,["realtimeInputConfig"]);void 0!==o&&null!=_&&t(o,["setup","realtimeInputConfig"],function(n){const o={},i=e(n,["automaticActivityDetection"]);null!=i&&t(o,["automaticActivityDetection"],function(n){const o={},i=e(n,["disabled"]);null!=i&&t(o,["disabled"],i);const l=e(n,["startOfSpeechSensitivity"]);null!=l&&t(o,["startOfSpeechSensitivity"],l);const s=e(n,["endOfSpeechSensitivity"]);null!=s&&t(o,["endOfSpeechSensitivity"],s);const r=e(n,["prefixPaddingMs"]);null!=r&&t(o,["prefixPaddingMs"],r);const a=e(n,["silenceDurationMs"]);return null!=a&&t(o,["silenceDurationMs"],a),o}(i));const l=e(n,["activityHandling"]);null!=l&&t(o,["activityHandling"],l);const s=e(n,["turnCoverage"]);return null!=s&&t(o,["turnCoverage"],s),o}(_));const O=e(n,["contextWindowCompression"]);void 0!==o&&null!=O&&t(o,["setup","contextWindowCompression"],function(n){const o={},i=e(n,["triggerTokens"]);null!=i&&t(o,["triggerTokens"],i);const l=e(n,["slidingWindow"]);return null!=l&&t(o,["slidingWindow"],function(n){const o={},i=e(n,["targetTokens"]);return null!=i&&t(o,["targetTokens"],i),o}(l)),o}(O));const S=e(n,["proactivity"]);return void 0!==o&&null!=S&&t(o,["setup","proactivity"],function(n){const o={},i=e(n,["proactiveAudio"]);return null!=i&&t(o,["proactiveAudio"],i),o}(S)),{}}function dn(n,o){const i=e(n,["generationConfig"]);void 0!==o&&null!=i&&t(o,["setup","generationConfig"],i);const l=e(n,["responseModalities"]);void 0!==o&&null!=l&&t(o,["setup","generationConfig","responseModalities"],l);const s=e(n,["temperature"]);void 0!==o&&null!=s&&t(o,["setup","generationConfig","temperature"],s);const r=e(n,["topP"]);void 0!==o&&null!=r&&t(o,["setup","generationConfig","topP"],r);const a=e(n,["topK"]);void 0!==o&&null!=a&&t(o,["setup","generationConfig","topK"],a);const u=e(n,["maxOutputTokens"]);void 0!==o&&null!=u&&t(o,["setup","generationConfig","maxOutputTokens"],u);const c=e(n,["mediaResolution"]);void 0!==o&&null!=c&&t(o,["setup","generationConfig","mediaResolution"],c);const p=e(n,["seed"]);void 0!==o&&null!=p&&t(o,["setup","generationConfig","seed"],p);const d=e(n,["speechConfig"]);void 0!==o&&null!=d&&t(o,["setup","generationConfig","speechConfig"],function(n){const o={},i=e(n,["voiceConfig"]);if(null!=i&&t(o,["voiceConfig"],function(n){const o={},i=e(n,["prebuiltVoiceConfig"]);return null!=i&&t(o,["prebuiltVoiceConfig"],function(n){const o={},i=e(n,["voiceName"]);return null!=i&&t(o,["voiceName"],i),o}(i)),o}(i)),void 0!==e(n,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const l=e(n,["languageCode"]);return null!=l&&t(o,["languageCode"],l),o}(T(d)));const f=e(n,["enableAffectiveDialog"]);void 0!==o&&null!=f&&t(o,["setup","generationConfig","enableAffectiveDialog"],f);const h=e(n,["systemInstruction"]);void 0!==o&&null!=h&&t(o,["setup","systemInstruction"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["data"]);null!=l&&t(o,["data"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["fileUri"]);null!=l&&t(o,["fileUri"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(m(h)));const g=e(n,["tools"]);if(void 0!==o&&null!=g){let n=A(g);Array.isArray(n)&&(n=n.map(n=>cn(E(n)))),t(o,["setup","tools"],n)}const y=e(n,["sessionResumption"]);void 0!==o&&null!=y&&t(o,["setup","sessionResumption"],function(n){const o={},i=e(n,["handle"]);null!=i&&t(o,["handle"],i);const l=e(n,["transparent"]);return null!=l&&t(o,["transparent"],l),o}(y));const v=e(n,["inputAudioTranscription"]);void 0!==o&&null!=v&&t(o,["setup","inputAudioTranscription"],{});const C=e(n,["outputAudioTranscription"]);void 0!==o&&null!=C&&t(o,["setup","outputAudioTranscription"],{});const _=e(n,["realtimeInputConfig"]);void 0!==o&&null!=_&&t(o,["setup","realtimeInputConfig"],function(n){const o={},i=e(n,["automaticActivityDetection"]);null!=i&&t(o,["automaticActivityDetection"],function(n){const o={},i=e(n,["disabled"]);null!=i&&t(o,["disabled"],i);const l=e(n,["startOfSpeechSensitivity"]);null!=l&&t(o,["startOfSpeechSensitivity"],l);const s=e(n,["endOfSpeechSensitivity"]);null!=s&&t(o,["endOfSpeechSensitivity"],s);const r=e(n,["prefixPaddingMs"]);null!=r&&t(o,["prefixPaddingMs"],r);const a=e(n,["silenceDurationMs"]);return null!=a&&t(o,["silenceDurationMs"],a),o}(i));const l=e(n,["activityHandling"]);null!=l&&t(o,["activityHandling"],l);const s=e(n,["turnCoverage"]);return null!=s&&t(o,["turnCoverage"],s),o}(_));const O=e(n,["contextWindowCompression"]);void 0!==o&&null!=O&&t(o,["setup","contextWindowCompression"],function(n){const o={},i=e(n,["triggerTokens"]);null!=i&&t(o,["triggerTokens"],i);const l=e(n,["slidingWindow"]);return null!=l&&t(o,["slidingWindow"],function(n){const o={},i=e(n,["targetTokens"]);return null!=i&&t(o,["targetTokens"],i),o}(l)),o}(O));const S=e(n,["proactivity"]);return void 0!==o&&null!=S&&t(o,["setup","proactivity"],function(n){const o={},i=e(n,["proactiveAudio"]);return null!=i&&t(o,["proactiveAudio"],i),o}(S)),{}}function fn(n){const o={},i=e(n,["media"]);null!=i&&t(o,["mediaChunks"],l(i));const s=e(n,["audio"]);null!=s&&t(o,["audio"],a(s));const u=e(n,["audioStreamEnd"]);null!=u&&t(o,["audioStreamEnd"],u);const c=e(n,["video"]);null!=c&&t(o,["video"],r(c));const p=e(n,["text"]);return null!=p&&t(o,["text"],p),null!=e(n,["activityStart"])&&t(o,["activityStart"],{}),null!=e(n,["activityEnd"])&&t(o,["activityEnd"],{}),o}function mn(n){const o={},i=e(n,["media"]);null!=i&&t(o,["mediaChunks"],l(i));const s=e(n,["audio"]);null!=s&&t(o,["audio"],a(s));const u=e(n,["audioStreamEnd"]);null!=u&&t(o,["audioStreamEnd"],u);const c=e(n,["video"]);null!=c&&t(o,["video"],r(c));const p=e(n,["text"]);return null!=p&&t(o,["text"],p),null!=e(n,["activityStart"])&&t(o,["activityStart"],{}),null!=e(n,["activityEnd"])&&t(o,["activityEnd"],{}),o}function hn(n){const o={},i=e(n,["text"]);null!=i&&t(o,["text"],i);const l=e(n,["weight"]);return null!=l&&t(o,["weight"],l),o}function gn(n){const o={},i=e(n,["temperature"]);null!=i&&t(o,["temperature"],i);const l=e(n,["topK"]);null!=l&&t(o,["topK"],l);const s=e(n,["seed"]);null!=s&&t(o,["seed"],s);const r=e(n,["guidance"]);null!=r&&t(o,["guidance"],r);const a=e(n,["bpm"]);null!=a&&t(o,["bpm"],a);const u=e(n,["density"]);null!=u&&t(o,["density"],u);const c=e(n,["brightness"]);null!=c&&t(o,["brightness"],c);const p=e(n,["scale"]);null!=p&&t(o,["scale"],p);const d=e(n,["muteBass"]);null!=d&&t(o,["muteBass"],d);const f=e(n,["muteDrums"]);null!=f&&t(o,["muteDrums"],f);const m=e(n,["onlyBassAndDrums"]);return null!=m&&t(o,["onlyBassAndDrums"],m),o}function yn(n){const o={},i=e(n,["model"]);return null!=i&&t(o,["model"],i),o}function vn(n){const o={},i=e(n,["weightedPrompts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>hn(n))),t(o,["weightedPrompts"],n)}return o}function Cn(n){const o={},i=e(n,["setup"]);null!=i&&t(o,["setup"],yn(i));const l=e(n,["clientContent"]);null!=l&&t(o,["clientContent"],vn(l));const s=e(n,["musicGenerationConfig"]);null!=s&&t(o,["musicGenerationConfig"],gn(s));const r=e(n,["playbackControl"]);return null!=r&&t(o,["playbackControl"],r),o}function Tn(n){const o={},i=e(n,["text"]);null!=i&&t(o,["text"],i);const l=e(n,["finished"]);return null!=l&&t(o,["finished"],l),o}function En(n){const o={},i=e(n,["text"]);null!=i&&t(o,["text"],i);const l=e(n,["finished"]);return null!=l&&t(o,["finished"],l),o}function An(n){const o={},i=e(n,["modelTurn"]);null!=i&&t(o,["modelTurn"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(i));const l=e(n,["turnComplete"]);null!=l&&t(o,["turnComplete"],l);const s=e(n,["interrupted"]);null!=s&&t(o,["interrupted"],s);const r=e(n,["groundingMetadata"]);null!=r&&t(o,["groundingMetadata"],r);const a=e(n,["generationComplete"]);null!=a&&t(o,["generationComplete"],a);const u=e(n,["inputTranscription"]);null!=u&&t(o,["inputTranscription"],Tn(u));const c=e(n,["outputTranscription"]);null!=c&&t(o,["outputTranscription"],Tn(c));const p=e(n,["urlContextMetadata"]);return null!=p&&t(o,["urlContextMetadata"],function(n){const o={},i=e(n,["urlMetadata"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["retrievedUrl"]);null!=i&&t(o,["retrievedUrl"],i);const l=e(n,["urlRetrievalStatus"]);return null!=l&&t(o,["urlRetrievalStatus"],l),o}(n))),t(o,["urlMetadata"],n)}return o}(p)),o}function _n(n){const o={},i=e(n,["modelTurn"]);null!=i&&t(o,["modelTurn"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["data"]);null!=l&&t(o,["data"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["fileUri"]);null!=l&&t(o,["fileUri"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(i));const l=e(n,["turnComplete"]);null!=l&&t(o,["turnComplete"],l);const s=e(n,["interrupted"]);null!=s&&t(o,["interrupted"],s);const r=e(n,["groundingMetadata"]);null!=r&&t(o,["groundingMetadata"],r);const a=e(n,["generationComplete"]);null!=a&&t(o,["generationComplete"],a);const u=e(n,["inputTranscription"]);null!=u&&t(o,["inputTranscription"],En(u));const c=e(n,["outputTranscription"]);return null!=c&&t(o,["outputTranscription"],En(c)),o}function On(n){const o={},i=e(n,["modality"]);null!=i&&t(o,["modality"],i);const l=e(n,["tokenCount"]);return null!=l&&t(o,["tokenCount"],l),o}function Sn(n){const o={},i=e(n,["modality"]);null!=i&&t(o,["modality"],i);const l=e(n,["tokenCount"]);return null!=l&&t(o,["tokenCount"],l),o}function In(n){const o={};null!=e(n,["setupComplete"])&&t(o,["setupComplete"],{});const i=e(n,["serverContent"]);null!=i&&t(o,["serverContent"],An(i));const l=e(n,["toolCall"]);null!=l&&t(o,["toolCall"],function(n){const o={},i=e(n,["functionCalls"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["id"]);null!=i&&t(o,["id"],i);const l=e(n,["args"]);null!=l&&t(o,["args"],l);const s=e(n,["name"]);return null!=s&&t(o,["name"],s),o}(n))),t(o,["functionCalls"],n)}return o}(l));const s=e(n,["toolCallCancellation"]);null!=s&&t(o,["toolCallCancellation"],function(n){const o={},i=e(n,["ids"]);return null!=i&&t(o,["ids"],i),o}(s));const r=e(n,["usageMetadata"]);null!=r&&t(o,["usageMetadata"],function(n){const o={},i=e(n,["promptTokenCount"]);null!=i&&t(o,["promptTokenCount"],i);const l=e(n,["cachedContentTokenCount"]);null!=l&&t(o,["cachedContentTokenCount"],l);const s=e(n,["responseTokenCount"]);null!=s&&t(o,["responseTokenCount"],s);const r=e(n,["toolUsePromptTokenCount"]);null!=r&&t(o,["toolUsePromptTokenCount"],r);const a=e(n,["thoughtsTokenCount"]);null!=a&&t(o,["thoughtsTokenCount"],a);const u=e(n,["totalTokenCount"]);null!=u&&t(o,["totalTokenCount"],u);const c=e(n,["promptTokensDetails"]);if(null!=c){let n=c;Array.isArray(n)&&(n=n.map(n=>On(n))),t(o,["promptTokensDetails"],n)}const p=e(n,["cacheTokensDetails"]);if(null!=p){let n=p;Array.isArray(n)&&(n=n.map(n=>On(n))),t(o,["cacheTokensDetails"],n)}const d=e(n,["responseTokensDetails"]);if(null!=d){let n=d;Array.isArray(n)&&(n=n.map(n=>On(n))),t(o,["responseTokensDetails"],n)}const f=e(n,["toolUsePromptTokensDetails"]);if(null!=f){let n=f;Array.isArray(n)&&(n=n.map(n=>On(n))),t(o,["toolUsePromptTokensDetails"],n)}return o}(r));const a=e(n,["goAway"]);null!=a&&t(o,["goAway"],function(n){const o={},i=e(n,["timeLeft"]);return null!=i&&t(o,["timeLeft"],i),o}(a));const u=e(n,["sessionResumptionUpdate"]);return null!=u&&t(o,["sessionResumptionUpdate"],function(n){const o={},i=e(n,["newHandle"]);null!=i&&t(o,["newHandle"],i);const l=e(n,["resumable"]);null!=l&&t(o,["resumable"],l);const s=e(n,["lastConsumedClientMessageIndex"]);return null!=s&&t(o,["lastConsumedClientMessageIndex"],s),o}(u)),o}function bn(n){const o={},i=e(n,["setupComplete"]);null!=i&&t(o,["setupComplete"],function(n){const o={},i=e(n,["sessionId"]);return null!=i&&t(o,["sessionId"],i),o}(i));const l=e(n,["serverContent"]);null!=l&&t(o,["serverContent"],_n(l));const s=e(n,["toolCall"]);null!=s&&t(o,["toolCall"],function(n){const o={},i=e(n,["functionCalls"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["args"]);null!=i&&t(o,["args"],i);const l=e(n,["name"]);return null!=l&&t(o,["name"],l),o}(n))),t(o,["functionCalls"],n)}return o}(s));const r=e(n,["toolCallCancellation"]);null!=r&&t(o,["toolCallCancellation"],function(n){const o={},i=e(n,["ids"]);return null!=i&&t(o,["ids"],i),o}(r));const a=e(n,["usageMetadata"]);null!=a&&t(o,["usageMetadata"],function(n){const o={},i=e(n,["promptTokenCount"]);null!=i&&t(o,["promptTokenCount"],i);const l=e(n,["cachedContentTokenCount"]);null!=l&&t(o,["cachedContentTokenCount"],l);const s=e(n,["candidatesTokenCount"]);null!=s&&t(o,["responseTokenCount"],s);const r=e(n,["toolUsePromptTokenCount"]);null!=r&&t(o,["toolUsePromptTokenCount"],r);const a=e(n,["thoughtsTokenCount"]);null!=a&&t(o,["thoughtsTokenCount"],a);const u=e(n,["totalTokenCount"]);null!=u&&t(o,["totalTokenCount"],u);const c=e(n,["promptTokensDetails"]);if(null!=c){let n=c;Array.isArray(n)&&(n=n.map(n=>Sn(n))),t(o,["promptTokensDetails"],n)}const p=e(n,["cacheTokensDetails"]);if(null!=p){let n=p;Array.isArray(n)&&(n=n.map(n=>Sn(n))),t(o,["cacheTokensDetails"],n)}const d=e(n,["candidatesTokensDetails"]);if(null!=d){let n=d;Array.isArray(n)&&(n=n.map(n=>Sn(n))),t(o,["responseTokensDetails"],n)}const f=e(n,["toolUsePromptTokensDetails"]);if(null!=f){let n=f;Array.isArray(n)&&(n=n.map(n=>Sn(n))),t(o,["toolUsePromptTokensDetails"],n)}const m=e(n,["trafficType"]);return null!=m&&t(o,["trafficType"],m),o}(a));const u=e(n,["goAway"]);null!=u&&t(o,["goAway"],function(n){const o={},i=e(n,["timeLeft"]);return null!=i&&t(o,["timeLeft"],i),o}(u));const c=e(n,["sessionResumptionUpdate"]);return null!=c&&t(o,["sessionResumptionUpdate"],function(n){const o={},i=e(n,["newHandle"]);null!=i&&t(o,["newHandle"],i);const l=e(n,["resumable"]);null!=l&&t(o,["resumable"],l);const s=e(n,["lastConsumedClientMessageIndex"]);return null!=s&&t(o,["lastConsumedClientMessageIndex"],s),o}(c)),o}function Nn(n){const o={},i=e(n,["clientContent"]);null!=i&&t(o,["clientContent"],function(n){const o={},i=e(n,["weightedPrompts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["text"]);null!=i&&t(o,["text"],i);const l=e(n,["weight"]);return null!=l&&t(o,["weight"],l),o}(n))),t(o,["weightedPrompts"],n)}return o}(i));const l=e(n,["musicGenerationConfig"]);return null!=l&&t(o,["musicGenerationConfig"],function(n){const o={},i=e(n,["temperature"]);null!=i&&t(o,["temperature"],i);const l=e(n,["topK"]);null!=l&&t(o,["topK"],l);const s=e(n,["seed"]);null!=s&&t(o,["seed"],s);const r=e(n,["guidance"]);null!=r&&t(o,["guidance"],r);const a=e(n,["bpm"]);null!=a&&t(o,["bpm"],a);const u=e(n,["density"]);null!=u&&t(o,["density"],u);const c=e(n,["brightness"]);null!=c&&t(o,["brightness"],c);const p=e(n,["scale"]);null!=p&&t(o,["scale"],p);const d=e(n,["muteBass"]);null!=d&&t(o,["muteBass"],d);const f=e(n,["muteDrums"]);null!=f&&t(o,["muteDrums"],f);const m=e(n,["onlyBassAndDrums"]);return null!=m&&t(o,["onlyBassAndDrums"],m),o}(l)),o}function Pn(n){const o={};null!=e(n,["setupComplete"])&&t(o,["setupComplete"],{});const i=e(n,["serverContent"]);null!=i&&t(o,["serverContent"],function(n){const o={},i=e(n,["audioChunks"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);null!=l&&t(o,["mimeType"],l);const s=e(n,["sourceMetadata"]);return null!=s&&t(o,["sourceMetadata"],Nn(s)),o}(n))),t(o,["audioChunks"],n)}return o}(i));const l=e(n,["filteredPrompt"]);return null!=l&&t(o,["filteredPrompt"],function(n){const o={},i=e(n,["text"]);null!=i&&t(o,["text"],i);const l=e(n,["filteredReason"]);return null!=l&&t(o,["filteredReason"],l),o}(l)),o}function wn(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}function Rn(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["behavior"]);null!=i&&t(o,["behavior"],i);const l=e(n,["description"]);null!=l&&t(o,["description"],l);const s=e(n,["name"]);null!=s&&t(o,["name"],s);const r=e(n,["parameters"]);null!=r&&t(o,["parameters"],r);const a=e(n,["parametersJsonSchema"]);null!=a&&t(o,["parametersJsonSchema"],a);const u=e(n,["response"]);null!=u&&t(o,["response"],u);const c=e(n,["responseJsonSchema"]);return null!=c&&t(o,["responseJsonSchema"],c),o}(n))),t(o,["functionDeclarations"],n)}if(void 0!==e(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const l=e(n,["googleSearch"]);null!=l&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(l));const s=e(n,["googleSearchRetrieval"]);if(null!=s&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(s)),void 0!==e(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==e(n,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const r=e(n,["codeExecution"]);null!=r&&t(o,["codeExecution"],r);const a=e(n,["computerUse"]);return null!=a&&t(o,["computerUse"],a),o}function Mn(n){const o={},i=e(n,["functionCallingConfig"]);null!=i&&t(o,["functionCallingConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["allowedFunctionNames"]);return null!=l&&t(o,["allowedFunctionNames"],l),o}(i));const l=e(n,["retrievalConfig"]);return null!=l&&t(o,["retrievalConfig"],function(n){const o={},i=e(n,["latLng"]);null!=i&&t(o,["latLng"],function(n){const o={},i=e(n,["latitude"]);null!=i&&t(o,["latitude"],i);const l=e(n,["longitude"]);return null!=l&&t(o,["longitude"],l),o}(i));const l=e(n,["languageCode"]);return null!=l&&t(o,["languageCode"],l),o}(l)),o}function Dn(n){const o={},i=e(n,["prebuiltVoiceConfig"]);return null!=i&&t(o,["prebuiltVoiceConfig"],function(n){const o={},i=e(n,["voiceName"]);return null!=i&&t(o,["voiceName"],i),o}(i)),o}function Un(n,o,i){const l={},s=e(o,["systemInstruction"]);void 0!==i&&null!=s&&t(i,["systemInstruction"],wn(m(s)));const r=e(o,["temperature"]);null!=r&&t(l,["temperature"],r);const a=e(o,["topP"]);null!=a&&t(l,["topP"],a);const u=e(o,["topK"]);null!=u&&t(l,["topK"],u);const c=e(o,["candidateCount"]);null!=c&&t(l,["candidateCount"],c);const p=e(o,["maxOutputTokens"]);null!=p&&t(l,["maxOutputTokens"],p);const d=e(o,["stopSequences"]);null!=d&&t(l,["stopSequences"],d);const f=e(o,["responseLogprobs"]);null!=f&&t(l,["responseLogprobs"],f);const h=e(o,["logprobs"]);null!=h&&t(l,["logprobs"],h);const g=e(o,["presencePenalty"]);null!=g&&t(l,["presencePenalty"],g);const y=e(o,["frequencyPenalty"]);null!=y&&t(l,["frequencyPenalty"],y);const T=e(o,["seed"]);null!=T&&t(l,["seed"],T);const O=e(o,["responseMimeType"]);null!=O&&t(l,["responseMimeType"],O);const S=e(o,["responseSchema"]);null!=S&&t(l,["responseSchema"],function(n){const o={},i=e(n,["anyOf"]);null!=i&&t(o,["anyOf"],i);const l=e(n,["default"]);null!=l&&t(o,["default"],l);const s=e(n,["description"]);null!=s&&t(o,["description"],s);const r=e(n,["enum"]);null!=r&&t(o,["enum"],r);const a=e(n,["example"]);null!=a&&t(o,["example"],a);const u=e(n,["format"]);null!=u&&t(o,["format"],u);const c=e(n,["items"]);null!=c&&t(o,["items"],c);const p=e(n,["maxItems"]);null!=p&&t(o,["maxItems"],p);const d=e(n,["maxLength"]);null!=d&&t(o,["maxLength"],d);const f=e(n,["maxProperties"]);null!=f&&t(o,["maxProperties"],f);const m=e(n,["maximum"]);null!=m&&t(o,["maximum"],m);const h=e(n,["minItems"]);null!=h&&t(o,["minItems"],h);const g=e(n,["minLength"]);null!=g&&t(o,["minLength"],g);const y=e(n,["minProperties"]);null!=y&&t(o,["minProperties"],y);const v=e(n,["minimum"]);null!=v&&t(o,["minimum"],v);const C=e(n,["nullable"]);null!=C&&t(o,["nullable"],C);const T=e(n,["pattern"]);null!=T&&t(o,["pattern"],T);const E=e(n,["properties"]);null!=E&&t(o,["properties"],E);const A=e(n,["propertyOrdering"]);null!=A&&t(o,["propertyOrdering"],A);const _=e(n,["required"]);null!=_&&t(o,["required"],_);const O=e(n,["title"]);null!=O&&t(o,["title"],O);const S=e(n,["type"]);return null!=S&&t(o,["type"],S),o}(v(S)));const I=e(o,["responseJsonSchema"]);if(null!=I&&t(l,["responseJsonSchema"],I),void 0!==e(o,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==e(o,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=e(o,["safetySettings"]);if(void 0!==i&&null!=b){let n=b;Array.isArray(n)&&(n=n.map(n=>function(n){const o={};if(void 0!==e(n,["method"]))throw new Error("method parameter is not supported in Gemini API.");const i=e(n,["category"]);null!=i&&t(o,["category"],i);const l=e(n,["threshold"]);return null!=l&&t(o,["threshold"],l),o}(n))),t(i,["safetySettings"],n)}const N=e(o,["tools"]);if(void 0!==i&&null!=N){let n=A(N);Array.isArray(n)&&(n=n.map(n=>Rn(E(n)))),t(i,["tools"],n)}const P=e(o,["toolConfig"]);if(void 0!==i&&null!=P&&t(i,["toolConfig"],Mn(P)),void 0!==e(o,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const w=e(o,["cachedContent"]);void 0!==i&&null!=w&&t(i,["cachedContent"],_(n,w));const R=e(o,["responseModalities"]);null!=R&&t(l,["responseModalities"],R);const M=e(o,["mediaResolution"]);null!=M&&t(l,["mediaResolution"],M);const D=e(o,["speechConfig"]);if(null!=D&&t(l,["speechConfig"],function(n){const o={},i=e(n,["voiceConfig"]);null!=i&&t(o,["voiceConfig"],Dn(i));const l=e(n,["multiSpeakerVoiceConfig"]);null!=l&&t(o,["multiSpeakerVoiceConfig"],function(n){const o={},i=e(n,["speakerVoiceConfigs"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["speaker"]);null!=i&&t(o,["speaker"],i);const l=e(n,["voiceConfig"]);return null!=l&&t(o,["voiceConfig"],Dn(l)),o}(n))),t(o,["speakerVoiceConfigs"],n)}return o}(l));const s=e(n,["languageCode"]);return null!=s&&t(o,["languageCode"],s),o}(C(D))),void 0!==e(o,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=e(o,["thinkingConfig"]);return null!=U&&t(l,["thinkingConfig"],function(n){const o={},i=e(n,["includeThoughts"]);null!=i&&t(o,["includeThoughts"],i);const l=e(n,["thinkingBudget"]);return null!=l&&t(o,["thinkingBudget"],l),o}(U)),l}function xn(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["contents"]);if(null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>wn(n))),t(l,["contents"],n)}const a=e(i,["config"]);return null!=a&&t(l,["generationConfig"],Un(n,a,l)),l}function Ln(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["data"]);null!=l&&t(o,["data"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["fileUri"]);null!=l&&t(o,["fileUri"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}function qn(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={};if(void 0!==e(n,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const i=e(n,["description"]);null!=i&&t(o,["description"],i);const l=e(n,["name"]);null!=l&&t(o,["name"],l);const s=e(n,["parameters"]);null!=s&&t(o,["parameters"],s);const r=e(n,["parametersJsonSchema"]);null!=r&&t(o,["parametersJsonSchema"],r);const a=e(n,["response"]);null!=a&&t(o,["response"],a);const u=e(n,["responseJsonSchema"]);return null!=u&&t(o,["responseJsonSchema"],u),o}(n))),t(o,["functionDeclarations"],n)}const l=e(n,["retrieval"]);null!=l&&t(o,["retrieval"],l);const s=e(n,["googleSearch"]);null!=s&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(s));const r=e(n,["googleSearchRetrieval"]);null!=r&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(r)),null!=e(n,["enterpriseWebSearch"])&&t(o,["enterpriseWebSearch"],{});const a=e(n,["googleMaps"]);null!=a&&t(o,["googleMaps"],function(n){const o={},i=e(n,["authConfig"]);return null!=i&&t(o,["authConfig"],function(n){const o={},i=e(n,["apiKeyConfig"]);null!=i&&t(o,["apiKeyConfig"],function(n){const o={},i=e(n,["apiKeyString"]);return null!=i&&t(o,["apiKeyString"],i),o}(i));const l=e(n,["authType"]);null!=l&&t(o,["authType"],l);const s=e(n,["googleServiceAccountConfig"]);null!=s&&t(o,["googleServiceAccountConfig"],s);const r=e(n,["httpBasicAuthConfig"]);null!=r&&t(o,["httpBasicAuthConfig"],r);const a=e(n,["oauthConfig"]);null!=a&&t(o,["oauthConfig"],a);const u=e(n,["oidcConfig"]);return null!=u&&t(o,["oidcConfig"],u),o}(i)),o}(a)),null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const u=e(n,["codeExecution"]);null!=u&&t(o,["codeExecution"],u);const c=e(n,["computerUse"]);return null!=c&&t(o,["computerUse"],c),o}function kn(n){const o={},i=e(n,["functionCallingConfig"]);null!=i&&t(o,["functionCallingConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["allowedFunctionNames"]);return null!=l&&t(o,["allowedFunctionNames"],l),o}(i));const l=e(n,["retrievalConfig"]);return null!=l&&t(o,["retrievalConfig"],function(n){const o={},i=e(n,["latLng"]);null!=i&&t(o,["latLng"],function(n){const o={},i=e(n,["latitude"]);null!=i&&t(o,["latitude"],i);const l=e(n,["longitude"]);return null!=l&&t(o,["longitude"],l),o}(i));const l=e(n,["languageCode"]);return null!=l&&t(o,["languageCode"],l),o}(l)),o}function Gn(n,o,i){const l={},s=e(o,["systemInstruction"]);void 0!==i&&null!=s&&t(i,["systemInstruction"],Ln(m(s)));const r=e(o,["temperature"]);null!=r&&t(l,["temperature"],r);const a=e(o,["topP"]);null!=a&&t(l,["topP"],a);const u=e(o,["topK"]);null!=u&&t(l,["topK"],u);const c=e(o,["candidateCount"]);null!=c&&t(l,["candidateCount"],c);const p=e(o,["maxOutputTokens"]);null!=p&&t(l,["maxOutputTokens"],p);const d=e(o,["stopSequences"]);null!=d&&t(l,["stopSequences"],d);const f=e(o,["responseLogprobs"]);null!=f&&t(l,["responseLogprobs"],f);const h=e(o,["logprobs"]);null!=h&&t(l,["logprobs"],h);const g=e(o,["presencePenalty"]);null!=g&&t(l,["presencePenalty"],g);const y=e(o,["frequencyPenalty"]);null!=y&&t(l,["frequencyPenalty"],y);const T=e(o,["seed"]);null!=T&&t(l,["seed"],T);const O=e(o,["responseMimeType"]);null!=O&&t(l,["responseMimeType"],O);const S=e(o,["responseSchema"]);null!=S&&t(l,["responseSchema"],function(n){const o={},i=e(n,["anyOf"]);null!=i&&t(o,["anyOf"],i);const l=e(n,["default"]);null!=l&&t(o,["default"],l);const s=e(n,["description"]);null!=s&&t(o,["description"],s);const r=e(n,["enum"]);null!=r&&t(o,["enum"],r);const a=e(n,["example"]);null!=a&&t(o,["example"],a);const u=e(n,["format"]);null!=u&&t(o,["format"],u);const c=e(n,["items"]);null!=c&&t(o,["items"],c);const p=e(n,["maxItems"]);null!=p&&t(o,["maxItems"],p);const d=e(n,["maxLength"]);null!=d&&t(o,["maxLength"],d);const f=e(n,["maxProperties"]);null!=f&&t(o,["maxProperties"],f);const m=e(n,["maximum"]);null!=m&&t(o,["maximum"],m);const h=e(n,["minItems"]);null!=h&&t(o,["minItems"],h);const g=e(n,["minLength"]);null!=g&&t(o,["minLength"],g);const y=e(n,["minProperties"]);null!=y&&t(o,["minProperties"],y);const v=e(n,["minimum"]);null!=v&&t(o,["minimum"],v);const C=e(n,["nullable"]);null!=C&&t(o,["nullable"],C);const T=e(n,["pattern"]);null!=T&&t(o,["pattern"],T);const E=e(n,["properties"]);null!=E&&t(o,["properties"],E);const A=e(n,["propertyOrdering"]);null!=A&&t(o,["propertyOrdering"],A);const _=e(n,["required"]);null!=_&&t(o,["required"],_);const O=e(n,["title"]);null!=O&&t(o,["title"],O);const S=e(n,["type"]);return null!=S&&t(o,["type"],S),o}(v(S)));const I=e(o,["responseJsonSchema"]);null!=I&&t(l,["responseJsonSchema"],I);const b=e(o,["routingConfig"]);null!=b&&t(l,["routingConfig"],b);const N=e(o,["modelSelectionConfig"]);null!=N&&t(l,["modelConfig"],function(n){const o={},i=e(n,["featureSelectionPreference"]);return null!=i&&t(o,["featureSelectionPreference"],i),o}(N));const P=e(o,["safetySettings"]);if(void 0!==i&&null!=P){let n=P;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["method"]);null!=i&&t(o,["method"],i);const l=e(n,["category"]);null!=l&&t(o,["category"],l);const s=e(n,["threshold"]);return null!=s&&t(o,["threshold"],s),o}(n))),t(i,["safetySettings"],n)}const w=e(o,["tools"]);if(void 0!==i&&null!=w){let n=A(w);Array.isArray(n)&&(n=n.map(n=>qn(E(n)))),t(i,["tools"],n)}const R=e(o,["toolConfig"]);void 0!==i&&null!=R&&t(i,["toolConfig"],kn(R));const M=e(o,["labels"]);void 0!==i&&null!=M&&t(i,["labels"],M);const D=e(o,["cachedContent"]);void 0!==i&&null!=D&&t(i,["cachedContent"],_(n,D));const U=e(o,["responseModalities"]);null!=U&&t(l,["responseModalities"],U);const x=e(o,["mediaResolution"]);null!=x&&t(l,["mediaResolution"],x);const L=e(o,["speechConfig"]);null!=L&&t(l,["speechConfig"],function(n){const o={},i=e(n,["voiceConfig"]);if(null!=i&&t(o,["voiceConfig"],function(n){const o={},i=e(n,["prebuiltVoiceConfig"]);return null!=i&&t(o,["prebuiltVoiceConfig"],function(n){const o={},i=e(n,["voiceName"]);return null!=i&&t(o,["voiceName"],i),o}(i)),o}(i)),void 0!==e(n,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const l=e(n,["languageCode"]);return null!=l&&t(o,["languageCode"],l),o}(C(L)));const q=e(o,["audioTimestamp"]);null!=q&&t(l,["audioTimestamp"],q);const k=e(o,["thinkingConfig"]);return null!=k&&t(l,["thinkingConfig"],function(n){const o={},i=e(n,["includeThoughts"]);null!=i&&t(o,["includeThoughts"],i);const l=e(n,["thinkingBudget"]);return null!=l&&t(o,["thinkingBudget"],l),o}(k)),l}function Fn(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["contents"]);if(null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>Ln(n))),t(l,["contents"],n)}const a=e(i,["config"]);return null!=a&&t(l,["generationConfig"],Gn(n,a,l)),l}function jn(n){const o={},i=e(n,["gcsUri"]);null!=i&&t(o,["gcsUri"],i);const l=e(n,["imageBytes"]);null!=l&&t(o,["bytesBase64Encoded"],S(l));const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}function Vn(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["prompt"]);null!=r&&t(l,["instances[0]","prompt"],r);const a=e(i,["referenceImages"]);if(null!=a){let n=a;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["referenceImage"]);null!=i&&t(o,["referenceImage"],jn(i));const l=e(n,["referenceId"]);null!=l&&t(o,["referenceId"],l);const s=e(n,["referenceType"]);null!=s&&t(o,["referenceType"],s);const r=e(n,["maskImageConfig"]);null!=r&&t(o,["maskImageConfig"],function(n){const o={},i=e(n,["maskMode"]);null!=i&&t(o,["maskMode"],i);const l=e(n,["segmentationClasses"]);null!=l&&t(o,["maskClasses"],l);const s=e(n,["maskDilation"]);return null!=s&&t(o,["dilation"],s),o}(r));const a=e(n,["controlImageConfig"]);null!=a&&t(o,["controlImageConfig"],function(n){const o={},i=e(n,["controlType"]);null!=i&&t(o,["controlType"],i);const l=e(n,["enableControlImageComputation"]);return null!=l&&t(o,["computeControl"],l),o}(a));const u=e(n,["styleImageConfig"]);null!=u&&t(o,["styleImageConfig"],function(n){const o={},i=e(n,["styleDescription"]);return null!=i&&t(o,["styleDescription"],i),o}(u));const c=e(n,["subjectImageConfig"]);return null!=c&&t(o,["subjectImageConfig"],function(n){const o={},i=e(n,["subjectType"]);null!=i&&t(o,["subjectType"],i);const l=e(n,["subjectDescription"]);return null!=l&&t(o,["subjectDescription"],l),o}(c)),o}(n))),t(l,["instances[0]","referenceImages"],n)}const u=e(i,["config"]);return null!=u&&t(l,["config"],function(n,o){const i=e(n,["outputGcsUri"]);void 0!==o&&null!=i&&t(o,["parameters","storageUri"],i);const l=e(n,["negativePrompt"]);void 0!==o&&null!=l&&t(o,["parameters","negativePrompt"],l);const s=e(n,["numberOfImages"]);void 0!==o&&null!=s&&t(o,["parameters","sampleCount"],s);const r=e(n,["aspectRatio"]);void 0!==o&&null!=r&&t(o,["parameters","aspectRatio"],r);const a=e(n,["guidanceScale"]);void 0!==o&&null!=a&&t(o,["parameters","guidanceScale"],a);const u=e(n,["seed"]);void 0!==o&&null!=u&&t(o,["parameters","seed"],u);const c=e(n,["safetyFilterLevel"]);void 0!==o&&null!=c&&t(o,["parameters","safetySetting"],c);const p=e(n,["personGeneration"]);void 0!==o&&null!=p&&t(o,["parameters","personGeneration"],p);const d=e(n,["includeSafetyAttributes"]);void 0!==o&&null!=d&&t(o,["parameters","includeSafetyAttributes"],d);const f=e(n,["includeRaiReason"]);void 0!==o&&null!=f&&t(o,["parameters","includeRaiReason"],f);const m=e(n,["language"]);void 0!==o&&null!=m&&t(o,["parameters","language"],m);const h=e(n,["outputMimeType"]);void 0!==o&&null!=h&&t(o,["parameters","outputOptions","mimeType"],h);const g=e(n,["outputCompressionQuality"]);void 0!==o&&null!=g&&t(o,["parameters","outputOptions","compressionQuality"],g);const y=e(n,["editMode"]);void 0!==o&&null!=y&&t(o,["parameters","editMode"],y);const v=e(n,["baseSteps"]);return void 0!==o&&null!=v&&t(o,["parameters","editConfig","baseSteps"],v),{}}(u,l)),l}function Jn(n){const o={},i=e(n,["content"]);null!=i&&t(o,["content"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(i));const l=e(n,["citationMetadata"]);null!=l&&t(o,["citationMetadata"],function(n){const o={},i=e(n,["citationSources"]);return null!=i&&t(o,["citations"],i),o}(l));const s=e(n,["tokenCount"]);null!=s&&t(o,["tokenCount"],s);const r=e(n,["finishReason"]);null!=r&&t(o,["finishReason"],r);const a=e(n,["urlContextMetadata"]);null!=a&&t(o,["urlContextMetadata"],function(n){const o={},i=e(n,["urlMetadata"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["retrievedUrl"]);null!=i&&t(o,["retrievedUrl"],i);const l=e(n,["urlRetrievalStatus"]);return null!=l&&t(o,["urlRetrievalStatus"],l),o}(n))),t(o,["urlMetadata"],n)}return o}(a));const u=e(n,["avgLogprobs"]);null!=u&&t(o,["avgLogprobs"],u);const c=e(n,["groundingMetadata"]);null!=c&&t(o,["groundingMetadata"],c);const p=e(n,["index"]);null!=p&&t(o,["index"],p);const d=e(n,["logprobsResult"]);null!=d&&t(o,["logprobsResult"],d);const f=e(n,["safetyRatings"]);return null!=f&&t(o,["safetyRatings"],f),o}function Bn(n){const o={},i=e(n,["candidates"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>Jn(n))),t(o,["candidates"],n)}const l=e(n,["modelVersion"]);null!=l&&t(o,["modelVersion"],l);const s=e(n,["promptFeedback"]);null!=s&&t(o,["promptFeedback"],s);const r=e(n,["usageMetadata"]);return null!=r&&t(o,["usageMetadata"],r),o}function Hn(n){const o={},i=e(n,["safetyAttributes","categories"]);null!=i&&t(o,["categories"],i);const l=e(n,["safetyAttributes","scores"]);null!=l&&t(o,["scores"],l);const s=e(n,["contentType"]);return null!=s&&t(o,["contentType"],s),o}function Yn(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["description"]);null!=s&&t(o,["description"],s);const r=e(n,["version"]);null!=r&&t(o,["version"],r);const a=e(n,["_self"]);null!=a&&t(o,["tunedModelInfo"],function(n){const o={},i=e(n,["baseModel"]);null!=i&&t(o,["baseModel"],i);const l=e(n,["createTime"]);null!=l&&t(o,["createTime"],l);const s=e(n,["updateTime"]);return null!=s&&t(o,["updateTime"],s),o}(a));const u=e(n,["inputTokenLimit"]);null!=u&&t(o,["inputTokenLimit"],u);const c=e(n,["outputTokenLimit"]);null!=c&&t(o,["outputTokenLimit"],c);const p=e(n,["supportedGenerationMethods"]);return null!=p&&t(o,["supportedActions"],p),o}function Kn(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["metadata"]);null!=l&&t(o,["metadata"],l);const s=e(n,["done"]);null!=s&&t(o,["done"],s);const r=e(n,["error"]);null!=r&&t(o,["error"],r);const a=e(n,["response","generateVideoResponse"]);return null!=a&&t(o,["response"],function(n){const o={},i=e(n,["generatedSamples"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["_self"]);return null!=i&&t(o,["video"],function(n){const o={},i=e(n,["video","uri"]);null!=i&&t(o,["uri"],i);const l=e(n,["video","encodedVideo"]);null!=l&&t(o,["videoBytes"],S(l));const s=e(n,["encoding"]);return null!=s&&t(o,["mimeType"],s),o}(i)),o}(n))),t(o,["generatedVideos"],n)}const l=e(n,["raiMediaFilteredCount"]);null!=l&&t(o,["raiMediaFilteredCount"],l);const s=e(n,["raiMediaFilteredReasons"]);return null!=s&&t(o,["raiMediaFilteredReasons"],s),o}(a)),o}function Wn(n){const o={},i=e(n,["content"]);null!=i&&t(o,["content"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["data"]);null!=l&&t(o,["data"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={},i=e(n,["displayName"]);null!=i&&t(o,["displayName"],i);const l=e(n,["fileUri"]);null!=l&&t(o,["fileUri"],l);const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(i));const l=e(n,["citationMetadata"]);null!=l&&t(o,["citationMetadata"],function(n){const o={},i=e(n,["citations"]);return null!=i&&t(o,["citations"],i),o}(l));const s=e(n,["finishMessage"]);null!=s&&t(o,["finishMessage"],s);const r=e(n,["finishReason"]);null!=r&&t(o,["finishReason"],r);const a=e(n,["urlContextMetadata"]);null!=a&&t(o,["urlContextMetadata"],function(n){const o={},i=e(n,["urlMetadata"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["retrievedUrl"]);null!=i&&t(o,["retrievedUrl"],i);const l=e(n,["urlRetrievalStatus"]);return null!=l&&t(o,["urlRetrievalStatus"],l),o}(n))),t(o,["urlMetadata"],n)}return o}(a));const u=e(n,["avgLogprobs"]);null!=u&&t(o,["avgLogprobs"],u);const c=e(n,["groundingMetadata"]);null!=c&&t(o,["groundingMetadata"],c);const p=e(n,["index"]);null!=p&&t(o,["index"],p);const d=e(n,["logprobsResult"]);null!=d&&t(o,["logprobsResult"],d);const f=e(n,["safetyRatings"]);return null!=f&&t(o,["safetyRatings"],f),o}function $n(n){const o={},i=e(n,["candidates"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>Wn(n))),t(o,["candidates"],n)}const l=e(n,["createTime"]);null!=l&&t(o,["createTime"],l);const s=e(n,["responseId"]);null!=s&&t(o,["responseId"],s);const r=e(n,["modelVersion"]);null!=r&&t(o,["modelVersion"],r);const a=e(n,["promptFeedback"]);null!=a&&t(o,["promptFeedback"],a);const u=e(n,["usageMetadata"]);return null!=u&&t(o,["usageMetadata"],u),o}function zn(n){const o={},i=e(n,["predictions[]","embeddings"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["values"]);null!=i&&t(o,["values"],i);const l=e(n,["statistics"]);return null!=l&&t(o,["statistics"],function(n){const o={},i=e(n,["truncated"]);null!=i&&t(o,["truncated"],i);const l=e(n,["token_count"]);return null!=l&&t(o,["tokenCount"],l),o}(l)),o}(n))),t(o,["embeddings"],n)}const l=e(n,["metadata"]);return null!=l&&t(o,["metadata"],function(n){const o={},i=e(n,["billableCharacterCount"]);return null!=i&&t(o,["billableCharacterCount"],i),o}(l)),o}function Xn(n){const o={},i=e(n,["safetyAttributes","categories"]);null!=i&&t(o,["categories"],i);const l=e(n,["safetyAttributes","scores"]);null!=l&&t(o,["scores"],l);const s=e(n,["contentType"]);return null!=s&&t(o,["contentType"],s),o}function Zn(n){const o={},i=e(n,["_self"]);null!=i&&t(o,["image"],function(n){const o={},i=e(n,["gcsUri"]);null!=i&&t(o,["gcsUri"],i);const l=e(n,["bytesBase64Encoded"]);null!=l&&t(o,["imageBytes"],S(l));const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(i));const l=e(n,["raiFilteredReason"]);null!=l&&t(o,["raiFilteredReason"],l);const s=e(n,["_self"]);null!=s&&t(o,["safetyAttributes"],Xn(s));const r=e(n,["prompt"]);return null!=r&&t(o,["enhancedPrompt"],r),o}function Qn(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["description"]);null!=s&&t(o,["description"],s);const r=e(n,["versionId"]);null!=r&&t(o,["version"],r);const a=e(n,["deployedModels"]);if(null!=a){let n=a;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["endpoint"]);null!=i&&t(o,["name"],i);const l=e(n,["deployedModelId"]);return null!=l&&t(o,["deployedModelId"],l),o}(n))),t(o,["endpoints"],n)}const u=e(n,["labels"]);null!=u&&t(o,["labels"],u);const c=e(n,["_self"]);null!=c&&t(o,["tunedModelInfo"],function(n){const o={},i=e(n,["labels","google-vertex-llm-tuning-base-model-id"]);null!=i&&t(o,["baseModel"],i);const l=e(n,["createTime"]);null!=l&&t(o,["createTime"],l);const s=e(n,["updateTime"]);return null!=s&&t(o,["updateTime"],s),o}(c));const p=e(n,["defaultCheckpointId"]);null!=p&&t(o,["defaultCheckpointId"],p);const d=e(n,["checkpoints"]);if(null!=d){let n=d;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["checkpointId"]);null!=i&&t(o,["checkpointId"],i);const l=e(n,["epoch"]);null!=l&&t(o,["epoch"],l);const s=e(n,["step"]);return null!=s&&t(o,["step"],s),o}(n))),t(o,["checkpoints"],n)}return o}function nt(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["metadata"]);null!=l&&t(o,["metadata"],l);const s=e(n,["done"]);null!=s&&t(o,["done"],s);const r=e(n,["error"]);null!=r&&t(o,["error"],r);const a=e(n,["response"]);return null!=a&&t(o,["response"],function(n){const o={},i=e(n,["videos"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["_self"]);return null!=i&&t(o,["video"],function(n){const o={},i=e(n,["gcsUri"]);null!=i&&t(o,["uri"],i);const l=e(n,["bytesBase64Encoded"]);null!=l&&t(o,["videoBytes"],S(l));const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(i)),o}(n))),t(o,["generatedVideos"],n)}const l=e(n,["raiMediaFilteredCount"]);null!=l&&t(o,["raiMediaFilteredCount"],l);const s=e(n,["raiMediaFilteredReasons"]);return null!=s&&t(o,["raiMediaFilteredReasons"],s),o}(a)),o}async function tt(n){var t;if(void 0===n)throw new Error("response is undefined");if(!n.ok){const e=n.status;let o;o=(null===(t=n.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await n.json():{error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(o);if(e>=400&&e<600)throw new So({message:i,status:e});throw new Error(i)}}function et(n){for(const t of n){if(it(t))return!0;if("object"==typeof t&&"inputSchema"in t)return!0}return!1}function ot(n){var t;const e=null!==(t=n[bo])&&void 0!==t?t:"";n[bo]=(e+" mcp_used/unknown").trimStart()}function it(n){return null!==n&&"object"==typeof n&&n instanceof wo}function lt(n,t=100){return tn(this,arguments,function*(){let e,o=0;for(;o<t;){const t=yield nn(n.listTools({cursor:e}));for(const n of t.tools)yield yield nn(n),o++;if(!t.nextCursor)break;e=t.nextCursor}})}function st(n){var t,e,o;if(null===(t=null==n?void 0:n.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let i=!1;for(const s of null!==(e=null==n?void 0:n.tools)&&void 0!==e?e:[])if(rt(s)){i=!0;break}if(!i)return!0;const l=null===(o=null==n?void 0:n.automaticFunctionCalling)||void 0===o?void 0:o.maximumRemoteCalls;return!!(l&&(l<0||!Number.isInteger(l))||0==l)}function rt(n){return"callTool"in n&&"function"==typeof n.callTool}function at(n){var t;return!(null===(t=null==n?void 0:n.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}function ut(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["metadata"]);null!=l&&t(o,["metadata"],l);const s=e(n,["done"]);null!=s&&t(o,["done"],s);const r=e(n,["error"]);null!=r&&t(o,["error"],r);const a=e(n,["response","generateVideoResponse"]);return null!=a&&t(o,["response"],function(n){const o={},i=e(n,["generatedSamples"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["_self"]);return null!=i&&t(o,["video"],function(n){const o={},i=e(n,["video","uri"]);null!=i&&t(o,["uri"],i);const l=e(n,["video","encodedVideo"]);null!=l&&t(o,["videoBytes"],S(l));const s=e(n,["encoding"]);return null!=s&&t(o,["mimeType"],s),o}(i)),o}(n))),t(o,["generatedVideos"],n)}const l=e(n,["raiMediaFilteredCount"]);null!=l&&t(o,["raiMediaFilteredCount"],l);const s=e(n,["raiMediaFilteredReasons"]);return null!=s&&t(o,["raiMediaFilteredReasons"],s),o}(a)),o}function ct(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["metadata"]);null!=l&&t(o,["metadata"],l);const s=e(n,["done"]);null!=s&&t(o,["done"],s);const r=e(n,["error"]);null!=r&&t(o,["error"],r);const a=e(n,["response"]);return null!=a&&t(o,["response"],function(n){const o={},i=e(n,["videos"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["_self"]);return null!=i&&t(o,["video"],function(n){const o={},i=e(n,["gcsUri"]);null!=i&&t(o,["uri"],i);const l=e(n,["bytesBase64Encoded"]);null!=l&&t(o,["videoBytes"],S(l));const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(i)),o}(n))),t(o,["generatedVideos"],n)}const l=e(n,["raiMediaFilteredCount"]);null!=l&&t(o,["raiMediaFilteredCount"],l);const s=e(n,["raiMediaFilteredReasons"]);return null!=s&&t(o,["raiMediaFilteredReasons"],s),o}(a)),o}function pt(n){const o={},i=e(n,["prebuiltVoiceConfig"]);return null!=i&&t(o,["prebuiltVoiceConfig"],function(n){const o={},i=e(n,["voiceName"]);return null!=i&&t(o,["voiceName"],i),o}(i)),o}function dt(n){const o={},i=e(n,["functionDeclarations"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["behavior"]);null!=i&&t(o,["behavior"],i);const l=e(n,["description"]);null!=l&&t(o,["description"],l);const s=e(n,["name"]);null!=s&&t(o,["name"],s);const r=e(n,["parameters"]);null!=r&&t(o,["parameters"],r);const a=e(n,["parametersJsonSchema"]);null!=a&&t(o,["parametersJsonSchema"],a);const u=e(n,["response"]);null!=u&&t(o,["response"],u);const c=e(n,["responseJsonSchema"]);return null!=c&&t(o,["responseJsonSchema"],c),o}(n))),t(o,["functionDeclarations"],n)}if(void 0!==e(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const l=e(n,["googleSearch"]);null!=l&&t(o,["googleSearch"],function(n){const o={},i=e(n,["timeRangeFilter"]);return null!=i&&t(o,["timeRangeFilter"],function(n){const o={},i=e(n,["startTime"]);null!=i&&t(o,["startTime"],i);const l=e(n,["endTime"]);return null!=l&&t(o,["endTime"],l),o}(i)),o}(l));const s=e(n,["googleSearchRetrieval"]);if(null!=s&&t(o,["googleSearchRetrieval"],function(n){const o={},i=e(n,["dynamicRetrievalConfig"]);return null!=i&&t(o,["dynamicRetrievalConfig"],function(n){const o={},i=e(n,["mode"]);null!=i&&t(o,["mode"],i);const l=e(n,["dynamicThreshold"]);return null!=l&&t(o,["dynamicThreshold"],l),o}(i)),o}(s)),void 0!==e(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==e(n,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=e(n,["urlContext"])&&t(o,["urlContext"],{});const r=e(n,["codeExecution"]);null!=r&&t(o,["codeExecution"],r);const a=e(n,["computerUse"]);return null!=a&&t(o,["computerUse"],a),o}function ft(n,o){const i=e(n,["generationConfig"]);void 0!==o&&null!=i&&t(o,["setup","generationConfig"],i);const l=e(n,["responseModalities"]);void 0!==o&&null!=l&&t(o,["setup","generationConfig","responseModalities"],l);const s=e(n,["temperature"]);void 0!==o&&null!=s&&t(o,["setup","generationConfig","temperature"],s);const r=e(n,["topP"]);void 0!==o&&null!=r&&t(o,["setup","generationConfig","topP"],r);const a=e(n,["topK"]);void 0!==o&&null!=a&&t(o,["setup","generationConfig","topK"],a);const u=e(n,["maxOutputTokens"]);void 0!==o&&null!=u&&t(o,["setup","generationConfig","maxOutputTokens"],u);const c=e(n,["mediaResolution"]);void 0!==o&&null!=c&&t(o,["setup","generationConfig","mediaResolution"],c);const p=e(n,["seed"]);void 0!==o&&null!=p&&t(o,["setup","generationConfig","seed"],p);const d=e(n,["speechConfig"]);void 0!==o&&null!=d&&t(o,["setup","generationConfig","speechConfig"],function(n){const o={},i=e(n,["voiceConfig"]);null!=i&&t(o,["voiceConfig"],pt(i));const l=e(n,["multiSpeakerVoiceConfig"]);null!=l&&t(o,["multiSpeakerVoiceConfig"],function(n){const o={},i=e(n,["speakerVoiceConfigs"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["speaker"]);null!=i&&t(o,["speaker"],i);const l=e(n,["voiceConfig"]);return null!=l&&t(o,["voiceConfig"],pt(l)),o}(n))),t(o,["speakerVoiceConfigs"],n)}return o}(l));const s=e(n,["languageCode"]);return null!=s&&t(o,["languageCode"],s),o}(T(d)));const f=e(n,["enableAffectiveDialog"]);void 0!==o&&null!=f&&t(o,["setup","generationConfig","enableAffectiveDialog"],f);const h=e(n,["systemInstruction"]);void 0!==o&&null!=h&&t(o,["setup","systemInstruction"],function(n){const o={},i=e(n,["parts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["videoMetadata"]);null!=i&&t(o,["videoMetadata"],function(n){const o={},i=e(n,["fps"]);null!=i&&t(o,["fps"],i);const l=e(n,["endOffset"]);null!=l&&t(o,["endOffset"],l);const s=e(n,["startOffset"]);return null!=s&&t(o,["startOffset"],s),o}(i));const l=e(n,["thought"]);null!=l&&t(o,["thought"],l);const s=e(n,["inlineData"]);null!=s&&t(o,["inlineData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["data"]);null!=i&&t(o,["data"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(s));const r=e(n,["fileData"]);null!=r&&t(o,["fileData"],function(n){const o={};if(void 0!==e(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=e(n,["fileUri"]);null!=i&&t(o,["fileUri"],i);const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(r));const a=e(n,["thoughtSignature"]);null!=a&&t(o,["thoughtSignature"],a);const u=e(n,["codeExecutionResult"]);null!=u&&t(o,["codeExecutionResult"],u);const c=e(n,["executableCode"]);null!=c&&t(o,["executableCode"],c);const p=e(n,["functionCall"]);null!=p&&t(o,["functionCall"],p);const d=e(n,["functionResponse"]);null!=d&&t(o,["functionResponse"],d);const f=e(n,["text"]);return null!=f&&t(o,["text"],f),o}(n))),t(o,["parts"],n)}const l=e(n,["role"]);return null!=l&&t(o,["role"],l),o}(m(h)));const g=e(n,["tools"]);if(void 0!==o&&null!=g){let n=A(g);Array.isArray(n)&&(n=n.map(n=>dt(E(n)))),t(o,["setup","tools"],n)}const y=e(n,["sessionResumption"]);void 0!==o&&null!=y&&t(o,["setup","sessionResumption"],function(n){const o={},i=e(n,["handle"]);if(null!=i&&t(o,["handle"],i),void 0!==e(n,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return o}(y));const v=e(n,["inputAudioTranscription"]);void 0!==o&&null!=v&&t(o,["setup","inputAudioTranscription"],{});const C=e(n,["outputAudioTranscription"]);void 0!==o&&null!=C&&t(o,["setup","outputAudioTranscription"],{});const _=e(n,["realtimeInputConfig"]);void 0!==o&&null!=_&&t(o,["setup","realtimeInputConfig"],function(n){const o={},i=e(n,["automaticActivityDetection"]);null!=i&&t(o,["automaticActivityDetection"],function(n){const o={},i=e(n,["disabled"]);null!=i&&t(o,["disabled"],i);const l=e(n,["startOfSpeechSensitivity"]);null!=l&&t(o,["startOfSpeechSensitivity"],l);const s=e(n,["endOfSpeechSensitivity"]);null!=s&&t(o,["endOfSpeechSensitivity"],s);const r=e(n,["prefixPaddingMs"]);null!=r&&t(o,["prefixPaddingMs"],r);const a=e(n,["silenceDurationMs"]);return null!=a&&t(o,["silenceDurationMs"],a),o}(i));const l=e(n,["activityHandling"]);null!=l&&t(o,["activityHandling"],l);const s=e(n,["turnCoverage"]);return null!=s&&t(o,["turnCoverage"],s),o}(_));const O=e(n,["contextWindowCompression"]);void 0!==o&&null!=O&&t(o,["setup","contextWindowCompression"],function(n){const o={},i=e(n,["triggerTokens"]);null!=i&&t(o,["triggerTokens"],i);const l=e(n,["slidingWindow"]);return null!=l&&t(o,["slidingWindow"],function(n){const o={},i=e(n,["targetTokens"]);return null!=i&&t(o,["targetTokens"],i),o}(l)),o}(O));const S=e(n,["proactivity"]);return void 0!==o&&null!=S&&t(o,["setup","proactivity"],function(n){const o={},i=e(n,["proactiveAudio"]);return null!=i&&t(o,["proactiveAudio"],i),o}(S)),{}}function mt(n){const o={},i=e(n,["baseModel"]);null!=i&&t(o,["baseModel"],i);const l=e(n,["trainingDataset"]);null!=l&&t(o,["tuningTask","trainingData"],function(n){const o={};if(void 0!==e(n,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==e(n,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=e(n,["examples"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["textInput"]);null!=i&&t(o,["textInput"],i);const l=e(n,["output"]);return null!=l&&t(o,["output"],l),o}(n))),t(o,["examples","examples"],n)}return o}(l));const s=e(n,["config"]);return null!=s&&t(o,["config"],function(n,o){const i={};if(void 0!==e(n,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const l=e(n,["tunedModelDisplayName"]);if(void 0!==o&&null!=l&&t(o,["displayName"],l),void 0!==e(n,["description"]))throw new Error("description parameter is not supported in Gemini API.");const s=e(n,["epochCount"]);void 0!==o&&null!=s&&t(o,["tuningTask","hyperparameters","epochCount"],s);const r=e(n,["learningRateMultiplier"]);if(null!=r&&t(i,["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==e(n,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==e(n,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const a=e(n,["batchSize"]);void 0!==o&&null!=a&&t(o,["tuningTask","hyperparameters","batchSize"],a);const u=e(n,["learningRate"]);return void 0!==o&&null!=u&&t(o,["tuningTask","hyperparameters","learningRate"],u),i}(s,o)),o}function ht(n){const o={},i=e(n,["baseModel"]);null!=i&&t(o,["baseModel"],i);const l=e(n,["trainingDataset"]);null!=l&&t(o,["supervisedTuningSpec","trainingDatasetUri"],function(n,o){const i=e(n,["gcsUri"]);void 0!==o&&null!=i&&t(o,["supervisedTuningSpec","trainingDatasetUri"],i);const l=e(n,["vertexDatasetResource"]);if(void 0!==o&&null!=l&&t(o,["supervisedTuningSpec","trainingDatasetUri"],l),void 0!==e(n,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.");return{}}(l,o));const s=e(n,["config"]);return null!=s&&t(o,["config"],function(n,o){const i={},l=e(n,["validationDataset"]);void 0!==o&&null!=l&&t(o,["supervisedTuningSpec"],function(n,o){const i={},l=e(n,["gcsUri"]);null!=l&&t(i,["validationDatasetUri"],l);const s=e(n,["vertexDatasetResource"]);return void 0!==o&&null!=s&&t(o,["supervisedTuningSpec","trainingDatasetUri"],s),i}(l,i));const s=e(n,["tunedModelDisplayName"]);void 0!==o&&null!=s&&t(o,["tunedModelDisplayName"],s);const r=e(n,["description"]);void 0!==o&&null!=r&&t(o,["description"],r);const a=e(n,["epochCount"]);void 0!==o&&null!=a&&t(o,["supervisedTuningSpec","hyperParameters","epochCount"],a);const u=e(n,["learningRateMultiplier"]);void 0!==o&&null!=u&&t(o,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const c=e(n,["exportLastCheckpointOnly"]);void 0!==o&&null!=c&&t(o,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const p=e(n,["adapterSize"]);if(void 0!==o&&null!=p&&t(o,["supervisedTuningSpec","hyperParameters","adapterSize"],p),void 0!==e(n,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==e(n,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");return i}(s,o)),o}function gt(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["state"]);null!=l&&t(o,["state"],O(l));const s=e(n,["createTime"]);null!=s&&t(o,["createTime"],s);const r=e(n,["tuningTask","startTime"]);null!=r&&t(o,["startTime"],r);const a=e(n,["tuningTask","completeTime"]);null!=a&&t(o,["endTime"],a);const u=e(n,["updateTime"]);null!=u&&t(o,["updateTime"],u);const c=e(n,["description"]);null!=c&&t(o,["description"],c);const p=e(n,["baseModel"]);null!=p&&t(o,["baseModel"],p);const d=e(n,["_self"]);null!=d&&t(o,["tunedModel"],function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["model"],i);const l=e(n,["name"]);return null!=l&&t(o,["endpoint"],l),o}(d));const f=e(n,["distillationSpec"]);null!=f&&t(o,["distillationSpec"],f);const m=e(n,["experiment"]);null!=m&&t(o,["experiment"],m);const h=e(n,["labels"]);null!=h&&t(o,["labels"],h);const g=e(n,["pipelineJob"]);null!=g&&t(o,["pipelineJob"],g);const y=e(n,["satisfiesPzi"]);null!=y&&t(o,["satisfiesPzi"],y);const v=e(n,["satisfiesPzs"]);null!=v&&t(o,["satisfiesPzs"],v);const C=e(n,["serviceAccount"]);null!=C&&t(o,["serviceAccount"],C);const T=e(n,["tunedModelDisplayName"]);return null!=T&&t(o,["tunedModelDisplayName"],T),o}function yt(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["state"]);null!=l&&t(o,["state"],O(l));const s=e(n,["createTime"]);null!=s&&t(o,["createTime"],s);const r=e(n,["startTime"]);null!=r&&t(o,["startTime"],r);const a=e(n,["endTime"]);null!=a&&t(o,["endTime"],a);const u=e(n,["updateTime"]);null!=u&&t(o,["updateTime"],u);const c=e(n,["error"]);null!=c&&t(o,["error"],c);const p=e(n,["description"]);null!=p&&t(o,["description"],p);const d=e(n,["baseModel"]);null!=d&&t(o,["baseModel"],d);const f=e(n,["tunedModel"]);null!=f&&t(o,["tunedModel"],function(n){const o={},i=e(n,["model"]);null!=i&&t(o,["model"],i);const l=e(n,["endpoint"]);null!=l&&t(o,["endpoint"],l);const s=e(n,["checkpoints"]);if(null!=s){let n=s;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["checkpointId"]);null!=i&&t(o,["checkpointId"],i);const l=e(n,["epoch"]);null!=l&&t(o,["epoch"],l);const s=e(n,["step"]);null!=s&&t(o,["step"],s);const r=e(n,["endpoint"]);return null!=r&&t(o,["endpoint"],r),o}(n))),t(o,["checkpoints"],n)}return o}(f));const m=e(n,["supervisedTuningSpec"]);null!=m&&t(o,["supervisedTuningSpec"],m);const h=e(n,["tuningDataStats"]);null!=h&&t(o,["tuningDataStats"],h);const g=e(n,["encryptionSpec"]);null!=g&&t(o,["encryptionSpec"],g);const y=e(n,["partnerModelTuningSpec"]);null!=y&&t(o,["partnerModelTuningSpec"],y);const v=e(n,["distillationSpec"]);null!=v&&t(o,["distillationSpec"],v);const C=e(n,["experiment"]);null!=C&&t(o,["experiment"],C);const T=e(n,["labels"]);null!=T&&t(o,["labels"],T);const E=e(n,["pipelineJob"]);null!=E&&t(o,["pipelineJob"],E);const A=e(n,["satisfiesPzi"]);null!=A&&t(o,["satisfiesPzi"],A);const _=e(n,["satisfiesPzs"]);null!=_&&t(o,["satisfiesPzs"],_);const S=e(n,["serviceAccount"]);null!=S&&t(o,["serviceAccount"],S);const I=e(n,["tunedModelDisplayName"]);return null!=I&&t(o,["tunedModelDisplayName"],I),o}function vt(n){return new Promise(t=>setTimeout(t,n))}var Ct,Tt,Et,At,_t,Ot,St,It,bt,Nt,Pt,wt,Rt,Mt,Dt,Ut,xt,Lt,qt,kt,Gt,Ft,jt,Vt,Jt,Bt,Ht,Yt,Kt,Wt,$t,zt,Xt,Zt,Qt,ne,te,ee,oe,ie,le,se,re,ae,ue,ce,pe,de,fe,me,he,ge,ye,ve,Ce,Te,Ee,Ae,_e,Oe,Se,Ie,be,Ne,Pe,we,Re,Me,De,Ue,xe,Le,qe,ke,Ge,Fe,je,Ve,Je,Be,He,Ye,Ke,We,$e,ze;let Xe,Ze;class Qe{}(ae=Ct||(Ct={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",ae.OUTCOME_OK="OUTCOME_OK",ae.OUTCOME_FAILED="OUTCOME_FAILED",ae.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(ue=Tt||(Tt={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",ue.PYTHON="PYTHON",(ce=Et||(Et={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",ce.STRING="STRING",ce.NUMBER="NUMBER",ce.INTEGER="INTEGER",ce.BOOLEAN="BOOLEAN",ce.ARRAY="ARRAY",ce.OBJECT="OBJECT",ce.NULL="NULL",(pe=At||(At={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",pe.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",pe.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",pe.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",pe.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",pe.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",pe.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",pe.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",pe.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",pe.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",(de=_t||(_t={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",de.SEVERITY="SEVERITY",de.PROBABILITY="PROBABILITY",(fe=Ot||(Ot={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",fe.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",fe.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",fe.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",fe.BLOCK_NONE="BLOCK_NONE",fe.OFF="OFF",(me=St||(St={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",me.MODE_DYNAMIC="MODE_DYNAMIC",(he=It||(It={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",he.NO_AUTH="NO_AUTH",he.API_KEY_AUTH="API_KEY_AUTH",he.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",he.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",he.OAUTH="OAUTH",he.OIDC_AUTH="OIDC_AUTH",(ge=bt||(bt={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",ge.SIMPLE_SEARCH="SIMPLE_SEARCH",ge.ELASTIC_SEARCH="ELASTIC_SEARCH",(ye=Nt||(Nt={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",ye.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(ve=Pt||(Pt={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",ve.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",ve.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",(Ce=wt||(wt={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",Ce.STOP="STOP",Ce.MAX_TOKENS="MAX_TOKENS",Ce.SAFETY="SAFETY",Ce.RECITATION="RECITATION",Ce.LANGUAGE="LANGUAGE",Ce.OTHER="OTHER",Ce.BLOCKLIST="BLOCKLIST",Ce.PROHIBITED_CONTENT="PROHIBITED_CONTENT",Ce.SPII="SPII",Ce.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",Ce.IMAGE_SAFETY="IMAGE_SAFETY",Ce.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",(Te=Rt||(Rt={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",Te.NEGLIGIBLE="NEGLIGIBLE",Te.LOW="LOW",Te.MEDIUM="MEDIUM",Te.HIGH="HIGH",(Ee=Mt||(Mt={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",Ee.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",Ee.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",Ee.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",Ee.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(Ae=Dt||(Dt={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",Ae.SAFETY="SAFETY",Ae.OTHER="OTHER",Ae.BLOCKLIST="BLOCKLIST",Ae.PROHIBITED_CONTENT="PROHIBITED_CONTENT",Ae.IMAGE_SAFETY="IMAGE_SAFETY",(_e=Ut||(Ut={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",_e.ON_DEMAND="ON_DEMAND",_e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(Oe=xt||(xt={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Oe.TEXT="TEXT",Oe.IMAGE="IMAGE",Oe.AUDIO="AUDIO",(Se=Lt||(Lt={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",Se.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",Se.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",Se.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(Ie=qt||(qt={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",Ie.JOB_STATE_QUEUED="JOB_STATE_QUEUED",Ie.JOB_STATE_PENDING="JOB_STATE_PENDING",Ie.JOB_STATE_RUNNING="JOB_STATE_RUNNING",Ie.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",Ie.JOB_STATE_FAILED="JOB_STATE_FAILED",Ie.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",Ie.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",Ie.JOB_STATE_PAUSED="JOB_STATE_PAUSED",Ie.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",Ie.JOB_STATE_UPDATING="JOB_STATE_UPDATING",Ie.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(be=kt||(kt={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",be.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",be.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",be.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",be.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",be.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",be.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(Ne=Gt||(Gt={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",Ne.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",Ne.BALANCED="BALANCED",Ne.PRIORITIZE_COST="PRIORITIZE_COST",(Pe=Ft||(Ft={})).UNSPECIFIED="UNSPECIFIED",Pe.BLOCKING="BLOCKING",Pe.NON_BLOCKING="NON_BLOCKING",(we=jt||(jt={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",we.MODE_DYNAMIC="MODE_DYNAMIC",(Re=Vt||(Vt={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Re.AUTO="AUTO",Re.ANY="ANY",Re.NONE="NONE",(Me=Jt||(Jt={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Me.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Me.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",Me.BLOCK_NONE="BLOCK_NONE",(De=Bt||(Bt={})).DONT_ALLOW="DONT_ALLOW",De.ALLOW_ADULT="ALLOW_ADULT",De.ALLOW_ALL="ALLOW_ALL",(Ue=Ht||(Ht={})).auto="auto",Ue.en="en",Ue.ja="ja",Ue.ko="ko",Ue.hi="hi",Ue.zh="zh",Ue.pt="pt",Ue.es="es",(xe=Yt||(Yt={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",xe.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",xe.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",xe.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",xe.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(Le=Kt||(Kt={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",Le.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",Le.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",Le.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(qe=Wt||(Wt={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",qe.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",qe.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",qe.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(ke=$t||($t={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",ke.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",ke.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",ke.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",ke.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",ke.EDIT_MODE_STYLE="EDIT_MODE_STYLE",ke.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",ke.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(Ge=zt||(zt={})).OPTIMIZED="OPTIMIZED",Ge.LOSSLESS="LOSSLESS",(Fe=Xt||(Xt={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Fe.PROCESSING="PROCESSING",Fe.ACTIVE="ACTIVE",Fe.FAILED="FAILED",(je=Zt||(Zt={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",je.UPLOADED="UPLOADED",je.GENERATED="GENERATED",(Ve=Qt||(Qt={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Ve.TEXT="TEXT",Ve.IMAGE="IMAGE",Ve.VIDEO="VIDEO",Ve.AUDIO="AUDIO",Ve.DOCUMENT="DOCUMENT",(Je=ne||(ne={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",Je.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",Je.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(Be=te||(te={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",Be.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",Be.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(He=ee||(ee={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",He.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",He.NO_INTERRUPTION="NO_INTERRUPTION",(Ye=oe||(oe={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",Ye.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",Ye.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(Ke=ie||(ie={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",Ke.SILENT="SILENT",Ke.WHEN_IDLE="WHEN_IDLE",Ke.INTERRUPT="INTERRUPT",(We=le||(le={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",We.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",We.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",We.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",We.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",We.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",We.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",We.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",We.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",We.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",We.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",We.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",We.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",($e=se||(se={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",$e.PLAY="PLAY",$e.PAUSE="PAUSE",$e.STOP="STOP",$e.RESET_CONTEXT="RESET_CONTEXT";class no{constructor(n){const t={};for(const e of n.headers.entries())t[e[0]]=e[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class to{get text(){var n,t,e,o,i,l,s,r;if(0===(null===(o=null===(e=null===(t=null===(n=this.candidates)||void 0===n?void 0:n[0])||void 0===t?void 0:t.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;let a="",u=!1;const c=[];for(const p of null!==(r=null===(s=null===(l=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===l?void 0:l.content)||void 0===s?void 0:s.parts)&&void 0!==r?r:[]){for(const[n,t]of Object.entries(p))"text"===n||"thought"===n||null===t&&void 0===t||c.push(n);if("string"==typeof p.text){if("boolean"==typeof p.thought&&p.thought)continue;u=!0,a+=p.text}}return c.length,u?a:void 0}get data(){var n,t,e,o,i,l,s,r;if(0===(null===(o=null===(e=null===(t=null===(n=this.candidates)||void 0===n?void 0:n[0])||void 0===t?void 0:t.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;let a="";const u=[];for(const c of null!==(r=null===(s=null===(l=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===l?void 0:l.content)||void 0===s?void 0:s.parts)&&void 0!==r?r:[]){for(const[n,t]of Object.entries(c))"inlineData"===n||null===t&&void 0===t||u.push(n);c.inlineData&&"string"==typeof c.inlineData.data&&(a+=atob(c.inlineData.data))}return u.length,a.length>0?btoa(a):void 0}get functionCalls(){var n,t,e,o,i,l,s,r;if(0===(null===(o=null===(e=null===(t=null===(n=this.candidates)||void 0===n?void 0:n[0])||void 0===t?void 0:t.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;const a=null===(r=null===(s=null===(l=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===l?void 0:l.content)||void 0===s?void 0:s.parts)||void 0===r?void 0:r.filter(n=>n.functionCall).map(n=>n.functionCall).filter(n=>void 0!==n);return 0!==(null==a?void 0:a.length)?a:void 0}get executableCode(){var n,t,e,o,i,l,s,r,a;if(0===(null===(o=null===(e=null===(t=null===(n=this.candidates)||void 0===n?void 0:n[0])||void 0===t?void 0:t.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;const u=null===(r=null===(s=null===(l=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===l?void 0:l.content)||void 0===s?void 0:s.parts)||void 0===r?void 0:r.filter(n=>n.executableCode).map(n=>n.executableCode).filter(n=>void 0!==n);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.code:void 0}get codeExecutionResult(){var n,t,e,o,i,l,s,r,a;if(0===(null===(o=null===(e=null===(t=null===(n=this.candidates)||void 0===n?void 0:n[0])||void 0===t?void 0:t.content)||void 0===e?void 0:e.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;const u=null===(r=null===(s=null===(l=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===l?void 0:l.content)||void 0===s?void 0:s.parts)||void 0===r?void 0:r.filter(n=>n.codeExecutionResult).map(n=>n.codeExecutionResult).filter(n=>void 0!==n);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.output:void 0}}class eo{}class oo{}class io{}class lo{}class so{}class ro{}class ao{}class uo{}class co{}class po{}class fo{}class mo{}class ho{}class go{}class yo{}class vo{get text(){var n,t,e;let o="",i=!1;const l=[];for(const s of null!==(e=null===(t=null===(n=this.serverContent)||void 0===n?void 0:n.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==e?e:[]){for(const[n,t]of Object.entries(s))"text"!==n&&"thought"!==n&&null!==t&&l.push(n);if("string"==typeof s.text){if("boolean"==typeof s.thought&&s.thought)continue;i=!0,o+=s.text}}return l.length,i?o:void 0}get data(){var n,t,e;let o="";const i=[];for(const l of null!==(e=null===(t=null===(n=this.serverContent)||void 0===n?void 0:n.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==e?e:[]){for(const[n,t]of Object.entries(l))"inlineData"!==n&&null!==t&&i.push(n);l.inlineData&&"string"==typeof l.inlineData.data&&(o+=atob(l.inlineData.data))}return i.length,o.length>0?btoa(o):void 0}}class Co{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}(ze=re||(re={})).PAGED_ITEM_BATCH_JOBS="batchJobs",ze.PAGED_ITEM_MODELS="models",ze.PAGED_ITEM_TUNING_JOBS="tuningJobs",ze.PAGED_ITEM_FILES="files",ze.PAGED_ITEM_CACHED_CONTENTS="cachedContents";class To{constructor(n,t,e,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,e,o)}init(n,t,e){var o,i;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};l=e?"object"==typeof e?Object.assign({},e):e:{config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=null!==(i=null===(o=l.config)||void 0===o?void 0:o.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return void 0!==(null===(n=this.params.config)||void 0===n?void 0:n.pageToken)}}class Eo extends Qe{constructor(n){super(),this.apiClient=n,this.create=async n=>{if(this.apiClient.isVertexAI()){const t=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},void 0===n.config.displayName&&(n.config.displayName="genaiBatchJob_${timestampStr}"),void 0===n.config.dest&&"string"==typeof n.src)if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else{if(!n.src.startsWith("bq://"))throw new Error("Unsupported source:"+n.src);n.config.dest=`${n.src}_dest_${t}`}}return await this.createInternal(n)},this.list=async(n={})=>new To(re.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(n),n)}async createInternal(t){var e,o,i,l;let s,r="",a={};if(this.apiClient.isVertexAI()){const i=F(this.apiClient,t);return r=n("batchPredictionJobs",i._url),a=i._query,delete i.config,delete i._url,delete i._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(e=t.config)||void 0===e?void 0:e.httpOptions,abortSignal:null===(o=t.config)||void 0===o?void 0:o.abortSignal}).then(n=>n.json()),s.then(n=>B(n))}{const e=G(this.apiClient,t);return r=n("{model}:batchGenerateContent",e._url),a=e._query,delete e.config,delete e._url,delete e._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(e),httpMethod:"POST",httpOptions:null===(i=t.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=t.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(n=>V(n))}}async get(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],M(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("batchPredictionJobs/{name}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>B(n))}{const i=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],M(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("batches/{name}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>V(n))}}async cancel(o){var i,l,s,r;let a="",u={};if(this.apiClient.isVertexAI()){const s=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],M(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);a=n("batchPredictionJobs/{name}:cancel",s._url),u=s._query,delete s.config,delete s._url,delete s._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal})}else{const i=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],M(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);a=n("batches/{name}:cancel",i._url),u=i._query,delete i.config,delete i._url,delete i._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal})}}async listInternal(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n){const o={},i=e(n,["config"]);return null!=i&&t(o,["config"],function(n,o){const i=e(n,["pageSize"]);void 0!==o&&null!=i&&t(o,["_query","pageSize"],i);const l=e(n,["pageToken"]);void 0!==o&&null!=l&&t(o,["_query","pageToken"],l);const s=e(n,["filter"]);return void 0!==o&&null!=s&&t(o,["_query","filter"],s),{}}(i,o)),o}(o);return u=n("batchPredictionJobs",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["batchPredictionJobs"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>B(n))),t(o,["batchJobs"],n)}return o}(n),i=new yo;return Object.assign(i,o),i})}{const i=function(n){const o={},i=e(n,["config"]);return null!=i&&t(o,["config"],function(n,o){const i=e(n,["pageSize"]);void 0!==o&&null!=i&&t(o,["_query","pageSize"],i);const l=e(n,["pageToken"]);if(void 0!==o&&null!=l&&t(o,["_query","pageToken"],l),void 0!==e(n,["filter"]))throw new Error("filter parameter is not supported in Gemini API.");return{}}(i,o)),o}(o);return u=n("batches",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["operations"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>V(n))),t(o,["batchJobs"],n)}return o}(n),i=new yo;return Object.assign(i,o),i})}}async delete(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],M(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("batchPredictionJobs/{name}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["done"]);null!=l&&t(o,["done"],l);const s=e(n,["error"]);return null!=s&&t(o,["error"],J(s)),o}(n))}{const i=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],M(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("batches/{name}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["done"]);return null!=l&&t(o,["done"],l),null!=e(n,["error"])&&t(o,["error"],{}),o}(n))}}}class Ao extends Qe{constructor(n){super(),this.apiClient=n,this.list=async(n={})=>new To(re.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(n),n)}async create(o){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,o){const l={},s=e(o,["model"]);null!=s&&t(l,["model"],i(n,s));const r=e(o,["config"]);return null!=r&&t(l,["config"],function(n,o){const i=e(n,["ttl"]);void 0!==o&&null!=i&&t(o,["ttl"],i);const l=e(n,["expireTime"]);void 0!==o&&null!=l&&t(o,["expireTime"],l);const s=e(n,["displayName"]);void 0!==o&&null!=s&&t(o,["displayName"],s);const r=e(n,["contents"]);if(void 0!==o&&null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>W(n))),t(o,["contents"],n)}const a=e(n,["systemInstruction"]);void 0!==o&&null!=a&&t(o,["systemInstruction"],W(m(a)));const u=e(n,["tools"]);if(void 0!==o&&null!=u){let n=u;Array.isArray(n)&&(n=n.map(n=>$(n))),t(o,["tools"],n)}const c=e(n,["toolConfig"]);void 0!==o&&null!=c&&t(o,["toolConfig"],z(c));const p=e(n,["kmsKeyName"]);return void 0!==o&&null!=p&&t(o,["encryption_spec","kmsKeyName"],p),{}}(r,l)),l}(this.apiClient,o);return c=n("cachedContents",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(l=o.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=o.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(n=>Z(n))}{const l=function(n,o){const l={},s=e(o,["model"]);null!=s&&t(l,["model"],i(n,s));const r=e(o,["config"]);return null!=r&&t(l,["config"],function(n,o){const i=e(n,["ttl"]);void 0!==o&&null!=i&&t(o,["ttl"],i);const l=e(n,["expireTime"]);void 0!==o&&null!=l&&t(o,["expireTime"],l);const s=e(n,["displayName"]);void 0!==o&&null!=s&&t(o,["displayName"],s);const r=e(n,["contents"]);if(void 0!==o&&null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>H(n))),t(o,["contents"],n)}const a=e(n,["systemInstruction"]);void 0!==o&&null!=a&&t(o,["systemInstruction"],H(m(a)));const u=e(n,["tools"]);if(void 0!==o&&null!=u){let n=u;Array.isArray(n)&&(n=n.map(n=>Y(n))),t(o,["tools"],n)}const c=e(n,["toolConfig"]);if(void 0!==o&&null!=c&&t(o,["toolConfig"],K(c)),void 0!==e(n,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}(r,l)),l}(this.apiClient,o);return c=n("cachedContents",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(r=o.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=o.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(n=>X(n))}}async get(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],_(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("{name}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>Z(n))}{const i=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],_(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("{name}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>X(n))}}async delete(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],_(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("{name}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(()=>{const n=new po;return Object.assign(n,{}),n})}{const i=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],_(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],s),i}(this.apiClient,o);return u=n("{name}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(()=>{const n=new po;return Object.assign(n,{}),n})}}async update(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],_(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],function(n,o){const i=e(n,["ttl"]);void 0!==o&&null!=i&&t(o,["ttl"],i);const l=e(n,["expireTime"]);return void 0!==o&&null!=l&&t(o,["expireTime"],l),{}}(s,i)),i}(this.apiClient,o);return u=n("{name}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"PATCH",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>Z(n))}{const i=function(n,o){const i={},l=e(o,["name"]);null!=l&&t(i,["_url","name"],_(n,l));const s=e(o,["config"]);return null!=s&&t(i,["config"],function(n,o){const i=e(n,["ttl"]);void 0!==o&&null!=i&&t(o,["ttl"],i);const l=e(n,["expireTime"]);return void 0!==o&&null!=l&&t(o,["expireTime"],l),{}}(s,i)),i}(this.apiClient,o);return u=n("{name}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"PATCH",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>X(n))}}async listInternal(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n){const o={},i=e(n,["config"]);return null!=i&&t(o,["config"],function(n,o){const i=e(n,["pageSize"]);void 0!==o&&null!=i&&t(o,["_query","pageSize"],i);const l=e(n,["pageToken"]);return void 0!==o&&null!=l&&t(o,["_query","pageToken"],l),{}}(i,o)),o}(o);return u=n("cachedContents",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["cachedContents"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>Z(n))),t(o,["cachedContents"],n)}return o}(n),i=new fo;return Object.assign(i,o),i})}{const i=function(n){const o={},i=e(n,["config"]);return null!=i&&t(o,["config"],function(n,o){const i=e(n,["pageSize"]);void 0!==o&&null!=i&&t(o,["_query","pageSize"],i);const l=e(n,["pageToken"]);return void 0!==o&&null!=l&&t(o,["_query","pageToken"],l),{}}(i,o)),o}(o);return u=n("cachedContents",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["cachedContents"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>X(n))),t(o,["cachedContents"],n)}return o}(n),i=new fo;return Object.assign(i,o),i})}}}"function"==typeof SuppressedError&&SuppressedError;class _o{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new Oo(this.apiClient,this.modelsModule,n.model,n.config,structuredClone(n.history))}}class Oo{constructor(n,t,e,o={},i=[]){this.apiClient=n,this.modelsModule=t,this.model=e,this.config=o,this.history=i,this.sendPromise=Promise.resolve(),function(n){if(0!==n.length)for(const t of n)if("user"!==t.role&&"model"!==t.role)throw new Error(`Role must be user or model, but got ${t.role}.`)}(i)}async sendMessage(n){var t;await this.sendPromise;const e=m(n.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(e),config:null!==(t=n.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var n,t,i;const l=await o,s=null===(t=null===(n=l.candidates)||void 0===n?void 0:n[0])||void 0===t?void 0:t.content,r=l.automaticFunctionCallingHistory,a=this.getHistory(!0).length;let u=[];null!=r&&(u=null!==(i=r.slice(a))&&void 0!==i?i:[]);const c=s?[s]:[];this.recordHistory(e,c,u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(n){var t;await this.sendPromise;const e=m(n.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(e),config:null!==(t=n.config)&&void 0!==t?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const i=await o;return this.processStreamResponse(i,e)}getHistory(n=!1){const t=n?sn(this.history):this.history;return structuredClone(t)}processStreamResponse(n,t){var e,o;return tn(this,arguments,function*(){var i,l,s,r,a,u,c;const p=[];try{for(a=!0,u=en(n);!(i=(c=yield nn(u.next())).done);a=!0){r=c.value,a=!1;const n=r;if(on(n)){const t=null===(o=null===(e=n.candidates)||void 0===e?void 0:e[0])||void 0===o?void 0:o.content;void 0!==t&&p.push(t)}yield yield nn(n)}}catch(d){l={error:d}}finally{try{a||i||!(s=u.return)||(yield nn(s.call(u)))}finally{if(l)throw l.error}}this.recordHistory(t,p)})}recordHistory(n,t,e){let o=[];t.length>0&&t.every(n=>void 0!==n.role)?o=t:o.push({role:"model",parts:[]}),e&&e.length>0?this.history.push(...sn(e)):this.history.push(n),this.history.push(...o)}}class So extends Error{constructor(n){super(n.message),this.name="ApiError",this.status=n.status,Object.setPrototypeOf(this,So.prototype)}}class Io extends Qe{constructor(n){super(),this.apiClient=n,this.list=async(n={})=>new To(re.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(n),n)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(n=>rn(n))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(o){var i,l;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=function(n){const o={},i=e(n,["config"]);return null!=i&&t(o,["config"],function(n,o){const i=e(n,["pageSize"]);void 0!==o&&null!=i&&t(o,["_query","pageSize"],i);const l=e(n,["pageToken"]);return void 0!==o&&null!=l&&t(o,["_query","pageToken"],l),{}}(i,o)),o}(o);return r=n("files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["files"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>rn(n))),t(o,["files"],n)}return o}(n),i=new mo;return Object.assign(i,o),i})}}async createInternal(o){var i,l;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=function(n){const o={},i=e(n,["file"]);null!=i&&t(o,["file"],function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["displayName"]);null!=l&&t(o,["displayName"],l);const s=e(n,["mimeType"]);null!=s&&t(o,["mimeType"],s);const r=e(n,["sizeBytes"]);null!=r&&t(o,["sizeBytes"],r);const a=e(n,["createTime"]);null!=a&&t(o,["createTime"],a);const u=e(n,["expirationTime"]);null!=u&&t(o,["expirationTime"],u);const c=e(n,["updateTime"]);null!=c&&t(o,["updateTime"],c);const p=e(n,["sha256Hash"]);null!=p&&t(o,["sha256Hash"],p);const d=e(n,["uri"]);null!=d&&t(o,["uri"],d);const f=e(n,["downloadUri"]);null!=f&&t(o,["downloadUri"],f);const m=e(n,["state"]);null!=m&&t(o,["state"],m);const h=e(n,["source"]);null!=h&&t(o,["source"],h);const g=e(n,["videoMetadata"]);null!=g&&t(o,["videoMetadata"],g);const y=e(n,["error"]);return null!=y&&t(o,["error"],function(n){const o={},i=e(n,["details"]);null!=i&&t(o,["details"],i);const l=e(n,["message"]);null!=l&&t(o,["message"],l);const s=e(n,["code"]);return null!=s&&t(o,["code"],s),o}(y)),o}(i));const l=e(n,["config"]);return null!=l&&t(o,["config"],l),o}(o);return r=n("upload/v1beta/files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(()=>{const n=new ho;return Object.assign(n,{}),n})}}async get(o){var i,l;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["_url","file"],I(i));const l=e(n,["config"]);return null!=l&&t(o,["config"],l),o}(o);return r=n("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(n=>rn(n))}}async delete(o){var i,l;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["_url","file"],I(i));const l=e(n,["config"]);return null!=l&&t(o,["config"],l),o}(o);return r=n("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(()=>{const n=new go;return Object.assign(n,{}),n})}}}const bo="x-goog-api-client",No=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Po{constructor(n){var t,e;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=null!==(e=this.clientOptions.apiVersion)&&void 0!==e?e:"v1beta",o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var n;return null!==(n=this.clientOptions.vertexai)&&void 0!==n&&n}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||void 0===n.baseUrl||void 0===n.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&""!==n.apiVersion&&t.push(n.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(n){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=n}constructUrl(n,t,e){const o=[this.getRequestUrlInternal(t)];return e&&o.push(this.getBaseResourcePath()),""!==n&&o.push(n),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||"GET"===n.httpMethod&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const e=this.shouldPrependVertexProjectPath(n),o=this.constructUrl(n.path,t,e);if(n.queryParams)for(const[l,s]of Object.entries(n.queryParams))o.searchParams.append(l,String(s));let i={};if("GET"===n.httpMethod){if(n.body&&"{}"!==n.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=n.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,n.abortSignal),this.unaryApiCall(o,i,n.httpMethod)}patchHttpOptions(n,t){const e=JSON.parse(JSON.stringify(n));for(const[o,i]of Object.entries(t))"object"==typeof i?e[o]=Object.assign(Object.assign({},e[o]),i):void 0!==i&&(e[o]=i);return e}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const e=this.shouldPrependVertexProjectPath(n),o=this.constructUrl(n.path,t,e);o.searchParams.has("alt")&&"sse"===o.searchParams.get("alt")||o.searchParams.set("alt","sse");let i={};return i.body=n.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,n.abortSignal),this.streamApiCall(o,i,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,e){if(t&&t.timeout||e){const o=new AbortController,i=o.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){const n=setTimeout(()=>o.abort(),t.timeout);n&&"function"==typeof n.unref&&n.unref()}e&&e.addEventListener("abort",()=>{o.abort()}),n.signal=i}return t&&null!==t.extraBody&&function(n,t){if(!t||0===Object.keys(t).length)return;if(n.body instanceof Blob)return;let e={};if("string"==typeof n.body&&n.body.length>0)try{const t=JSON.parse(n.body);if("object"!=typeof t||null===t||Array.isArray(t))return;e=t}catch(i){return}const o=function n(t,e){const o=Object.assign({},t);for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const t=e[i],l=o[i];t&&"object"==typeof t&&!Array.isArray(t)&&l&&"object"==typeof l&&!Array.isArray(l)?o[i]=n(l,t):o[i]=t}return o}(e,t);n.body=JSON.stringify(o)}(n,t.extraBody),n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,e){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:e})).then(async n=>(await tt(n),new no(n))).catch(n=>{throw n instanceof Error?n:new Error(JSON.stringify(n))})}async streamApiCall(n,t,e){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:e})).then(async n=>(await tt(n),this.processStreamResponse(n))).catch(n=>{throw n instanceof Error?n:new Error(JSON.stringify(n))})}processStreamResponse(n){var t;return tn(this,arguments,function*(){const e=null===(t=null==n?void 0:n.body)||void 0===t?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!e)throw new Error("Response body is empty");try{let t="";for(;;){const{done:l,value:s}=yield nn(e.read());if(l){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const r=o.decode(s,{stream:!0});try{const n=JSON.parse(r);if("error"in n){const t=JSON.parse(JSON.stringify(n.error)),e=t.status,o=t.code,i=`got status: ${e}. ${JSON.stringify(n)}`;if(o>=400&&o<600)throw new So({message:i,status:o})}}catch(i){if("ApiError"===i.name)throw i}t+=r;let a=t.match(No);for(;a;){const e=a[1];try{const o=new Response(e,{headers:null==n?void 0:n.headers,status:null==n?void 0:n.status,statusText:null==n?void 0:n.statusText});yield yield nn(new no(o)),t=t.slice(a[0].length),a=t.match(No)}catch(i){throw new Error(`exception parsing stream chunk ${e}. ${i}`)}}}}finally{e.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const n={},t="google-genai-sdk/1.9.0 "+this.clientOptions.userAgentExtra;return n["User-Agent"]=t,n[bo]=t,n["Content-Type"]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[e,o]of Object.entries(n.headers))t.append(e,o);n.timeout&&n.timeout>0&&t.append("X-Server-Timeout",String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var e;const o={};null!=t&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const i=this.clientOptions.uploader,l=await i.stat(n);o.sizeBytes=String(l.size);const s=null!==(e=null==t?void 0:t.mimeType)&&void 0!==e?e:l.type;if(void 0===s||""===s)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=s;const r=await this.fetchUploadUrl(o,t);return i.upload(n,r,this)}async downloadFile(n){const t=this.clientOptions.downloader;await t.download(n,this)}async fetchUploadUrl(t,e){var o;let i={};i=(null==e?void 0:e.httpOptions)?e.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},s=await this.request({path:n("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:i});if(!s||!(null==s?void 0:s.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const r=null===(o=null==s?void 0:s.headers)||void 0===o?void 0:o["x-goog-upload-url"];if(void 0===r)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return r}}class wo{constructor(n=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=n,this.config=t}static create(n,t){return new wo(n,t)}async initialize(){var n,t,e,o,i,l,s;if(this.mcpTools.length>0)return;const r={},a=[];for(const c of this.mcpClients)try{for(i=!0,t=void 0,l=en(lt(c));!(n=(s=await l.next()).done);i=!0){o=s.value,i=!1;const n=o;a.push(n);const t=n.name;if(r[t])throw new Error(`Duplicate function name ${t} found in MCP tools. Please ensure function names are unique.`);r[t]=c}}catch(u){t={error:u}}finally{try{i||n||!(e=l.return)||await e.call(l)}finally{if(t)throw t.error}}this.mcpTools=a,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),function(n,t={}){const e=[],o=new Set;for(const i of n){const n=i.name;if(o.has(n))throw new Error(`Duplicate function name ${n} found in MCP tools. Please ensure function names are unique.`);o.add(n);const l=w(i,t);l.functionDeclarations&&e.push(...l.functionDeclarations)}return{functionDeclarations:e}}(this.mcpTools,this.config)}async callTool(n){await this.initialize();const t=[];for(const e of n)if(e.name in this.functionNameToMcpClient){const n=this.functionNameToMcpClient[e.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const i=await n.callTool({name:e.name,arguments:e.args},void 0,o);t.push({functionResponse:{name:e.name,response:i.isError?{error:i}:i}})}return t}}class Ro{constructor(n,t,e){this.apiClient=n,this.auth=t,this.webSocketFactory=e}async connect(n){var t,e;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");const i=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),s=function(n){const t=new Headers;for(const[e,o]of Object.entries(n))t.append(e,o);return t}(this.apiClient.getDefaultHeaders()),r=`${i}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${this.apiClient.getApiKey()}`;let a=()=>{};const u=new Promise(n=>{a=n}),c=n.callbacks,p=(this.apiClient,{onopen:function(){a({})},onmessage:n=>{!async function(n,t,e){const o=new Co;let i;i=e.data instanceof Blob?JSON.parse(await e.data.text()):JSON.parse(e.data);const l=Pn(i);Object.assign(o,l),t(o)}(0,c.onmessage,n)},onerror:null!==(t=null==c?void 0:c.onerror)&&void 0!==t?t:function(n){},onclose:null!==(e=null==c?void 0:c.onclose)&&void 0!==e?e:function(n){}}),d=this.webSocketFactory.create(r,function(n){const t={};return n.forEach((n,e)=>{t[e]=n}),t}(s),p);d.connect(),await u;const f=Cn({setup:yn({model:o(this.apiClient,n.model)})});return d.send(JSON.stringify(f)),new Mo(d,this.apiClient)}}class Mo{constructor(n,t){this.conn=n,this.apiClient=t}async setWeightedPrompts(n){if(!n.weightedPrompts||0===Object.keys(n.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const o=vn(function(n){const o={},i=e(n,["weightedPrompts"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>hn(n))),t(o,["weightedPrompts"],n)}return o}(n));this.conn.send(JSON.stringify({clientContent:o}))}async setMusicGenerationConfig(n){n.musicGenerationConfig||(n.musicGenerationConfig={});const o=Cn(function(n){const o={},i=e(n,["musicGenerationConfig"]);return null!=i&&t(o,["musicGenerationConfig"],gn(i)),o}(n));this.conn.send(JSON.stringify(o))}sendPlaybackControl(n){const t=Cn({playbackControl:n});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(se.PLAY)}pause(){this.sendPlaybackControl(se.PAUSE)}stop(){this.sendPlaybackControl(se.STOP)}resetContext(){this.sendPlaybackControl(se.RESET_CONTEXT)}close(){this.conn.close()}}class Do{constructor(n,t,e){this.apiClient=n,this.auth=t,this.webSocketFactory=e,this.music=new Ro(this.apiClient,this.auth,this.webSocketFactory)}async connect(n){var i,l,s,r,a,u;const c=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let d;const f=this.apiClient.getDefaultHeaders();n.config&&n.config.tools&&et(n.config.tools)&&ot(f);const m=function(n){const t=new Headers;for(const[e,o]of Object.entries(n))t.append(e,o);return t}(f);if(this.apiClient.isVertexAI())d=`${c}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const n=this.apiClient.getApiKey();let t="BidiGenerateContent",e="key";(null==n?void 0:n.startsWith("auth_tokens/"))&&(t="BidiGenerateContentConstrained",e="access_token"),d=`${c}/ws/google.ai.generativelanguage.${p}.GenerativeService.${t}?${e}=${n}`}let h=()=>{};const g=new Promise(n=>{h=n}),y=n.callbacks,v=this.apiClient,C={onopen:function(){var n;null===(n=null==y?void 0:y.onopen)||void 0===n||n.call(y),h({})},onmessage:n=>{!async function(n,t,e){const o=new vo;let i;i=e.data instanceof Blob?await e.data.text():e.data instanceof ArrayBuffer?(new TextDecoder).decode(e.data):e.data;const l=JSON.parse(i);if(n.isVertexAI()){const n=bn(l);Object.assign(o,n)}else{const n=In(l);Object.assign(o,n)}t(o)}(v,y.onmessage,n)},onerror:null!==(i=null==y?void 0:y.onerror)&&void 0!==i?i:function(n){},onclose:null!==(l=null==y?void 0:y.onclose)&&void 0!==l?l:function(n){}},T=this.webSocketFactory.create(d,function(n){const t={};return n.forEach((n,e)=>{t[e]=n}),t}(m),C);T.connect(),await g;let E=o(this.apiClient,n.model);this.apiClient.isVertexAI()&&E.startsWith("publishers/")&&(E=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+E);let A={};this.apiClient.isVertexAI()&&void 0===(null===(s=n.config)||void 0===s?void 0:s.responseModalities)&&(void 0===n.config?n.config={responseModalities:[xt.AUDIO]}:n.config.responseModalities=[xt.AUDIO]),null===(r=n.config)||void 0===r||r.generationConfig;const _=null!==(u=null===(a=n.config)||void 0===a?void 0:a.tools)&&void 0!==u?u:[],O=[];for(const t of _)if(this.isCallableTool(t)){const n=t;O.push(await n.tool())}else O.push(t);O.length>0&&(n.config.tools=O);const S={model:E,config:n.config,callbacks:n.callbacks};return A=this.apiClient.isVertexAI()?function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["setup","model"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],dn(r,l)),l}(this.apiClient,S):function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["setup","model"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],pn(r,l)),l}(this.apiClient,S),delete A.config,T.send(JSON.stringify(A)),new xo(T,this.apiClient)}isCallableTool(n){return"callTool"in n&&"function"==typeof n.callTool}}const Uo={turnComplete:!0};class xo{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(null!==t.turns&&void 0!==t.turns){let o=[];try{o=g(t.turns),o=n.isVertexAI()?o.map(n=>Ln(n)):o.map(n=>wn(n))}catch(e){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:o,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let e=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(e=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===e.length)throw new Error("functionResponses is required.");for(const o of e){if("object"!=typeof o||null===o||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:e}}}sendClientContent(n){n=Object.assign(Object.assign({},Uo),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:mn(n)}:{realtimeInput:fn(n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(null==n.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}class Lo extends Qe{constructor(n){super(),this.apiClient=n,this.generateContent=async n=>{var t,e,o,i,l;const s=await this.processParamsForMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!function(n){var t,e,o;return null!==(o=null===(e=null===(t=n.config)||void 0===t?void 0:t.tools)||void 0===e?void 0:e.some(n=>it(n)))&&void 0!==o&&o}(n)||st(n.config))return await this.generateContentInternal(s);if(function(n){var t,e,o;return null!==(o=null===(e=null===(t=n.config)||void 0===t?void 0:t.tools)||void 0===e?void 0:e.some(n=>!it(n)))&&void 0!==o&&o}(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let r,a;const u=g(s.contents),c=null!==(o=null===(e=null===(t=s.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===e?void 0:e.maximumRemoteCalls)&&void 0!==o?o:10;let p=0;for(;p<c&&(r=await this.generateContentInternal(s),r.functionCalls&&0!==r.functionCalls.length);){const t=r.candidates[0].content,e=[];for(const o of null!==(l=null===(i=n.config)||void 0===i?void 0:i.tools)&&void 0!==l?l:[])if(rt(o)){const n=o,t=await n.callTool(r.functionCalls);e.push(...t)}p++,a={role:"user",parts:e},s.contents=g(s.contents),s.contents.push(t),s.contents.push(a),at(s.config)&&(u.push(t),u.push(a))}return at(s.config)&&(r.automaticFunctionCallingHistory=u),r},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),st(n.config)){const t=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(t)}return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(n=>{var t;let e;const o=[];if(null==n?void 0:n.generatedImages)for(const l of n.generatedImages)l&&(null==l?void 0:l.safetyAttributes)&&"Positive Prompt"===(null===(t=null==l?void 0:l.safetyAttributes)||void 0===t?void 0:t.contentType)?e=null==l?void 0:l.safetyAttributes:o.push(l);let i;return i=e?{generatedImages:o,positivePromptSafetyAttributes:e}:{generatedImages:o},i}),this.list=async n=>{var t;const e={config:Object.assign(Object.assign({},{queryBase:!0}),null==n?void 0:n.config)};if(this.apiClient.isVertexAI()&&!e.config.queryBase){if(null===(t=e.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");e.config.filter="labels.tune-type:*"}return new To(re.PAGED_ITEM_MODELS,n=>this.listInternal(n),await this.listInternal(e),e)},this.editImage=async n=>{const t={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(t.referenceImages=n.referenceImages.map(n=>n.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async n=>{let t={numberOfImages:1,mode:"upscale"};n.config&&(t=Object.assign(Object.assign({},t),n.config));const e={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:t};return await this.upscaleImageInternal(e)}}maybeMoveToResponseJsonSchem(n){n.config&&n.config.responseSchema&&(n.config.responseJsonSchema||Object.keys(n.config.responseSchema).includes("$schema")&&(n.config.responseJsonSchema=n.config.responseSchema,delete n.config.responseSchema))}async processParamsForMcpUsage(n){var t,e,o;const i=null===(t=n.config)||void 0===t?void 0:t.tools;if(!i)return n;const l=await Promise.all(i.map(async n=>{if(rt(n)){const t=n;return await t.tool()}return n})),s={model:n.model,contents:n.contents,config:Object.assign(Object.assign({},n.config),{tools:l})};if(s.config.tools=l,n.config&&n.config.tools&&et(n.config.tools)){const t=null!==(o=null===(e=n.config.httpOptions)||void 0===e?void 0:e.headers)&&void 0!==o?o:{};let i=Object.assign({},t);0===Object.keys(i).length&&(i=this.apiClient.getDefaultHeaders()),ot(i),s.config.httpOptions=Object.assign(Object.assign({},n.config.httpOptions),{headers:i})}return s}async initAfcToolsMap(n){var t,e,o;const i=new Map;for(const l of null!==(e=null===(t=n.config)||void 0===t?void 0:t.tools)&&void 0!==e?e:[])if(rt(l)){const n=l,t=await n.tool();for(const e of null!==(o=t.functionDeclarations)&&void 0!==o?o:[]){if(!e.name)throw new Error("Function declaration name is required.");if(i.has(e.name))throw new Error(`Duplicate tool declaration name: ${e.name}`);i.set(e.name,n)}}return i}async processAfcStream(n){var t,e,o;const i=null!==(o=null===(e=null===(t=n.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===e?void 0:e.maximumRemoteCalls)&&void 0!==o?o:10;let l=!1,s=0;return function(n,t,e){var o,r;return tn(this,arguments,function*(){for(var a,u,c,p,d,f,m;s<i;){l&&(s++,l=!1);const y=yield nn(n.processParamsForMcpUsage(e)),v=yield nn(n.generateContentStreamInternal(y)),C=[],T=[];try{for(d=!0,u=void 0,f=en(v);!(a=(m=yield nn(f.next())).done);d=!0){p=m.value,d=!1;const n=p;if(yield yield nn(n),n.candidates&&(null===(o=n.candidates[0])||void 0===o?void 0:o.content)){T.push(n.candidates[0].content);for(const e of null!==(r=n.candidates[0].content.parts)&&void 0!==r?r:[])if(s<i&&e.functionCall){if(!e.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(e.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`);{const n=yield nn(t.get(e.functionCall.name).callTool([e.functionCall]));C.push(...n)}}}}}catch(h){u={error:h}}finally{try{d||a||!(c=f.return)||(yield nn(c.call(f)))}finally{if(u)throw u.error}}if(!(C.length>0))break;{l=!0;const n=new to;n.candidates=[{content:{role:"user",parts:C}}],yield yield nn(n);const t=[];t.push(...T),t.push({role:"user",parts:C});const o=g(e.contents).concat(t);e.contents=o}}})}(this,await this.initAfcToolsMap(n),n)}async generateContentInternal(t){var e,o,i,l;let s,r="",a={};if(this.apiClient.isVertexAI()){const i=Fn(this.apiClient,t);return r=n("{model}:generateContent",i._url),a=i._query,delete i.config,delete i._url,delete i._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(e=t.config)||void 0===e?void 0:e.httpOptions,abortSignal:null===(o=t.config)||void 0===o?void 0:o.abortSignal}).then(n=>n.json()),s.then(n=>{const t=$n(n),e=new to;return Object.assign(e,t),e})}{const e=xn(this.apiClient,t);return r=n("{model}:generateContent",e._url),a=e._query,delete e.config,delete e._url,delete e._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(e),httpMethod:"POST",httpOptions:null===(i=t.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=t.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(n=>{const t=Bn(n),e=new to;return Object.assign(e,t),e})}}async generateContentStreamInternal(t){var e,o,i,l;let s,r="",a={};if(this.apiClient.isVertexAI()){const i=Fn(this.apiClient,t);return r=n("{model}:streamGenerateContent?alt=sse",i._url),a=i._query,delete i.config,delete i._url,delete i._query,s=this.apiClient.requestStream({path:r,queryParams:a,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(e=t.config)||void 0===e?void 0:e.httpOptions,abortSignal:null===(o=t.config)||void 0===o?void 0:o.abortSignal}),s.then(function(n){return tn(this,arguments,function*(){var t,e,o,i,l,s,r;try{for(l=!0,s=en(n);!(t=(r=yield nn(s.next())).done);l=!0){i=r.value,l=!1;const n=i,t=$n(yield nn(n.json())),e=new to;Object.assign(e,t),yield yield nn(e)}}catch(a){e={error:a}}finally{try{l||t||!(o=s.return)||(yield nn(o.call(s)))}finally{if(e)throw e.error}}})})}{const e=xn(this.apiClient,t);return r=n("{model}:streamGenerateContent?alt=sse",e._url),a=e._query,delete e.config,delete e._url,delete e._query,s=this.apiClient.requestStream({path:r,queryParams:a,body:JSON.stringify(e),httpMethod:"POST",httpOptions:null===(i=t.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=t.config)||void 0===l?void 0:l.abortSignal}),s.then(function(n){return tn(this,arguments,function*(){var t,e,o,i,l,s,r;try{for(l=!0,s=en(n);!(t=(r=yield nn(s.next())).done);l=!0){i=r.value,l=!1;const n=i,t=Bn(yield nn(n.json())),e=new to;Object.assign(e,t),yield yield nn(e)}}catch(a){e={error:a}}finally{try{l||t||!(o=s.return)||(yield nn(o.call(s)))}finally{if(e)throw e.error}}})})}}async embedContent(i){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["contents"]);null!=r&&t(l,["instances[]","content"],h(n,r));const a=e(i,["config"]);return null!=a&&t(l,["config"],function(n,o){const i=e(n,["taskType"]);void 0!==o&&null!=i&&t(o,["instances[]","task_type"],i);const l=e(n,["title"]);void 0!==o&&null!=l&&t(o,["instances[]","title"],l);const s=e(n,["outputDimensionality"]);void 0!==o&&null!=s&&t(o,["parameters","outputDimensionality"],s);const r=e(n,["mimeType"]);void 0!==o&&null!=r&&t(o,["instances[]","mimeType"],r);const a=e(n,["autoTruncate"]);return void 0!==o&&null!=a&&t(o,["parameters","autoTruncate"],a),{}}(a,l)),l}(this.apiClient,i);return c=n("{model}:predict",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(n=>{const t=zn(n),e=new eo;return Object.assign(e,t),e})}{const l=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["contents"]);null!=r&&t(l,["requests[]","content"],h(n,r));const a=e(i,["config"]);null!=a&&t(l,["config"],function(n,o){const i=e(n,["taskType"]);void 0!==o&&null!=i&&t(o,["requests[]","taskType"],i);const l=e(n,["title"]);void 0!==o&&null!=l&&t(o,["requests[]","title"],l);const s=e(n,["outputDimensionality"]);if(void 0!==o&&null!=s&&t(o,["requests[]","outputDimensionality"],s),void 0!==e(n,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==e(n,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(a,l));const u=e(i,["model"]);return void 0!==u&&t(l,["requests[]","model"],o(n,u)),l}(this.apiClient,i);return c=n("{model}:batchEmbedContents",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(r=i.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=i.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(n=>{const o=function(n){const o={},i=e(n,["embeddings"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["values"]);return null!=i&&t(o,["values"],i),o}(n))),t(o,["embeddings"],n)}return null!=e(n,["metadata"])&&t(o,["metadata"],{}),o}(n),i=new eo;return Object.assign(i,o),i})}}async generateImagesInternal(i){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["prompt"]);null!=r&&t(l,["instances[0]","prompt"],r);const a=e(i,["config"]);return null!=a&&t(l,["config"],function(n,o){const i=e(n,["outputGcsUri"]);void 0!==o&&null!=i&&t(o,["parameters","storageUri"],i);const l=e(n,["negativePrompt"]);void 0!==o&&null!=l&&t(o,["parameters","negativePrompt"],l);const s=e(n,["numberOfImages"]);void 0!==o&&null!=s&&t(o,["parameters","sampleCount"],s);const r=e(n,["aspectRatio"]);void 0!==o&&null!=r&&t(o,["parameters","aspectRatio"],r);const a=e(n,["guidanceScale"]);void 0!==o&&null!=a&&t(o,["parameters","guidanceScale"],a);const u=e(n,["seed"]);void 0!==o&&null!=u&&t(o,["parameters","seed"],u);const c=e(n,["safetyFilterLevel"]);void 0!==o&&null!=c&&t(o,["parameters","safetySetting"],c);const p=e(n,["personGeneration"]);void 0!==o&&null!=p&&t(o,["parameters","personGeneration"],p);const d=e(n,["includeSafetyAttributes"]);void 0!==o&&null!=d&&t(o,["parameters","includeSafetyAttributes"],d);const f=e(n,["includeRaiReason"]);void 0!==o&&null!=f&&t(o,["parameters","includeRaiReason"],f);const m=e(n,["language"]);void 0!==o&&null!=m&&t(o,["parameters","language"],m);const h=e(n,["outputMimeType"]);void 0!==o&&null!=h&&t(o,["parameters","outputOptions","mimeType"],h);const g=e(n,["outputCompressionQuality"]);void 0!==o&&null!=g&&t(o,["parameters","outputOptions","compressionQuality"],g);const y=e(n,["addWatermark"]);void 0!==o&&null!=y&&t(o,["parameters","addWatermark"],y);const v=e(n,["enhancePrompt"]);return void 0!==o&&null!=v&&t(o,["parameters","enhancePrompt"],v),{}}(a,l)),l}(this.apiClient,i);return c=n("{model}:predict",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(n=>{const o=function(n){const o={},i=e(n,["predictions"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>Zn(n))),t(o,["generatedImages"],n)}const l=e(n,["positivePromptSafetyAttributes"]);return null!=l&&t(o,["positivePromptSafetyAttributes"],Xn(l)),o}(n),i=new oo;return Object.assign(i,o),i})}{const l=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["prompt"]);null!=r&&t(l,["instances[0]","prompt"],r);const a=e(i,["config"]);return null!=a&&t(l,["config"],function(n,o){if(void 0!==e(n,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==e(n,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=e(n,["numberOfImages"]);void 0!==o&&null!=i&&t(o,["parameters","sampleCount"],i);const l=e(n,["aspectRatio"]);void 0!==o&&null!=l&&t(o,["parameters","aspectRatio"],l);const s=e(n,["guidanceScale"]);if(void 0!==o&&null!=s&&t(o,["parameters","guidanceScale"],s),void 0!==e(n,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const r=e(n,["safetyFilterLevel"]);void 0!==o&&null!=r&&t(o,["parameters","safetySetting"],r);const a=e(n,["personGeneration"]);void 0!==o&&null!=a&&t(o,["parameters","personGeneration"],a);const u=e(n,["includeSafetyAttributes"]);void 0!==o&&null!=u&&t(o,["parameters","includeSafetyAttributes"],u);const c=e(n,["includeRaiReason"]);void 0!==o&&null!=c&&t(o,["parameters","includeRaiReason"],c);const p=e(n,["language"]);void 0!==o&&null!=p&&t(o,["parameters","language"],p);const d=e(n,["outputMimeType"]);void 0!==o&&null!=d&&t(o,["parameters","outputOptions","mimeType"],d);const f=e(n,["outputCompressionQuality"]);if(void 0!==o&&null!=f&&t(o,["parameters","outputOptions","compressionQuality"],f),void 0!==e(n,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==e(n,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(a,l)),l}(this.apiClient,i);return c=n("{model}:predict",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(r=i.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=i.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(n=>{const o=function(n){const o={},i=e(n,["predictions"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>function(n){const o={},i=e(n,["_self"]);null!=i&&t(o,["image"],function(n){const o={},i=e(n,["bytesBase64Encoded"]);null!=i&&t(o,["imageBytes"],S(i));const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(i));const l=e(n,["raiFilteredReason"]);null!=l&&t(o,["raiFilteredReason"],l);const s=e(n,["_self"]);return null!=s&&t(o,["safetyAttributes"],Hn(s)),o}(n))),t(o,["generatedImages"],n)}const l=e(n,["positivePromptSafetyAttributes"]);return null!=l&&t(o,["positivePromptSafetyAttributes"],Hn(l)),o}(n),i=new oo;return Object.assign(i,o),i})}}async editImageInternal(o){var i,l;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=Vn(this.apiClient,o);return r=n("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(n=>{const o=function(n){const o={},i=e(n,["predictions"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>Zn(n))),t(o,["generatedImages"],n)}return o}(n),i=new io;return Object.assign(i,o),i})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(i){var l,s;let r,a="",u={};if(this.apiClient.isVertexAI()){const c=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["image"]);null!=r&&t(l,["instances[0]","image"],jn(r));const a=e(i,["upscaleFactor"]);null!=a&&t(l,["parameters","upscaleConfig","upscaleFactor"],a);const u=e(i,["config"]);return null!=u&&t(l,["config"],function(n,o){const i=e(n,["includeRaiReason"]);void 0!==o&&null!=i&&t(o,["parameters","includeRaiReason"],i);const l=e(n,["outputMimeType"]);void 0!==o&&null!=l&&t(o,["parameters","outputOptions","mimeType"],l);const s=e(n,["outputCompressionQuality"]);void 0!==o&&null!=s&&t(o,["parameters","outputOptions","compressionQuality"],s);const r=e(n,["enhanceInputImage"]);void 0!==o&&null!=r&&t(o,["parameters","upscaleConfig","enhanceInputImage"],r);const a=e(n,["imagePreservationFactor"]);void 0!==o&&null!=a&&t(o,["parameters","upscaleConfig","imagePreservationFactor"],a);const u=e(n,["numberOfImages"]);void 0!==o&&null!=u&&t(o,["parameters","sampleCount"],u);const c=e(n,["mode"]);return void 0!==o&&null!=c&&t(o,["parameters","mode"],c),{}}(u,l)),l}(this.apiClient,i);return a=n("{model}:predict",c._url),u=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),r.then(n=>{const o=function(n){const o={},i=e(n,["predictions"]);if(null!=i){let n=i;Array.isArray(n)&&(n=n.map(n=>Zn(n))),t(o,["generatedImages"],n)}return o}(n),i=new lo;return Object.assign(i,o),i})}throw new Error("This method is only supported by the Vertex AI.")}async get(i){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","name"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],r),l}(this.apiClient,i);return c=n("{name}",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(n=>Qn(n))}{const l=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","name"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],r),l}(this.apiClient,i);return c=n("{name}",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null===(r=i.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=i.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(n=>Yn(n))}}async listInternal(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n,o){const i={},l=e(o,["config"]);return null!=l&&t(i,["config"],function(n,o,i){const l=e(o,["pageSize"]);void 0!==i&&null!=l&&t(i,["_query","pageSize"],l);const s=e(o,["pageToken"]);void 0!==i&&null!=s&&t(i,["_query","pageToken"],s);const r=e(o,["filter"]);void 0!==i&&null!=r&&t(i,["_query","filter"],r);const a=e(o,["queryBase"]);return void 0!==i&&null!=a&&t(i,["_url","models_url"],b(n,a)),{}}(n,l,i)),i}(this.apiClient,o);return u=n("{models_url}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["_self"]);if(null!=l){let n=N(l);Array.isArray(n)&&(n=n.map(n=>Qn(n))),t(o,["models"],n)}return o}(n),i=new so;return Object.assign(i,o),i})}{const i=function(n,o){const i={},l=e(o,["config"]);return null!=l&&t(i,["config"],function(n,o,i){const l=e(o,["pageSize"]);void 0!==i&&null!=l&&t(i,["_query","pageSize"],l);const s=e(o,["pageToken"]);void 0!==i&&null!=s&&t(i,["_query","pageToken"],s);const r=e(o,["filter"]);void 0!==i&&null!=r&&t(i,["_query","filter"],r);const a=e(o,["queryBase"]);return void 0!==i&&null!=a&&t(i,["_url","models_url"],b(n,a)),{}}(n,l,i)),i}(this.apiClient,o);return u=n("{models_url}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["_self"]);if(null!=l){let n=N(l);Array.isArray(n)&&(n=n.map(n=>Yn(n))),t(o,["models"],n)}return o}(n),i=new so;return Object.assign(i,o),i})}}async update(i){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],function(n,o){const i=e(n,["displayName"]);void 0!==o&&null!=i&&t(o,["displayName"],i);const l=e(n,["description"]);void 0!==o&&null!=l&&t(o,["description"],l);const s=e(n,["defaultCheckpointId"]);return void 0!==o&&null!=s&&t(o,["defaultCheckpointId"],s),{}}(r,l)),l}(this.apiClient,i);return c=n("{model}",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"PATCH",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(n=>Qn(n))}{const l=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","name"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],function(n,o){const i=e(n,["displayName"]);void 0!==o&&null!=i&&t(o,["displayName"],i);const l=e(n,["description"]);void 0!==o&&null!=l&&t(o,["description"],l);const s=e(n,["defaultCheckpointId"]);return void 0!==o&&null!=s&&t(o,["defaultCheckpointId"],s),{}}(r,l)),l}(this.apiClient,i);return c=n("{name}",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:null===(r=i.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=i.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(n=>Yn(n))}}async delete(i){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","name"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],r),l}(this.apiClient,i);return c=n("{name}",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(()=>{const n=new ro;return Object.assign(n,{}),n})}{const l=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","name"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],r),l}(this.apiClient,i);return c=n("{name}",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null===(r=i.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=i.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(()=>{const n=new ro;return Object.assign(n,{}),n})}}async countTokens(i){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["contents"]);if(null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>Ln(n))),t(l,["contents"],n)}const a=e(i,["config"]);return null!=a&&t(l,["config"],function(n,o){const i=e(n,["systemInstruction"]);void 0!==o&&null!=i&&t(o,["systemInstruction"],Ln(m(i)));const l=e(n,["tools"]);if(void 0!==o&&null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>qn(n))),t(o,["tools"],n)}const s=e(n,["generationConfig"]);return void 0!==o&&null!=s&&t(o,["generationConfig"],s),{}}(a,l)),l}(this.apiClient,i);return c=n("{model}:countTokens",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(n=>{const o=function(n){const o={},i=e(n,["totalTokens"]);return null!=i&&t(o,["totalTokens"],i),o}(n),i=new ao;return Object.assign(i,o),i})}{const l=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["contents"]);if(null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>wn(n))),t(l,["contents"],n)}const a=e(i,["config"]);return null!=a&&t(l,["config"],function(n){if(void 0!==e(n,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==e(n,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==e(n,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.");return{}}(a)),l}(this.apiClient,i);return c=n("{model}:countTokens",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(r=i.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=i.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(n=>{const o=function(n){const o={},i=e(n,["totalTokens"]);null!=i&&t(o,["totalTokens"],i);const l=e(n,["cachedContentTokenCount"]);return null!=l&&t(o,["cachedContentTokenCount"],l),o}(n),i=new ao;return Object.assign(i,o),i})}}async computeTokens(i){var l,s;let r,a="",u={};if(this.apiClient.isVertexAI()){const c=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["contents"]);if(null!=r){let n=g(r);Array.isArray(n)&&(n=n.map(n=>Ln(n))),t(l,["contents"],n)}const a=e(i,["config"]);return null!=a&&t(l,["config"],a),l}(this.apiClient,i);return a=n("{model}:computeTokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),r.then(n=>{const o=function(n){const o={},i=e(n,["tokensInfo"]);return null!=i&&t(o,["tokensInfo"],i),o}(n),i=new uo;return Object.assign(i,o),i})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(i){var l,s,r,a;let u,c="",p={};if(this.apiClient.isVertexAI()){const r=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["prompt"]);null!=r&&t(l,["instances[0]","prompt"],r);const a=e(i,["image"]);null!=a&&t(l,["instances[0]","image"],jn(a));const u=e(i,["video"]);null!=u&&t(l,["instances[0]","video"],function(n){const o={},i=e(n,["uri"]);null!=i&&t(o,["gcsUri"],i);const l=e(n,["videoBytes"]);null!=l&&t(o,["bytesBase64Encoded"],S(l));const s=e(n,["mimeType"]);return null!=s&&t(o,["mimeType"],s),o}(u));const c=e(i,["config"]);return null!=c&&t(l,["config"],function(n,o){const i=e(n,["numberOfVideos"]);void 0!==o&&null!=i&&t(o,["parameters","sampleCount"],i);const l=e(n,["outputGcsUri"]);void 0!==o&&null!=l&&t(o,["parameters","storageUri"],l);const s=e(n,["fps"]);void 0!==o&&null!=s&&t(o,["parameters","fps"],s);const r=e(n,["durationSeconds"]);void 0!==o&&null!=r&&t(o,["parameters","durationSeconds"],r);const a=e(n,["seed"]);void 0!==o&&null!=a&&t(o,["parameters","seed"],a);const u=e(n,["aspectRatio"]);void 0!==o&&null!=u&&t(o,["parameters","aspectRatio"],u);const c=e(n,["resolution"]);void 0!==o&&null!=c&&t(o,["parameters","resolution"],c);const p=e(n,["personGeneration"]);void 0!==o&&null!=p&&t(o,["parameters","personGeneration"],p);const d=e(n,["pubsubTopic"]);void 0!==o&&null!=d&&t(o,["parameters","pubsubTopic"],d);const f=e(n,["negativePrompt"]);void 0!==o&&null!=f&&t(o,["parameters","negativePrompt"],f);const m=e(n,["enhancePrompt"]);void 0!==o&&null!=m&&t(o,["parameters","enhancePrompt"],m);const h=e(n,["generateAudio"]);void 0!==o&&null!=h&&t(o,["parameters","generateAudio"],h);const g=e(n,["lastFrame"]);void 0!==o&&null!=g&&t(o,["instances[0]","lastFrame"],jn(g));const y=e(n,["compressionQuality"]);return void 0!==o&&null!=y&&t(o,["parameters","compressionQuality"],y),{}}(c,l)),l}(this.apiClient,i);return c=n("{model}:predictLongRunning",r._url),p=r._query,delete r.config,delete r._url,delete r._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),u.then(n=>nt(n))}{const l=function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["_url","model"],o(n,s));const r=e(i,["prompt"]);null!=r&&t(l,["instances[0]","prompt"],r);const a=e(i,["image"]);if(null!=a&&t(l,["instances[0]","image"],function(n){const o={};if(void 0!==e(n,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const i=e(n,["imageBytes"]);null!=i&&t(o,["bytesBase64Encoded"],S(i));const l=e(n,["mimeType"]);return null!=l&&t(o,["mimeType"],l),o}(a)),void 0!==e(i,["video"]))throw new Error("video parameter is not supported in Gemini API.");const u=e(i,["config"]);return null!=u&&t(l,["config"],function(n,o){const i=e(n,["numberOfVideos"]);if(void 0!==o&&null!=i&&t(o,["parameters","sampleCount"],i),void 0!==e(n,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==e(n,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const l=e(n,["durationSeconds"]);if(void 0!==o&&null!=l&&t(o,["parameters","durationSeconds"],l),void 0!==e(n,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const s=e(n,["aspectRatio"]);if(void 0!==o&&null!=s&&t(o,["parameters","aspectRatio"],s),void 0!==e(n,["resolution"]))throw new Error("resolution parameter is not supported in Gemini API.");const r=e(n,["personGeneration"]);if(void 0!==o&&null!=r&&t(o,["parameters","personGeneration"],r),void 0!==e(n,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const a=e(n,["negativePrompt"]);void 0!==o&&null!=a&&t(o,["parameters","negativePrompt"],a);const u=e(n,["enhancePrompt"]);if(void 0!==o&&null!=u&&t(o,["parameters","enhancePrompt"],u),void 0!==e(n,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");if(void 0!==e(n,["lastFrame"]))throw new Error("lastFrame parameter is not supported in Gemini API.");if(void 0!==e(n,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}(u,l)),l}(this.apiClient,i);return c=n("{model}:predictLongRunning",l._url),p=l._query,delete l.config,delete l._url,delete l._query,u=this.apiClient.request({path:c,queryParams:p,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(r=i.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(a=i.config)||void 0===a?void 0:a.abortSignal}).then(n=>n.json()),u.then(n=>Kn(n))}}}class qo extends Qe{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,e=n.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const n=t.name.split("/operations/")[0];let o;return e&&"httpOptions"in e&&(o=e.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:n,config:{httpOptions:o}})}return this.getVideosOperationInternal({operationName:t.name,config:e})}async getVideosOperationInternal(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n){const o={},i=e(n,["operationName"]);null!=i&&t(o,["_url","operationName"],i);const l=e(n,["config"]);return null!=l&&t(o,["config"],l),o}(o);return u=n("{operationName}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>ct(n))}{const i=function(n){const o={},i=e(n,["operationName"]);null!=i&&t(o,["_url","operationName"],i);const l=e(n,["config"]);return null!=l&&t(o,["config"],l),o}(o);return u=n("{operationName}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>ut(n))}}async fetchPredictVideosOperationInternal(o){var i,l;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=function(n){const o={},i=e(n,["operationName"]);null!=i&&t(o,["operationName"],i);const l=e(n,["resourceName"]);null!=l&&t(o,["_url","resourceName"],l);const s=e(n,["config"]);return null!=s&&t(o,["config"],s),o}(o);return r=n("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(n=>ct(n))}throw new Error("This method is only supported by the Vertex AI.")}}class ko extends Qe{constructor(n){super(),this.apiClient=n}async create(i){var l,s;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=function(n,i){const l={},s=e(i,["config"]);return null!=s&&t(l,["config"],function(n,i,l){const s=e(i,["expireTime"]);void 0!==l&&null!=s&&t(l,["expireTime"],s);const r=e(i,["newSessionExpireTime"]);void 0!==l&&null!=r&&t(l,["newSessionExpireTime"],r);const a=e(i,["uses"]);void 0!==l&&null!=a&&t(l,["uses"],a);const u=e(i,["liveConnectConstraints"]);void 0!==l&&null!=u&&t(l,["bidiGenerateContentSetup"],function(n,i){const l={},s=e(i,["model"]);null!=s&&t(l,["setup","model"],o(n,s));const r=e(i,["config"]);return null!=r&&t(l,["config"],ft(r,l)),l}(n,u));const c=e(i,["lockAdditionalFields"]);return void 0!==l&&null!=c&&t(l,["fieldMask"],c),{}}(n,s,l)),l}(this.apiClient,i);a=n("auth_tokens",c._url),u=c._query,delete c.config,delete c._url,delete c._query;const p=function(n,t){let e=null;const o=n.bidiGenerateContentSetup;if("object"==typeof o&&null!==o&&"setup"in o){const t=o.setup;"object"==typeof t&&null!==t?(n.bidiGenerateContentSetup=t,e=t):delete n.bidiGenerateContentSetup}else void 0!==o&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(e){const o=function(n){const t=[];for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const o=n[e];if("object"==typeof o&&null!=o&&Object.keys(o).length>0){const n=Object.keys(o).map(n=>`${e}.${n}`);t.push(...n)}else t.push(e)}return t.join(",")}(e);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&0===(null==t?void 0:t.lockAdditionalFields.length))o?n.fieldMask=o:delete n.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let e=[];i.length>0&&(e=i.map(n=>t.includes(n)?`generationConfig.${n}`:n));const l=[];o&&l.push(o),e.length>0&&l.push(...e),l.length>0?n.fieldMask=l.join(","):delete n.fieldMask}else delete n.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}(c,i.config);return r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null===(l=i.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(s=i.config)||void 0===s?void 0:s.abortSignal}).then(n=>n.json()),r.then(n=>function(n){const o={},i=e(n,["name"]);return null!=i&&t(o,["name"],i),o}(n))}}}class Go extends Qe{constructor(n){super(),this.apiClient=n,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new To(re.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const t=await this.tuneMldevInternal(n);let e="";return void 0!==t.metadata&&void 0!==t.metadata.tunedModel?e=t.metadata.tunedModel:void 0!==t.name&&t.name.includes("/operations/")&&(e=t.name.split("/operations/")[0]),{name:e,state:qt.JOB_STATE_QUEUED}}}}async getInternal(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["_url","name"],i);const l=e(n,["config"]);return null!=l&&t(o,["config"],l),o}(o);return u=n("{name}",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>yt(n))}{const i=function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["_url","name"],i);const l=e(n,["config"]);return null!=l&&t(o,["config"],l),o}(o);return u=n("{name}",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>gt(n))}}async listInternal(o){var i,l,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const s=function(n){const o={},i=e(n,["config"]);return null!=i&&t(o,["config"],function(n,o){const i=e(n,["pageSize"]);void 0!==o&&null!=i&&t(o,["_query","pageSize"],i);const l=e(n,["pageToken"]);void 0!==o&&null!=l&&t(o,["_query","pageToken"],l);const s=e(n,["filter"]);return void 0!==o&&null!=s&&t(o,["_query","filter"],s),{}}(i,o)),o}(o);return u=n("tuningJobs",s._url),c=s._query,delete s.config,delete s._url,delete s._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["tuningJobs"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>yt(n))),t(o,["tuningJobs"],n)}return o}(n),i=new co;return Object.assign(i,o),i})}{const i=function(n){const o={},i=e(n,["config"]);return null!=i&&t(o,["config"],function(n,o){const i=e(n,["pageSize"]);void 0!==o&&null!=i&&t(o,["_query","pageSize"],i);const l=e(n,["pageToken"]);void 0!==o&&null!=l&&t(o,["_query","pageToken"],l);const s=e(n,["filter"]);return void 0!==o&&null!=s&&t(o,["_query","filter"],s),{}}(i,o)),o}(o);return u=n("tunedModels",i._url),c=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(s=o.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(r=o.config)||void 0===r?void 0:r.abortSignal}).then(n=>n.json()),a.then(n=>{const o=function(n){const o={},i=e(n,["nextPageToken"]);null!=i&&t(o,["nextPageToken"],i);const l=e(n,["tunedModels"]);if(null!=l){let n=l;Array.isArray(n)&&(n=n.map(n=>gt(n))),t(o,["tuningJobs"],n)}return o}(n),i=new co;return Object.assign(i,o),i})}}async tuneInternal(t){var e,o;let i,l="",s={};if(this.apiClient.isVertexAI()){const r=ht(t);return l=n("tuningJobs",r._url),s=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:l,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(e=t.config)||void 0===e?void 0:e.httpOptions,abortSignal:null===(o=t.config)||void 0===o?void 0:o.abortSignal}).then(n=>n.json()),i.then(n=>yt(n))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(o){var i,l;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=mt(o);return r=n("tunedModels",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(i=o.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(l=o.config)||void 0===l?void 0:l.abortSignal}).then(n=>n.json()),s.then(n=>function(n){const o={},i=e(n,["name"]);null!=i&&t(o,["name"],i);const l=e(n,["metadata"]);null!=l&&t(o,["metadata"],l);const s=e(n,["done"]);null!=s&&t(o,["done"],s);const r=e(n,["error"]);return null!=r&&t(o,["error"],r),o}(n))}}}class Fo{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const jo="x-goog-upload-status";class Vo{async upload(n,t,e){if("string"==typeof n)throw new Error("File path is not supported in browser uploader.");return await async function(n,t,e){var o,i,l;let s=0,r=0,a=new no(new Response),u="upload";for(s=n.size;r<s;){const l=Math.min(8388608,s-r),c=n.slice(r,r+l);r+l>=s&&(u+=", finalize");let p=0,d=1e3;for(;p<3&&(a=await e.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(r),"Content-Length":String(l)}}}),!(null===(o=null==a?void 0:a.headers)||void 0===o?void 0:o[jo]));)p++,await vt(d),d*=2;if(r+=l,"active"!==(null===(i=null==a?void 0:a.headers)||void 0===i?void 0:i[jo]))break;if(s<=r)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const c=await(null==a?void 0:a.json());if("final"!==(null===(l=null==a?void 0:a.headers)||void 0===l?void 0:l[jo]))throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}(n,t,e)}async stat(n){if("string"==typeof n)throw new Error("File path is not supported in browser uploader.");return await async function(n){return{size:n.size,type:n.type}}(n)}}class Jo{create(n,t,e){return new Bo(n,t,e)}}class Bo{constructor(n,t,e){this.url=n,this.headers=t,this.callbacks=e}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const Ho="x-goog-api-key";class Yo{constructor(n){this.apiKey=n}async addAuthHeaders(n){if(null===n.get(Ho)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");n.append(Ho,this.apiKey)}}}class Ko{constructor(n){var t;if(null==n.apiKey)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=n.vertexai)&&void 0!==t&&t,this.apiKey=n.apiKey;const e=function(n,t,e){var o,i,l;if(!(null===(o=n.httpOptions)||void 0===o?void 0:o.baseUrl)){const o={geminiUrl:Xe,vertexUrl:Ze};return n.vertexai?null!==(i=o.vertexUrl)&&void 0!==i?i:t:null!==(l=o.geminiUrl)&&void 0!==l?l:e}return n.httpOptions.baseUrl}(n,void 0,void 0);e&&(n.httpOptions?n.httpOptions.baseUrl=e:n.httpOptions={baseUrl:e}),this.apiVersion=n.apiVersion;const o=new Yo(this.apiKey);this.apiClient=new Po({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:"gl-node/web",uploader:new Vo,downloader:new Fo}),this.models=new Lo(this.apiClient),this.live=new Do(this.apiClient,o,new Jo),this.batches=new Eo(this.apiClient),this.chats=new _o(this.models,this.apiClient),this.caches=new Ao(this.apiClient),this.files=new Io(this.apiClient),this.operations=new qo(this.apiClient),this.authTokens=new ko(this.apiClient),this.tunings=new Go(this.apiClient)}}export{Ko as G,Ot as H,At as a};
