function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t,n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r={exports:{}};const i=e((t||(t=1,r.exports=function(){function e(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function t(e,t){return"object"!=typeof t||ur(t).forEach(function(n){e[n]=t[n]}),e}function r(e,t){return Et.call(e,t)}function i(e,t){"function"==typeof t&&(t=t(Kt(e))),("undefined"==typeof Reflect?ur:Reflect.ownKeys)(t).forEach(function(n){o(e,n,t[n])})}function o(e,n,i,o){St(e,n,t(i&&r(i,"get")&&"function"==typeof i.get?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},o))}function u(e){return{from:function(t){return e.prototype=Object.create(t.prototype),o(e.prototype,"constructor",e),{extend:i.bind(null,e.prototype)}}}}function a(e,t,n){return At.call(e,t,n)}function s(e,t){return t(e)}function c(e){if(!e)throw new Error("Assertion Failed")}function l(e){or.setImmediate?setImmediate(e):setTimeout(e,0)}function f(e,t){var n,i,o,u,a,s;if("string"==typeof t&&r(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(n=[],i=0,o=t.length;i<o;++i)u=f(e,t[i]),n.push(u);return n}return-1!==(a=t.indexOf("."))?null==(s=e[t.substr(0,a)])?void 0:f(s,t.substr(a+1)):void 0}function h(e,t,n){var i,o,u,a,s;if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){c("string"!=typeof n&&"length"in n);for(i=0,o=t.length;i<o;++i)h(e,t[i],n[i])}else-1!==(s=t.indexOf("."))?(u=t.substr(0,s),""===(a=t.substr(s+1))?void 0===n?ar(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n:h(s=(s=e[u])&&r(e,u)?s:e[u]={},a,n)):void 0===n?ar(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}function d(e){var t,n={};for(t in e)r(e,t)&&(n[t]=e[t]);return n}function p(e){return Ct.apply([],e)}function y(e){return It=new WeakMap,e=function e(t){var n,i,o,u,a;if(!t||"object"!=typeof t)return t;if(n=It.get(t))return n;if(ar(t))for(n=[],It.set(t,n),i=0,o=t.length;i<o;++i)n.push(e(t[i]));else if(qt.has(t.constructor))n=t;else for(u in n=(a=Kt(t))===Object.prototype?{}:Object.create(a),It.set(t,n),t)r(t,u)&&(n[u]=e(t[u]));return n}(e),It=null,e}function m(e){return Bt.call(e).slice(8,-1)}function v(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}function b(e){var t,n,r,i;if(1===arguments.length){if(ar(e))return e.slice();if(this===Mt&&"string"==typeof e)return[e];if(i=Dt(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}function g(e,t){this.name=e,this.message=t}function w(e,t){return e+". Errors: "+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}function _(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=w(e,t)}function x(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(e){return t[e]}),this.failuresByPos=t,this.message=w(e,this.failures)}function k(){}function O(e){return e}function P(e,t){return null==e||e===O?t:function(n){return t(e(n))}}function K(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function E(e,t){return e===k?t:function(){var n,r,i,o=e.apply(this,arguments);return void 0!==o&&(arguments[0]=o),n=this.onsuccess,r=this.onerror,this.onsuccess=null,this.onerror=null,i=t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?K(n,this.onsuccess):n),r&&(this.onerror=this.onerror?K(r,this.onerror):r),void 0!==i?i:o}}function S(e,t){return e===k?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?K(n,this.onsuccess):n),r&&(this.onerror=this.onerror?K(r,this.onerror):r)}}function j(e,n){return e===k?n:function(r){var i,o,u=e.apply(this,arguments);return t(r,u),i=this.onsuccess,o=this.onerror,this.onsuccess=null,this.onerror=null,r=n.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?K(i,this.onsuccess):i),o&&(this.onerror=this.onerror?K(o,this.onerror):o),void 0===u?void 0===r?void 0:r:t(u,r)}}function A(e,t){return e===k?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function C(e,t){return e===k?t:function(){var n,r,i,o=e.apply(this,arguments);if(o&&"function"==typeof o.then){for(n=this,r=arguments.length,i=new Array(r);r--;)i[r]=arguments[r];return o.then(function(){return t.apply(n,i)})}return t.apply(this,arguments)}}function T(e){Qt=e}function q(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=an;if("function"!=typeof e){if(e!==Gt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&B(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,n){try{n(function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&N();n&&"function"==typeof n.then?e(t,function(e,t){n instanceof q?n._then(e,t):n.then(e,t)}):(t._state=!0,t._value=n,R(t)),r&&L()}},B.bind(null,t))}catch(r){B(t,r)}}(this,e)}function I(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function B(e,t){var n,r;rn.push(t),null===e._state&&(n=e._lib&&N(),t=on(t),e._state=!1,e._value=t,r=e,nn.some(function(e){return e._value===r._value})||nn.push(r),R(e),n&&L())}function R(e){var t,n,r,i=e._listeners;for(e._listeners=[],t=0,n=i.length;t<n;++t)D(e,i[t]);--(r=e._PSD).ref||r.finalize(),0===cn&&(++cn,Zt(function(){0==--cn&&U()},[]))}function D(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++cn,Zt(M,[n,e,t])}else e._listeners.push(t)}function M(e,t,n){try{var r,i=t._value;!t._state&&rn.length&&(rn=[]),r=Qt&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||-1!==rn.indexOf(i)||function(e){for(var t=nn.length;t;)if(nn[--t]._value===e._value)return nn.splice(t,1)}(t),n.resolve(r)}catch(o){n.reject(o)}finally{0==--cn&&U(),--n.psd.ref||n.psd.finalize()}}function F(){J(un,function(){N()&&L()})}function N(){var e=en;return tn=en=!1,e}function L(){var e,t,n,r;do{for(;0<sn.length;)for(e=sn,sn=[],n=e.length,t=0;t<n;++t)(r=e[t])[0].apply(null,r[1])}while(0<sn.length);tn=en=!0}function U(){var e,t,n=nn;for(nn=[],n.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)}),t=(e=ln.slice(0)).length;t;)e[--t]()}function V(e){return new q(Gt,!1,e)}function z(e,t){var n=an;return function(){var r=N(),i=an;try{return X(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{X(i,!1),r&&L()}}}function Y(e,n,r,i){var o=an,u=Object.create(o);return u.parent=o,u.ref=0,u.global=!1,u.id=++vn,un.env,u.env=Jt?{Promise:q,PromiseProp:{value:q,configurable:!0,writable:!0},all:q.all,race:q.race,allSettled:q.allSettled,any:q.any,resolve:q.resolve,reject:q.reject}:{},n&&t(u,n),++o.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()},i=J(u,e,r,i),0===u.ref&&u.finalize(),i}function W(){return hn.id||(hn.id=++dn),++hn.awaits,hn.echoes+=Xt,hn.id}function $(){return!!hn.awaits&&(0==--hn.awaits&&(hn.id=0),hn.echoes=hn.awaits*Xt,!0)}function Q(e){return hn.echoes&&e&&e.constructor===Ht?(W(),e.then(function(e){return $(),e},function(e){return $(),bn(e)})):e}function G(){var e=pn[pn.length-1];pn.pop(),X(e,!1)}function X(e,t){var n,r=an;(t?!hn.echoes||yn++&&e===an:!yn||--yn&&e===an)||queueMicrotask(t?function(e){++mn,hn.echoes&&0!=--hn.echoes||(hn.echoes=hn.awaits=hn.id=0),pn.push(an),X(e,!0)}.bind(null,e):G),e!==an&&(an=e,r===un&&(un.env=H()),Jt&&(n=un.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(or,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function H(){var e=or.Promise;return Jt?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(or,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function J(e,t,n,r,i){var o=an;try{return X(e,!0),t(n,r,i)}finally{X(o,!1)}}function Z(e,t,n,r){return"function"!=typeof e?e:function(){var i=an;n&&W(),X(t,!0);try{return e.apply(this,arguments)}finally{X(i,!1),r&&queueMicrotask($)}}}function ee(e){Promise===Ht&&0===hn.echoes?0===yn?e():enqueueNativeMicroTask(e):setTimeout(e,0)}function te(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function ne(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=y(t))[e],t}}function re(){throw Yt.Type()}function ie(e,t){try{var n=oe(e),r=oe(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}(ue(e),ue(t));case"Array":return function(e,t){var n,r,i,o,u;for(i=(n=e.length)<(r=t.length)?n:r,o=0;o<i;++o)if(0!==(u=ie(e[o],t[o])))return u;return n===r?0:n<r?-1:1}(e,t)}}catch(i){}return NaN}function oe(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=m(e))?"binary":e}function ue(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function ae(){}function se(e){function t(t,n){if(n){for(var r=arguments.length,i=new Array(r-1);--r;)i[r-1]=arguments[r];return o[t].subscribe.apply(null,i),e}if("string"==typeof t)return o[t]}function n(e,r,i){var u,a;if("object"!=typeof e)return r=r||A,a={subscribers:[],fire:i=i||k,subscribe:function(e){-1===a.subscribers.indexOf(e)&&(a.subscribers.push(e),a.fire=r(a.fire,e))},unsubscribe:function(e){a.subscribers=a.subscribers.filter(function(t){return t!==e}),a.fire=a.subscribers.reduce(r,i)}},o[e]=t[e]=a;ur(u=e).forEach(function(e){var t,r=u[e];if(ar(r))n(e,u[e][0],u[e][1]);else{if("asap"!==r)throw new Yt.InvalidArgument("Invalid event config");t=n(e,O,function(){for(var e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];t.subscribers.forEach(function(e){l(function(){e.apply(null,n)})})})}})}var r,i,o={};for(t.addEventType=n,r=1,i=arguments.length;r<i;++r)n(arguments[r]);return t}function ce(e,t){return u(t).from({prototype:e}),t}function le(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function fe(e,t){e.filter=te(e.filter,t)}function he(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return te(r(),t())}:t,e.justLimit=n&&!r}function de(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Yt.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function pe(e,t,n){var r=de(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function ye(e,t,n,i){var o,u,a=e.replayFilter?te(e.filter,e.replayFilter()):e.filter;return e.or?(o={},u=function(e,n,i){var u,s;a&&!a(n,i,function(e){return n.stop(e)},function(e){return n.fail(e)})||("[object ArrayBuffer]"==(s=""+(u=n.primaryKey))&&(s=""+new Uint8Array(u)),r(o,s)||(o[s]=!0,t(e,n,i)))},Promise.all([e.or._iterate(u,n),me(pe(e,i,n),e.algorithm,u,!e.keysOnly&&e.valueMapper)])):me(pe(e,i,n),te(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function me(e,t,n,r){var i=z(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then(function(e){if(e)return e.start(function(){var n=function(){return e.continue()};t&&!t(e,function(e){return n=e},function(t){e.stop(t),n=k},function(t){e.fail(t),n=k})||i(e.value,e,function(e){return n=e}),n()})})}function ve(e){this["@@propmod"]=e}function be(){}function ge(e,t){return e<t?-1:e===t?0:1}function we(e,t){return t<e?-1:e===t?0:1}function _e(e,t,n){return(e=e instanceof Cn?new e.Collection(e):e)._ctx.error=new(n||TypeError)(t),e}function xe(e){return new e.Collection(e,function(){return Pe("")}).limit(0)}function ke(e,t,n,r){function i(e){o="next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},u="next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},a="next"===e?ge:we;var t=n.map(function(e){return{lower:u(e),upper:o(e)}}).sort(function(e,t){return a(e.lower,t.lower)});s=t.map(function(e){return e.upper}),c=t.map(function(e){return e.lower}),f="next"===(l=e)?"":r}var o,u,a,s,c,l,f,h,d=n.length;return n.every(function(e){return"string"==typeof e})?(i("next"),(e=new e.Collection(e,function(){return Oe(s[0],c[d-1]+r)}))._ondirectionchange=function(e){i(e)},h=0,e._addAlgorithm(function(e,n,r){var i,o,p,y,m=e.key;if("string"!=typeof m)return!1;if(i=u(m),t(i,c,h))return!0;for(o=null,p=h;p<d;++p)null===(y=function(e,t,n,r,i,o){var u,a,s,c;for(u=Math.min(e.length,r.length),a=-1,s=0;s<u;++s){if((c=t[s])!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):0<=a?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[s],c)<0&&(a=s)}return u<r.length&&"next"===o?e+n.substr(e.length):u<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}(m,i,s[p],c[p],a,l))&&null===o?h=p+1:(null===o||0<a(o,y))&&(o=y);return n(null!==o?function(){e.continue(o+f)}:r),!1}),e):_e(e,_n)}function Oe(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Pe(e){return{type:1,lower:e,upper:e}}function Ke(){}function Ee(e){return z(function(t){return Se(t),e(t.target.error),!1})}function Se(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function je(){}function Ae(e,t,n,r,i,o,u){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+Ce(t)}}function Ce(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Te(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(e){return[e.name,e]},n.reduce(function(e,t,n){return(n=r(t))&&(e[n[0]]=n[1]),e},{}))};var r}function qe(e){return null==e?function(){}:"string"==typeof e?1===(t=e).split(".").length?function(e){return e[t]}:function(e){return f(e,t)}:function(t){return f(t,e)};var t}function Ie(e){return[].slice.call(e)}function Be(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Re(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen;return e=e.upperOpen,void 0===n?void 0===r?null:t.upperBound(r,!!e):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!e)}n=(o=n,u=Ie((i=e).objectStoreNames),s={schema:{name:i.name,tables:u.map(function(e){return o.objectStore(e)}).map(function(e){var t=e.keyPath,n=e.autoIncrement,r=ar(t),i={};return n={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:qe(t)},indexes:Ie(e.indexNames).map(function(t){return e.index(t)}).map(function(e){var t=e.name,n=e.unique,r=e.multiEntry;return e=e.keyPath,r={name:t,compound:ar(e),keyPath:e,unique:n,multiEntry:r,extractKey:qe(e)},i[Be(e)]=r}),getIndexByKeyPath:function(e){return i[Be(e)]}},i[":id"]=n.primaryKey,null!=t&&(i[Be(t)]=n.primaryKey),n})},hasGetAll:0<u.length&&"getAll"in o.objectStore(u[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}).schema;var i,o,u,a=s.hasGetAll,s=n.tables.map(function(e){var t,n=e.name;return{name:n,schema:e,mutate:function(e){var t=e.trans,i=e.type,o=e.keys,u=e.values,a=e.range;return new Promise(function(e,s){function c(e){++b,Se(e)}function l(t){t=t.target.result,m.forEach(function(e,t){return null!=e.error&&(v[t]=e.error)}),e({numFailures:b,failures:v,results:"delete"===i?o:m.map(function(e){return e.result}),lastResult:t})}var f,h,d,p,y,m,v,b,g,w,_;if(e=z(e),h=null==(f=t.objectStore(n)).keyPath,!(d="put"===i||"add"===i)&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);if(y=(o||u||{length:1}).length,o&&u&&o.length!==u.length)throw new Error("Given keys array must have same length as given values array.");if(0===y)return e({numFailures:0,failures:{},results:[],lastResult:void 0});if(m=[],v=[],b=0,"deleteRange"===i){if(4===a.type)return e({numFailures:b,failures:v,results:[],lastResult:void 0});3===a.type?m.push(p=f.clear()):m.push(p=f.delete(r(a)))}else if(g=(h=d?h?[u,o]:[u,null]:[o,null])[0],w=h[1],d)for(_=0;_<y;++_)m.push(p=w&&void 0!==w[_]?f[i](g[_],w[_]):f[i](g[_])),p.onerror=c;else for(_=0;_<y;++_)m.push(p=f[i](g[_])),p.onerror=c;p.onerror=function(e){c(e),l(e)},p.onsuccess=l})},getMany:function(e){var t=e.trans,r=e.keys;return new Promise(function(e,i){e=z(e);for(var o,u=t.objectStore(n),a=r.length,s=new Array(a),c=0,l=0,f=function(t){t=t.target,s[t._pos]=t.result,++l===c&&e(s)},h=Ee(i),d=0;d<a;++d)null!=r[d]&&((o=u.get(r[d]))._pos=d,o.onsuccess=f,o.onerror=h,++c);0===c&&e(s)})},get:function(e){var t=e.trans,r=e.key;return new Promise(function(e,i){e=z(e);var o=t.objectStore(n).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=Ee(i)})},query:(t=a,function(e){return new Promise(function(i,o){i=z(i);var u,a,s,c=e.trans,l=e.values,f=e.limit,h=e.query,d=f===1/0?void 0:f,p=h.index;if(h=h.range,c=c.objectStore(n),p=p.isPrimaryKey?c:c.index(p.name),h=r(h),0===f)return i({result:[]});t?((d=l?p.getAll(h,d):p.getAllKeys(h,d)).onsuccess=function(e){return i({result:e.target.result})},d.onerror=Ee(o)):(u=0,a=!l&&"openKeyCursor"in p?p.openKeyCursor(h):p.openCursor(h),s=[],a.onsuccess=function(e){var t=a.result;return t?(s.push(l?t.value:t.primaryKey),++u===f?i({result:s}):void t.continue()):i({result:s})},a.onerror=Ee(o))})}),openCursor:function(e){var t=e.trans,i=e.values,o=e.query,u=e.reverse,a=e.unique;return new Promise(function(e,s){e=z(e);var c=o.index,l=o.range,f=t.objectStore(n),h=(f=c.isPrimaryKey?f:f.index(c.name),c=u?a?"prevunique":"prev":a?"nextunique":"next",!i&&"openKeyCursor"in f?f.openKeyCursor(r(l),c):f.openCursor(r(l),c));h.onerror=Ee(s),h.onsuccess=z(function(n){var r,i,o,u,a=h.result;a?(a.___id=++Dn,a.done=!1,r=a.continue.bind(a),i=(i=a.continuePrimaryKey)&&i.bind(a),o=a.advance.bind(a),u=function(){throw new Error("Cursor not stopped")},a.trans=t,a.stop=a.continue=a.continuePrimaryKey=a.advance=function(){throw new Error("Cursor not started")},a.fail=z(s),a.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},a.start=function(e){function t(){if(h.result)try{e()}catch(t){a.fail(t)}else a.done=!0,a.start=function(){throw new Error("Cursor behind last entry")},a.stop()}var n=new Promise(function(e,t){e=z(e),h.onerror=Ee(t),a.fail=t,a.stop=function(t){a.stop=a.continue=a.continuePrimaryKey=a.advance=u,e(t)}});return h.onsuccess=z(function(e){h.onsuccess=t,t()}),a.continue=r,a.continuePrimaryKey=i,a.advance=o,t(),n},e(a)):e(null)},s)})},count:function(e){var t=e.query,i=e.trans,o=t.index,u=t.range;return new Promise(function(e,t){var a=i.objectStore(n),s=o.isPrimaryKey?a:a.index(o.name);(s=(a=r(u))?s.count(a):s.count()).onsuccess=z(function(t){return e(t.target.result)}),s.onerror=Ee(t)})}}}),c={};return s.forEach(function(e){return c[e.name]=e}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!c[e])throw new Error("Table '".concat(e,"' not found"));return c[e]},MIN_KEY:-1/0,MAX_KEY:Rn(t),schema:n}}function De(e,t){var n=t.db;t=function(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=Re(t,i,r),e.dbcore.reduce(function(e,t){return t=t.create,ir(ir({},e),t(e))},r))}}(e._middlewares,n,e._deps,t),e.core=t.dbcore,e.tables.forEach(function(t){var n=t.name;e.core.schema.tables.some(function(e){return e.name===n})&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))})}function Me(e,t,n,r){n.forEach(function(n){var i=r[n];t.forEach(function(t){var r=function e(t,n){return jt(t,n)||(t=Kt(t))&&e(t,n)}(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?o(t,n,{get:function(){return this.table(n)},set:function(e){St(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))})})}function Fe(e,t){t.forEach(function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]})}function Ne(e,t){return e._cfg.version-t._cfg.version}function Le(e,t){var n,r,i,o,u,a,s,c,l,f={del:[],add:[],change:[]};for(n in e)t[n]||f.del.push(n);for(n in t)if(r=e[n],i=t[n],r)if(o={name:n,def:i,recreate:!1,del:[],add:[],change:[]},""+(r.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||r.primKey.auto!==i.primKey.auto)o.recreate=!0,f.change.push(o);else{for(s in u=r.idxByName,a=i.idxByName,s=void 0,u)a[s]||o.del.push(s);for(s in a)c=u[s],l=a[s],c?c.src!==l.src&&o.change.push(l):o.add.push(l);(0<o.del.length||0<o.add.length||0<o.change.length)&&f.change.push(o)}else f.add.push([n,i]);return f}function Ue(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){return ze(i,e)}),i}function Ve(e,t){ur(e).forEach(function(n){t.db.objectStoreNames.contains(n)||Ue(t,n,e[n].primKey,e[n].indexes)})}function ze(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Ye(e,t,n){var r={};return a(t.objectStoreNames,0).forEach(function(e){var t,i,o,u,a,s;for(i=Ae(Ce(s=(t=n.objectStore(e)).keyPath),s||"",!0,!1,!!t.autoIncrement,s&&"string"!=typeof s,!0),o=[],u=0;u<t.indexNames.length;++u)s=(a=t.index(t.indexNames[u])).keyPath,a=Ae(a.name,s,!!a.unique,!!a.multiEntry,!1,s&&"string"!=typeof s,!1),o.push(a);r[e]=Te(e,i,o)}),r}function We(e,t,n){var r,i,o,u,s,c,l,f;for(r=n.db.objectStoreNames,i=0;i<r.length;++i){o=r[i],u=n.objectStore(o),e._hasGetAll="getAll"in u;for(s=0;s<u.indexNames.length;++s)c=u.indexNames[s],f="string"==typeof(l=u.index(c).keyPath)?l:"["+a(l).join("+")+"]",!t[o]||(l=t[o].idxByName[f])&&(l.name=c,delete t[o].idxByName[f],t[o].idxByName[c]=l)}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&or.WorkerGlobalScope&&or instanceof or.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function $e(e){return e.split(",").map(function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Ae(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),ar(r),0===t)})}function Qe(){}function Ge(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Qn(kn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Xe(e){return e&&"function"==typeof e.databases}function He(e){return Y(function(){return an.letThrough=!0,e()})}function Je(e){return!("from"in e)}function Ze(e,n,r){var i,o=ie(n,r);if(!isNaN(o)){if(0<o)throw RangeError();if(Je(e))return t(e,{from:n,to:r,d:1});if(i=e.l,o=e.r,ie(r,e.from)<0)return i?Ze(i,n,r):e.l={from:n,to:r,d:1,l:null,r:null},rt(e);if(0<ie(n,e.to))return o?Ze(o,n,r):e.r={from:n,to:r,d:1,l:null,r:null},rt(e);ie(n,e.from)<0&&(e.from=n,e.l=null,e.d=o?o.d+1:1),0<ie(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,i&&!e.l&&et(e,i),o&&r&&et(e,o)}}function et(e,t){Je(t)||function e(t,n){var r=n.from,i=n.to,o=n.l;n=n.r,Ze(t,r,i),o&&e(t,o),n&&e(t,n)}(e,t)}function tt(e,t){var n,r,i,o,u=nt(t),a=u.next();if(a.done)return!1;for(n=a.value,o=(i=(r=nt(e)).next(n.from)).value;!a.done&&!i.done;){if(ie(o.from,n.to)<=0&&0<=ie(o.to,n.from))return!0;ie(n.from,o.from)<0?n=(a=u.next(o.from)).value:o=(i=r.next(n.from)).value}return!1}function nt(e){var t=Je(e)?null:{s:0,n:e};return{next:function(e){for(var n=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&ie(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||ie(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function rt(e){var t,n,r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),i=1<r?"r":r<-1?"l":"";i&&(t="r"==i?"l":"r",n=ir({},e),r=e[i],e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],(e[t]=n).d=it(n)),e.d=it(e)}function it(e){var t=e.r;return e=e.l,(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function ot(e,t){return ur(t).forEach(function(n){e[n]?et(e[n],t[n]):e[n]=function e(t){var n,i,o={};for(n in t)r(t,n)&&(i=t[n],o[n]=!i||"object"!=typeof i||qt.has(i.constructor)?i:e(i));return o}(t[n])}),e}function ut(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&tt(t[n],e[n])})}function at(e){ot(Ln,e),Un||(Un=!0,setTimeout(function(){Un=!1,st(Ln,!(Ln={}))},0))}function st(e,t){var n,r,i,o,u,a;if(void 0===t&&(t=!1),n=new Set,e.all)for(r=0,i=Object.values(Nn);r<i.length;r++)ct(u=i[r],e,n,t);else for(o in e)(a=/^idb\:\/\/(.*)\/(.*)\//.exec(o))&&(o=a[1],a=a[2],(u=Nn["idb://".concat(o,"/").concat(a)])&&ct(u,e,n,t));n.forEach(function(e){return e()})}function ct(e,t,n,r){var i,o,u,a,s,c,l,f,h,d,p,y;for(i=[],o=0,u=Object.entries(e.queries.query);o<u.length;o++){for(s=(a=u[o])[0],c=[],l=0,f=a[1];l<f.length;l++)ut(t,(h=f[l]).obsSet)?h.subscribers.forEach(function(e){return n.add(e)}):r&&c.push(h);r&&i.push([s,c])}if(r)for(d=0,p=i;d<p.length;d++)s=(y=p[d])[0],c=y[1],e.queries.query[s]=c}function lt(e){function t(t){return e.next(t)}function n(e){return function(t){var n=e(t);return t=n.value,n.done?t:t&&"function"==typeof t.then?t.then(r,i):ar(t)?Promise.all(t).then(r,i):r(t)}}var r=n(t),i=n(function(t){return e.throw(t)});return n(t)()}function ft(e,t,n){for(var r=ar(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function ht(e,t,n,i){return n=n||{},i=i||"",ur(e).forEach(function(o){var u,a,s;r(t,o)?(u=e[o],a=t[o],"object"==typeof u&&"object"==typeof a&&u&&a?(s=m(u))!==m(a)?n[i+o]=t[o]:"Object"===s?ht(u,a,n,i+o+"."):u!==a&&(n[i+o]=t[o]):u!==a&&(n[i+o]=t[o])):n[i+o]=void 0}),ur(t).forEach(function(o){r(e,o)||(n[i+o]=t[o])}),n}function dt(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function pt(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===ie(t.keys[i],e[o])&&(r.push(n?y(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(u){return null}}function yt(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function mt(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}function vt(e,t,n){if(0===n.numFailures)return t;if("deleteRange"===t.type)return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=ir({},t),ar(t.keys)&&(t.keys=t.keys.filter(function(e,t){return!(t in n.failures)})),"values"in t&&ar(t.values)&&(t.values=t.values.filter(function(e,t){return!(t in n.failures)})),t)}function bt(e,t){return n=e,(void 0===(r=t).lower||(r.lowerOpen?0<ie(n,r.lower):0<=ie(n,r.lower)))&&(void 0===t.upper||(t.upperOpen?ie(e,t.upper)<0:ie(e,t.upper)<=0));var n,r}function gt(e,t,n,r,i,o){if(!n||0===n.length)return e;var u=t.query.index,a=u.multiEntry,s=t.query.range,c=r.schema.primaryKey.extractKey,l=u.extractKey,f=(u.lowLevelIndex||u).extractKey;return(n=n.reduce(function(e,n){var r,i,o,u,f,h,d,p,y,m=e,v=[];if("add"===n.type||"put"===n.type)for(r=new Fn,i=n.values.length-1;0<=i;--i)u=n.values[i],f=c(u),r.hasKey(f)||(o=l(u),(a&&ar(o)?o.some(function(e){return bt(e,s)}):bt(o,s))&&(r.addKey(f),v.push(u)));switch(n.type){case"add":h=(new Fn).addKeys(t.values?e.map(function(e){return c(e)}):e),m=e.concat(t.values?v.filter(function(e){return e=c(e),!h.hasKey(e)&&(h.addKey(e),!0)}):v.map(function(e){return c(e)}).filter(function(e){return!h.hasKey(e)&&(h.addKey(e),!0)}));break;case"put":d=(new Fn).addKeys(n.values.map(function(e){return c(e)})),m=e.filter(function(e){return!d.hasKey(t.values?c(e):e)}).concat(t.values?v:v.map(function(e){return c(e)}));break;case"delete":p=(new Fn).addKeys(n.keys),m=e.filter(function(e){return!p.hasKey(t.values?c(e):e)});break;case"deleteRange":y=n.range,m=e.filter(function(e){return!bt(c(e),y)})}return m},e))===e?e:(n.sort(function(e,t){return ie(f(e),f(t))||ie(c(e),c(t))}),t.limit&&t.limit<1/0&&(n.length>t.limit?n.length=t.limit:e.length===t.limit&&n.length<t.limit&&(i.dirty=!0)),o?Object.freeze(n):n)}function wt(e,t){return 0===ie(e.lower,t.lower)&&0===ie(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function _t(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}function xt(e,t){var n,r,i,o,u,a,c,l,f=this;this._middlewares={},this.verno=0,n=xt.dependencies,this._options=t=ir({addons:xt.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},n=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,(c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:k,dbReadyPromise:null,cancelOpen:k,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen}).dbReadyPromise=new q(function(e){c.dbReadyResolve=e}),c.openCanceller=new q(function(e,t){c.cancelOpen=t}),this._state=c,this.name=e,this.on=se(this,"populate","blocked","versionchange","close",{ready:[C,k]}),this.on.ready.subscribe=s(this.on.ready.subscribe,function(e){return function(t,n){xt.vip(function(){var r,i=f._state;i.openComplete?(i.dbOpenError||q.resolve().then(t),n&&e(t)):i.onReadyBeingFired?(i.onReadyBeingFired.push(t),n&&e(t)):(e(t),r=f,n||e(function e(){r.on.ready.unsubscribe(t),r.on.ready.unsubscribe(e)}))})}}),this.Collection=(r=this,ce(jn.prototype,function(e,t){var n,i,o;if(this.db=r,n=Kn,i=null,t)try{n=t()}catch(u){i=u}e=(t=(o=e._ctx).table).hook.reading.fire,this._ctx={table:t,index:o.index,isPrimKey:!o.index||t.schema.primKey.keyPath&&o.index===t.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:e!==O?e:null}})),this.Table=(i=this,ce(En.prototype,function(e,t,n){this.db=i,this._tx=n,this.name=e,this.schema=t,this.hook=i._allTables[e]?i._allTables[e].hook:se(null,{creating:[E,k],reading:[P,O],updating:[j,k],deleting:[S,k]})})),this.Transaction=(o=this,ce(Bn.prototype,function(e,t,n,r,i){var u=this;this.db=o,this.mode=e,this.storeNames=t,this.schema=n,this.chromeTransactionDurability=r,this.idbtrans=null,this.on=se(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new q(function(e,t){u._resolve=e,u._reject=t}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(e){var t=u.active;return u.active=!1,u.on.error.fire(e),u.parent?u.parent._reject(e):t&&u.idbtrans&&u.idbtrans.abort(),bn(e)})})),this.Version=(u=this,ce(Mn.prototype,function(e){this.db=u,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(a=this,ce(Cn.prototype,function(e,t,n){if(this.db=a,this._ctx={table:e,index:":id"===t?null:t,or:n},this._cmp=this._ascending=ie,this._descending=function(e,t){return ie(t,e)},this._max=function(e,t){return 0<ie(e,t)?e:t},this._min=function(e,t){return ie(e,t)<0?e:t},this._IDBKeyRange=a._deps.IDBKeyRange,!this._IDBKeyRange)throw new Yt.MissingAPI})),this.on("versionchange",function(e){e.newVersion,f.close({disableAutoOpen:!1})}),this.on("blocked",function(e){!e.newVersion||(e.newVersion,e.oldVersion)}),this._maxKey=Rn(t.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new f.Transaction(e,t,n,f._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){f.on("blocked").fire(e),xn.filter(function(e){return e.name===f.name&&e!==f&&!e._state.vcFired}).map(function(t){return t.on("versionchange").fire(e)})},this.use(Yn),this.use($n),this.use(Wn),this.use(Vn),this.use(zn),l=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return _t(f.table(e),l)};var r=Reflect.get(e,t,n);return r instanceof En?_t(r,l):"tables"===t?r.map(function(e){return _t(e,l)}):"_createTransaction"===t?function(){return _t(r.apply(this,arguments),l)}:r}}),this.vip=l,n.forEach(function(e){return e(f)})}function kt(e){this._subscribe=e}function Ot(e){var t,n=!1,i=new Xn(function(i){var o,u,a,s,c,l=Ft(e),f=!1,h={},d={},p={get closed(){return f},unsubscribe:function(){f||(f=!0,o&&o.abort(),u&&In.storagemutated.unsubscribe(s))}};return i.start&&i.start(p),u=!1,a=function(){return ee(c)},s=function(e){ot(h,e),ut(d,h)&&a()},c=function(){var c,p,y;!f&&Gn.indexedDB&&(h={},c={},o&&o.abort(),o=new AbortController,y=function(t){var n,r=N();try{return l&&W(),n=Y(e,t),n=l?n.finally($):n}finally{r&&L()}}(p={subscr:c,signal:o.signal,requery:a,querier:e,trans:null}),Promise.resolve(y).then(function(e){n=!0,t=e,f||p.signal.aborted||(h={},function(e){for(var t in e)if(r(e,t))return;return 1}(d=c)||u||(In(Tn,s),u=!0),ee(function(){return!f&&i.next&&i.next(e)}))},function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||f||ee(function(){f||i.error&&i.error(e)})}))},setTimeout(a,0),p});return i.hasValue=function(){return n},i.getValue=function(){return t},i}function Pt(e){var t=Zn;try{Zn=!0,In.storagemutated.fire(e),st(e,!0)}finally{Zn=t}}var Kt,Et,St,jt,At,Ct,Tt,qt,It,Bt,Rt,Dt,Mt,Ft,Nt,Lt,Ut,Vt,zt,Yt,Wt,$t,Qt,Gt,Xt,Ht,Jt,Zt,en,tn,nn,rn,on,un,an,sn,cn,ln,fn,hn,dn,pn,yn,mn,vn,bn,gn,wn,_n,xn,kn,On,Pn,Kn,En,Sn,jn,An,Cn,Tn,qn,In,Bn,Rn,Dn,Mn,Fn,Nn,Ln,Un,Vn,zn,Yn,Wn,$n,Qn,Gn,Xn,Hn,Jn,Zn,er,tr,nr,rr=function(e,t){return(rr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},ir=function(){return(ir=Object.assign||function(e){var t,n,r,i;for(n=1,r=arguments.length;n<r;n++)for(i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},or="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:n,ur=Object.keys,ar=Array.isArray;"undefined"==typeof Promise||or.Promise||(or.Promise=Promise),Kt=Object.getPrototypeOf,Et={}.hasOwnProperty,St=Object.defineProperty,jt=Object.getOwnPropertyDescriptor,At=[].slice,Ct=[].concat,Tt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(p([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return or[e]}),qt=new Set(Tt.map(function(e){return or[e]})),It=null,Bt={}.toString,Rt="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",Dt="symbol"==typeof Rt?function(e){var t;return null!=e&&(t=e[Rt])&&t.apply(e)}:function(){return null},Mt={},Ft="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},Lt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Nt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),Ut={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"},u(g).from(Error).extend({toString:function(){return this.name+": "+this.message}}),u(_).from(g),u(x).from(g),Vt=Lt.reduce(function(e,t){return e[t]=t+"Error",e},{}),zt=g,Yt=Lt.reduce(function(e,t){function n(e,n){this.name=r,e?"string"==typeof e?(this.message="".concat(e).concat(n?"\n "+n:""),this.inner=n||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=Ut[t]||r,this.inner=null)}var r=t+"Error";return u(n).from(zt),e[t]=n,e},{}),Yt.Syntax=SyntaxError,Yt.Type=TypeError,Yt.Range=RangeError,Wt=Nt.reduce(function(e,t){return e[t+"Error"]=Yt[t],e},{}),$t=Lt.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Yt[t]),e},{}),$t.ModifyError=_,$t.DexieError=g,$t.BulkError=x,Qt="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href),Gt={},Xt=100,Nt=(Tt="undefined"==typeof Promise?[]:(nr=Promise.resolve(),"undefined"!=typeof crypto&&crypto.subtle?[tr=crypto.subtle.digest("SHA-512",new Uint8Array([0])),Kt(tr),nr]:[nr,Kt(nr),nr]))[0],Lt=Tt[1],Tt=Tt[2],Lt=Lt&&Lt.then,Ht=Nt&&Nt.constructor,Jt=!!Tt,Zt=function(e,t){sn.push([e,t]),tn&&(queueMicrotask(F),tn=!1)},en=!0,tn=!0,nn=[],rn=[],on=O,an=un={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:k,pgp:!1,env:{},finalize:k},sn=[],cn=0,ln=[],fn={get:function(){function e(e,r){var i=this,o=!t.global&&(t!==an||n!==mn),u=o&&!$(),a=new q(function(n,a){D(i,new I(Z(e,t,o,u),Z(r,t,o,u),n,a,t))});return this._consoleTask&&(a._consoleTask=this._consoleTask),a}var t=an,n=mn;return e.prototype=Gt,e},set:function(e){o(this,"then",e&&e.prototype===Gt?fn:{get:function(){return e},set:fn.set})}},i(q.prototype,{then:fn,_then:function(e,t){D(this,new I(null,null,e,t,an))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,n=arguments[1];return"function"==typeof t?this.then(null,function(e){return(e instanceof t?n:V)(e)}):this.then(null,function(e){return(e&&e.name===t?n:V)(e)})},finally:function(e){return this.then(function(t){return q.resolve(e()).then(function(){return t})},function(t){return q.resolve(e()).then(function(){return V(t)})})},timeout:function(e,t){var n=this;return e<1/0?new q(function(r,i){var o=setTimeout(function(){return i(new Yt.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&o(q.prototype,Symbol.toStringTag,"Dexie.Promise"),un.env=H(),i(q,{all:function(){var e=b.apply(null,arguments).map(Q);return new q(function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(function(i,o){return q.resolve(i).then(function(n){e[o]=n,--r||t(e)},n)})})},resolve:function(e){return e instanceof q?e:e&&"function"==typeof e.then?new q(function(t,n){e.then(t,n)}):new q(Gt,!0,e)},reject:V,race:function(){var e=b.apply(null,arguments).map(Q);return new q(function(t,n){e.map(function(e){return q.resolve(e).then(t,n)})})},PSD:{get:function(){return an},set:function(e){return an=e}},totalEchoes:{get:function(){return mn}},newPSD:Y,usePSD:J,scheduler:{get:function(){return Zt},set:function(e){Zt=e}},rejectionMapper:{get:function(){return on},set:function(e){on=e}},follow:function(e,t){return new q(function(n,r){return Y(function(t,n){var r=an;r.unhandleds=[],r.onunhandled=n,r.finalize=K(function(){var e,r=this;e=function(){0===r.unhandleds.length?t():n(r.unhandleds[0])},ln.push(function t(){e(),ln.splice(ln.indexOf(t),1)}),++cn,Zt(function(){0==--cn&&U()},[])},r.finalize),e()},t,n,r)})}}),Ht&&(Ht.allSettled&&o(q,"allSettled",function(){var e=b.apply(null,arguments).map(Q);return new q(function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach(function(e,i){return q.resolve(e).then(function(e){return r[i]={status:"fulfilled",value:e}},function(e){return r[i]={status:"rejected",reason:e}}).then(function(){return--n||t(r)})})})}),Ht.any&&"undefined"!=typeof AggregateError&&o(q,"any",function(){var e=b.apply(null,arguments).map(Q);return new q(function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(e,o){return q.resolve(e).then(function(e){return t(e)},function(e){i[o]=e,--r||n(new AggregateError(i))})})})}),Ht.withResolvers&&(q.withResolvers=Ht.withResolvers)),hn={awaits:0,echoes:0,id:0},dn=0,pn=[],yn=0,mn=0,vn=0,-1===(""+Lt).indexOf("[native code]")&&(W=$=k),bn=q.reject,gn=String.fromCharCode(65535),wn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",_n="String expected.",xn=[],kn="__dbnames",On="readonly",Pn="readwrite",Kn={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},ae.prototype._trans=function(e,t,n){function r(e,n,r){if(!r.schema[u])throw new Yt.NotFound("Table "+u+" not part of transaction");return t(r.idbtrans,r)}var i,o=this._tx||an.trans,u=this.name,a=Qt&&"undefined"!=typeof console&&console.createTask&&void 0,s=N();try{return i=o&&o.db._novip===this.db._novip?o===an.trans?o._promise(e,r,n):Y(function(){return o._promise(e,r,n)},{trans:o,transless:an.transless||an}):function e(t,n,r,i){if(t.idbdb&&(t._state.openComplete||an.letThrough||t._vip)){var o=t._createTransaction(n,r,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(u){return u.name===Vt.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(t.close({disableAutoOpen:!1}),t.open().then(function(){return e(t,n,r,i)})):bn(u)}return o._promise(n,function(e,t){return Y(function(){return an.trans=o,i(e,t,o)})}).then(function(e){if("readwrite"===n)try{o.idbtrans.commit()}catch(t){}return"readonly"===n?e:o._completion.then(function(){return e})})}if(t._state.openComplete)return bn(new Yt.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return bn(new Yt.DatabaseClosed);t.open().catch(k)}return t._state.dbReadyPromise.then(function(){return e(t,n,r,i)})}(this.db,e,[this.name],r),a&&(i._consoleTask=a,i=i.catch(function(e){return bn(e)})),i}finally{s&&L()}},ae.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?bn(new Yt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(t){return n.core.get({trans:t,key:e}).then(function(e){return n.hook.reading.fire(e)})}).then(t)},ae.prototype.where=function(e){function t(e,t){return 0===ie(e,t)}var n,r,i,o,u;return"string"==typeof e?new this.db.WhereClause(this,e):ar(e)?new this.db.WhereClause(this,"[".concat(e.join("+"),"]")):1===(n=ur(e)).length?this.where(n[0]).equals(e[n[0]]):(r=this.schema.indexes.concat(this.schema.primKey).filter(function(e){if(e.compound&&n.every(function(t){return 0<=e.keyPath.indexOf(t)})){for(var t=0;t<n.length;++t)if(-1===n.indexOf(e.keyPath[t]))return!1;return!0}return!1}).sort(function(e,t){return e.keyPath.length-t.keyPath.length})[0])&&this.db._maxKey!==gn?(i=r.keyPath.slice(0,n.length),this.where(i).equals(i.map(function(t){return e[t]}))):(o=this.schema.idxByName,i=(u=n.reduce(function(n,r){var i=n[0],u=n[1],a=(n=o[r],e[r]);return[i||n,i||!n?te(u,n&&n.multi?function(e){return e=f(e,r),ar(e)&&e.some(function(e){return t(a,e)})}:function(e){return t(a,f(e,r))}):u]},[null,null]))[0],u=u[1],i?this.where(i.name).equals(e[i.keyPath]).filter(u):r?this.filter(u):this.where(n).equals(""))},ae.prototype.filter=function(e){return this.toCollection().and(e)},ae.prototype.count=function(e){return this.toCollection().count(e)},ae.prototype.offset=function(e){return this.toCollection().offset(e)},ae.prototype.limit=function(e){return this.toCollection().limit(e)},ae.prototype.each=function(e){return this.toCollection().each(e)},ae.prototype.toArray=function(e){return this.toCollection().toArray(e)},ae.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ae.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,ar(e)?"[".concat(e.join("+"),"]"):e))},ae.prototype.reverse=function(){return this.toCollection().reverse()},ae.prototype.mapToClass=function(e){function t(){return null!==r&&r.apply(this,arguments)||this}function n(t){if(!t)return t;var n,r=Object.create(e.prototype);for(n in t)if(!i.has(n))try{r[n]=t[n]}catch(o){}return r}var r,i,o,u=this.db,a=this.name;for((this.schema.mappedClass=e).prototype instanceof re&&(function(e,t){function n(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");rr(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,r=e),Object.defineProperty(t.prototype,"db",{get:function(){return u},enumerable:!1,configurable:!0}),t.prototype.table=function(){return a},e=t),i=new Set,o=e.prototype;o;o=Kt(o))Object.getOwnPropertyNames(o).forEach(function(e){return i.add(e)});return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},ae.prototype.defineClass=function(){return this.mapToClass(function(e){t(this,e)})},ae.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=ne(o)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[u]})}).then(function(e){return e.numFailures?q.reject(e.failures[0]):e.lastResult}).then(function(t){if(o)try{h(e,o,t)}catch(n){}return t})},ae.prototype.update=function(e,t){return"object"!=typeof e||ar(e)?this.where(":id").equals(e).modify(t):void 0===(e=f(e,this.schema.primKey.keyPath))?bn(new Yt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},ae.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=ne(o)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"put",values:[u],keys:null!=t?[t]:null})}).then(function(e){return e.numFailures?q.reject(e.failures[0]):e.lastResult}).then(function(t){if(o)try{h(e,o,t)}catch(n){}return t})},ae.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(e){return e.numFailures?q.reject(e.failures[0]):void 0})},ae.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Kn})}).then(function(e){return e.numFailures?q.reject(e.failures[0]):void 0})},ae.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(e){return e.map(function(e){return t.hook.reading.fire(e)})})})},ae.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n,u=r.schema.primKey,a=u.auto;if((u=u.keyPath)&&i)throw new Yt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Yt.InvalidArgument("Arguments objects and keys must have the same length");return n=e.length,u=u&&a?e.map(ne(u)):e,r.core.mutate({trans:t,type:"add",keys:i,values:u,wantResults:o}).then(function(e){var t=e.numFailures,i=e.results,u=e.lastResult;if(e=e.failures,0===t)return o?i:u;throw new x("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(n," operations failed"),e)})})},ae.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n,u=r.schema.primKey,a=u.auto;if((u=u.keyPath)&&i)throw new Yt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Yt.InvalidArgument("Arguments objects and keys must have the same length");return n=e.length,u=u&&a?e.map(ne(u)):e,r.core.mutate({trans:t,type:"put",keys:i,values:u,wantResults:o}).then(function(e){var t=e.numFailures,i=e.results,u=e.lastResult;if(e=e.failures,0===t)return o?i:u;throw new x("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(n," operations failed"),e)})})},ae.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(e){return e.key}),i=e.map(function(e){return e.changes}),o=[];return this._trans("readwrite",function(u){return n.getMany({trans:u,keys:r,cache:"clone"}).then(function(a){var s,c=[],l=[];return e.forEach(function(e,n){var r,i,u,s,f=e.key,d=e.changes,p=a[n];if(p){for(r=0,i=Object.keys(d);r<i.length;r++)if(s=d[u=i[r]],u===t.schema.primKey.keyPath){if(0!==ie(s,f))throw new Yt.Constraint("Cannot update primary key in bulkUpdate()")}else h(p,u,s);o.push(n),c.push(f),l.push(p)}}),s=c.length,n.mutate({trans:u,type:"put",keys:c,values:l,updates:{keys:r,changeSpecs:i}}).then(function(e){var n,r,i,u,a,c=e.numFailures,l=e.failures;if(0===c)return s;for(n=0,r=Object.keys(l);n<r.length;n++)u=r[n],null!=(a=o[Number(u)])&&(i=l[u],delete l[u],l[a]=i);throw new x("".concat(t.name,".bulkUpdate(): ").concat(c," of ").concat(s," operations failed"),l)})})})},ae.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:e})}).then(function(e){var r=e.numFailures,i=e.lastResult;if(e=e.failures,0===r)return i;throw new x("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),e)})},En=ae,ve.prototype.execute=function(t){var n,r,i=this["@@propmod"];if(void 0!==i.add){if(n=i.add,ar(n))return e(e([],ar(t)?t:[],!0),n,!0).sort();if("number"==typeof n)return(Number(t)||0)+n;if("bigint"==typeof n)try{return BigInt(t)+n}catch(o){return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(void 0!==i.remove){if(r=i.remove,ar(r))return ar(t)?t.filter(function(e){return!r.includes(e)}).sort():[];if("number"==typeof r)return Number(t)-r;if("bigint"==typeof r)try{return BigInt(t)-r}catch(o){return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return(n=null===(n=i.replacePrefix)||void 0===n?void 0:n[0])&&"string"==typeof t&&t.startsWith(n)?i.replacePrefix[1]+t.substring(n.length):t},Sn=ve,be.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,bn.bind(null,n.error)):n.table._trans("readonly",e).then(t)},be.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,bn.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},be.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=te(t.algorithm,e)},be.prototype._iterate=function(e,t){return ye(this._ctx,e,t,this._ctx.table.core)},be.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&t(r,e),n._ctx=r,n},be.prototype.raw=function(){return this._ctx.valueMapper=null,this},be.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return ye(t,e,n,t.table.core)})},be.prototype.count=function(e){var t=this;return this._read(function(e){var n,r=t._ctx,i=r.table.core;return le(r,!0)?i.count({trans:e,query:{index:de(r,i.schema),range:r.range}}).then(function(e){return Math.min(e,r.limit)}):(n=0,ye(r,function(){return++n,!1},e,i).then(function(){return n}))}).then(e)},be.prototype.sortBy=function(e,t){function n(e,t){return t?n(e[i[t]],t-1):e[o]}function r(e,t){return ie(n(e,u),n(t,u))*a}var i=e.split(".").reverse(),o=i[0],u=i.length-1,a="next"===this._ctx.dir?1:-1;return this.toArray(function(e){return e.sort(r)}).then(t)},be.prototype.toArray=function(e){var t=this;return this._read(function(e){var n,r,i,o=t._ctx;return"next"===o.dir&&le(o,!0)&&0<o.limit?(n=o.valueMapper,r=de(o,o.table.core.schema),o.table.core.query({trans:e,limit:o.limit,values:!0,query:{index:r,range:o.range}}).then(function(e){return e=e.result,n?e.map(n):e})):(i=[],ye(o,function(e){return i.push(e)},e,o.table.core).then(function(){return i}))},e)},be.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,le(t)?he(t,function(){var t=e;return function(e,n){return 0===t||(1===t?--t:n(function(){e.advance(t),t=0}),!1)}}):he(t,function(){var t=e;return function(){return--t<0}})),this},be.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),he(this._ctx,function(){var t=e;return function(e,n,r){return--t<=0&&n(r),0<=t}},!0),this},be.prototype.until=function(e,t){return fe(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},be.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},be.prototype.last=function(e){return this.reverse().first(e)},be.prototype.filter=function(e){var t;return fe(this._ctx,function(t){return e(t.value)}),(t=this._ctx).isMatch=te(t.isMatch,e),this},be.prototype.and=function(e){return this.filter(e)},be.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},be.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},be.prototype.desc=function(){return this.reverse()},be.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},be.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},be.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},be.prototype.keys=function(e){var t,n=this._ctx;return n.keysOnly=!n.isMatch,t=[],this.each(function(e,n){t.push(n.key)}).then(function(){return t}).then(e)},be.prototype.primaryKeys=function(e){var t,n=this._ctx;return"next"===n.dir&&le(n,!0)&&0<n.limit?this._read(function(e){var t=de(n,n.table.core.schema);return n.table.core.query({trans:e,values:!1,limit:n.limit,query:{index:t,range:n.range}})}).then(function(e){return e.result}).then(e):(n.keysOnly=!n.isMatch,t=[],this.each(function(e,n){t.push(n.primaryKey)}).then(function(){return t}).then(e))},be.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},be.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},be.prototype.lastKey=function(e){return this.reverse().firstKey(e)},be.prototype.distinct=function(){var e,t=this._ctx;return(t=t.index&&t.table.schema.idxByName[t.index])&&t.multi?(e={},fe(this._ctx,function(t){var n=t.primaryKey.toString();return t=r(e,n),e[n]=!0,!t}),this):this},be.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){function i(e,t){var n,r,i,o=t.failures;for(t=t.numFailures,s+=e-t,n=0,r=ur(o);n<r.length;n++)i=r[n],a.push(o[i])}var o,u,a,s,c,l="function"==typeof e?e:(o=ur(e),u=o.length,function(t){var n,r,i,a,s;for(n=!1,r=0;r<u;++r)i=o[r],a=e[i],s=f(t,i),a instanceof Sn?(h(t,i,a.execute(s)),n=!0):s!==a&&(h(t,i,a),n=!0);return n}),d=n.table.core,p=d.schema.primaryKey,m=p.outbound,v=p.extractKey,b=200;return(p=t.db._options.modifyChunkSize)&&(b="object"==typeof p?p[d.name]||p["*"]||200:p),a=[],s=0,c=[],t.clone().primaryKeys().then(function(t){var o=le(n)&&n.limit===1/0&&("function"!=typeof e||e===An)&&{index:n.index,range:n.range};return function n(u){var a=Math.min(b,t.length-u);return d.getMany({trans:r,keys:t.slice(u,u+a),cache:"immutable"}).then(function(s){var c,f,h,p,g,w,_;for(c=[],f=[],h=m?[]:null,p=[],g=0;g<a;++g)_={value:y(w=s[g]),primKey:t[u+g]},!1!==l.call(_,_.value,_)&&(null==_.value?p.push(t[u+g]):m||0===ie(v(w),v(_.value))?(f.push(_.value),m&&h.push(t[u+g])):(p.push(t[u+g]),c.push(_.value)));return Promise.resolve(0<c.length&&d.mutate({trans:r,type:"add",values:c}).then(function(e){for(var t in e.failures)p.splice(parseInt(t),1);i(c.length,e)})).then(function(){return(0<f.length||o&&"object"==typeof e)&&d.mutate({trans:r,type:"put",keys:h,values:f,criteria:o,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:0<u}).then(function(e){return i(f.length,e)})}).then(function(){return(0<p.length||o&&e===An)&&d.mutate({trans:r,type:"delete",keys:p,criteria:o,isAdditionalChunk:0<u}).then(function(e){return i(p.length,e)})}).then(function(){return t.length>u+a&&n(u+b)})})}(0).then(function(){if(0<a.length)throw new _("Error modifying one or more objects",a,s,c);return t.length})})})},be.prototype.delete=function(){var e=this._ctx,t=e.range;return le(e)&&(e.isPrimKey||3===t.type)?this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(function(e){var n=e.failures;if(e.lastResult,e.results,e=e.numFailures)throw new _("Could not delete some values",Object.keys(n).map(function(e){return n[e]}),t-e);return t-e})})}):this.modify(An)},jn=be,An=function(e,t){return t.value=null},Object.defineProperty(Ke.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ke.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?xe(this):new this.Collection(this,function(){return Oe(e,t,!n,!r)})}catch(i){return _e(this,wn)}},Ke.prototype.equals=function(e){return null==e?_e(this,wn):new this.Collection(this,function(){return Pe(e)})},Ke.prototype.above=function(e){return null==e?_e(this,wn):new this.Collection(this,function(){return Oe(e,void 0,!0)})},Ke.prototype.aboveOrEqual=function(e){return null==e?_e(this,wn):new this.Collection(this,function(){return Oe(e,void 0,!1)})},Ke.prototype.below=function(e){return null==e?_e(this,wn):new this.Collection(this,function(){return Oe(void 0,e,!1,!0)})},Ke.prototype.belowOrEqual=function(e){return null==e?_e(this,wn):new this.Collection(this,function(){return Oe(void 0,e)})},Ke.prototype.startsWith=function(e){return"string"!=typeof e?_e(this,_n):this.between(e,e+gn,!0,!0)},Ke.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):ke(this,function(e,t){return 0===e.indexOf(t[0])},[e],gn)},Ke.prototype.equalsIgnoreCase=function(e){return ke(this,function(e,t){return e===t[0]},[e],"")},Ke.prototype.anyOfIgnoreCase=function(){var e=b.apply(Mt,arguments);return 0===e.length?xe(this):ke(this,function(e,t){return-1!==t.indexOf(e)},e,"")},Ke.prototype.startsWithAnyOfIgnoreCase=function(){var e=b.apply(Mt,arguments);return 0===e.length?xe(this):ke(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,gn)},Ke.prototype.anyOf=function(){var e,t,n=this,r=b.apply(Mt,arguments),i=this._cmp;try{r.sort(i)}catch(o){return _e(this,wn)}return 0===r.length?xe(this):((e=new this.Collection(this,function(){return Oe(r[0],r[r.length-1])}))._ondirectionchange=function(e){i="next"===e?n._ascending:n._descending,r.sort(i)},t=0,e._addAlgorithm(function(e,n,o){for(var u=e.key;0<i(u,r[t]);)if(++t===r.length)return n(o),!1;return 0===i(u,r[t])||(n(function(){e.continue(r[t])}),!1)}),e)},Ke.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ke.prototype.noneOf=function(){var e,t=b.apply(Mt,arguments);if(0===t.length)return new this.Collection(this);try{t.sort(this._ascending)}catch(n){return _e(this,wn)}return(e=t.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]},null)).push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},Ke.prototype.inAnyRange=function(e,t){function n(e,t){return u(e[0],t[0])}var r,i,o,u,a,s,c,l,f=this,h=this._cmp,d=this._ascending,p=this._descending,y=this._min,m=this._max;if(0===e.length)return xe(this);if(!e.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&d(e[0],e[1])<=0}))return _e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Yt.InvalidArgument);r=!t||!1!==t.includeLowers,i=t&&!0===t.includeUppers,u=d;try{(o=e.reduce(function(e,t){var n,r,i;for(n=0,r=e.length;n<r;++n)if(i=e[n],h(t[0],i[1])<0&&0<h(t[1],i[0])){i[0]=y(i[0],t[0]),i[1]=m(i[1],t[1]);break}return n===r&&e.push(t),e},[])).sort(n)}catch(v){return _e(this,wn)}return a=0,c=r?function(e){return 0<p(e,o[a][0])}:function(e){return 0<=p(e,o[a][0])},l=s=i?function(e){return 0<d(e,o[a][1])}:function(e){return 0<=d(e,o[a][1])},(e=new this.Collection(this,function(){return Oe(o[0][0],o[o.length-1][1],!r,!i)}))._ondirectionchange=function(e){u="next"===e?(l=s,d):(l=c,p),o.sort(n)},e._addAlgorithm(function(e,t,n){for(var r,i=e.key;l(i);)if(++a===o.length)return t(n),!1;return!s(r=i)&&!c(r)||(0===f._cmp(i,o[a][1])||0===f._cmp(i,o[a][0])||t(function(){u===d?e.continue(o[a][0]):e.continue(o[a][1])}),!1)}),e},Ke.prototype.startsWithAnyOf=function(){var e=b.apply(Mt,arguments);return e.every(function(e){return"string"==typeof e})?0===e.length?xe(this):this.inAnyRange(e.map(function(e){return[e,e+gn]})):_e(this,"startsWithAnyOf() only works with strings")},Cn=Ke,qn="x-storagemutated-1",In=se(null,Tn="storagemutated"),je.prototype._lock=function(){return c(!an.global),++this._reculock,1!==this._reculock||an.global||(an.lockOwnerFor=this),this},je.prototype._unlock=function(){if(c(!an.global),0==--this._reculock)for(an.global||(an.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{J(e[1],e[0])}catch(t){}}return this},je.prototype._locked=function(){return this._reculock&&an.lockOwnerFor!==this},je.prototype.create=function(e){var t,n,r=this;if(!this.mode)return this;if(t=this.db.idbdb,n=this.db._state.dbOpenError,c(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new Yt.DatabaseClosed(n);case"MissingAPIError":throw new Yt.MissingAPI(n.message,n);default:throw new Yt.OpenFailed(n)}if(!this.active)throw new Yt.TransactionInactive;return c(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||t).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=z(function(t){Se(t),r._reject(e.error)}),e.onabort=z(function(t){Se(t),r.active&&r._reject(new Yt.Abort(e.error)),r.active=!1,r.on("abort").fire(t)}),e.oncomplete=z(function(){r.active=!1,r._resolve(),"mutatedParts"in e&&In.storagemutated.fire(e.mutatedParts)}),this},je.prototype._promise=function(e,t,n){var r,i=this;return"readwrite"===e&&"readwrite"!==this.mode?bn(new Yt.ReadOnly("Transaction is readonly")):this.active?this._locked()?new q(function(r,o){i._blockedFuncs.push([function(){i._promise(e,t,n).then(r,o)},an])}):n?Y(function(){var e=new q(function(e,n){i._lock();var r=t(e,n,i);r&&r.then&&r.then(e,n)});return e.finally(function(){return i._unlock()}),e._lib=!0,e}):(r=new q(function(e,n){var r=t(e,n,i);r&&r.then&&r.then(e,n)}),r._lib=!0,r):bn(new Yt.TransactionInactive)},je.prototype._root=function(){return this.parent?this.parent._root():this},je.prototype.waitFor=function(e){var t,n,r=this._root(),i=q.resolve(e);return r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return i}):(r._waitingFor=i,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function e(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=e)}()),n=r._waitingFor,new q(function(e,t){i.then(function(t){return r._waitingQueue.push(z(e.bind(null,t)))},function(e){return r._waitingQueue.push(z(t.bind(null,e)))}).finally(function(){r._waitingFor===n&&(r._waitingFor=null)})})},je.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Yt.Abort))},je.prototype.table=function(e){var t,n=this._memoizedTables||(this._memoizedTables={});if(r(n,e))return n[e];if(!(t=this.schema[e]))throw new Yt.NotFound("Table "+e+" not part of transaction");return(t=new this.db.Table(e,t,this)).core=this.db.core.table(e),n[e]=t},Bn=je,Rn=function(e){try{return e.only([[]]),Rn=function(){return[[]]},[[]]}catch(t){return Rn=function(){return gn},gn}},Dn=0,Qe.prototype._parseStoresSpec=function(e,t){ur(e).forEach(function(n){if(null!==e[n]){var r=$e(e[n]),i=r.shift();if(i.unique=!0,i.multi)throw new Yt.Schema("Primary key cannot be multi-valued");r.forEach(function(e){if(e.auto)throw new Yt.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Yt.Schema("Index must have a name and cannot be an empty string")}),t[n]=Te(n,i,r)}})},Qe.prototype.stores=function(e){var n,r,i=this.db;return this._cfg.storesSource=this._cfg.storesSource?t(this._cfg.storesSource,e):e,e=i._versions,n={},r={},e.forEach(function(e){t(n,e._cfg.storesSource),r=e._cfg.dbschema={},e._parseStoresSpec(n,r)}),i._dbSchema=r,Fe(i,[i._allTables,i,i.Transaction.prototype]),Me(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],ur(r),r),i._storeNames=ur(r),this},Qe.prototype.upgrade=function(e){return this._cfg.contentUpgrade=C(this._cfg.contentUpgrade||k,e),this},Mn=Qe,Fn=function(e,n){if(!this){var r=new Fn;return e&&"d"in e&&t(r,e),r}t(this,arguments.length?{d:1,from:e,to:1<arguments.length?n:e}:{d:0})},i(Fn.prototype,((Lt={add:function(e){return et(this,e),this},addKey:function(e){return Ze(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(e){return Ze(t,e,e)}),this},hasKey:function(e){var t=nt(this).next(e).value;return t&&ie(t.from,e)<=0&&0<=ie(t.to,e)}})[Rt]=function(){return nt(this)},Lt)),Nn={},Ln={},Un=!1,Vn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return ir(ir({},e),{table:function(t){function n(e,t,r){var i=Be(e),o=c[i]=c[i]||[],u=null==e?0:"string"==typeof e?1:e.length,a=0<t;return a=ir(ir({},r),{name:a?"".concat(i,"(virtual-from:").concat(r.name,")"):r.name,lowLevelIndex:r,isVirtual:a,keyTail:t,keyLength:u,extractKey:qe(e),unique:!a&&r.unique}),o.push(a),a.isPrimaryKey||l.push(a),1<u&&n(2===u?e[0]:e.slice(0,u-1),t+1,r),o.sort(function(e,t){return e.keyTail-t.keyTail}),a}function r(t){var n,r=t.query.index;return r.isVirtual?ir(ir({},t),{query:{index:r.lowLevelIndex,range:(n=t.query.range,r=r.keyTail,{type:1===n.type?2:n.type,lower:ft(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,r),lowerOpen:!0,upper:ft(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,r),upperOpen:!0})}}):t}var i,o,u,a=e.table(t),s=a.schema,c={},l=[];for(t=n(s.primaryKey.keyPath,0,s.primaryKey),c[":id"]=[t],i=0,o=s.indexes;i<o.length;i++)n((u=o[i]).keyPath,0,u);return ir(ir({},a),{schema:ir(ir({},s),{primaryKey:t,indexes:l,getIndexByKeyPath:function(e){return(e=c[Be(e)])&&e[0]}}),count:function(e){return a.count(r(e))},query:function(e){return a.query(r(e))},openCursor:function(t){var n=t.query.index,i=n.keyTail,o=n.isVirtual,u=n.keyLength;return o?a.openCursor(r(t)).then(function(n){return n&&(r=n,Object.create(r,{continue:{value:function(n){null!=n?r.continue(ft(n,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?r.continue(r.key.slice(0,u).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):r.continue()}},continuePrimaryKey:{value:function(t,n){r.continuePrimaryKey(ft(t,e.MAX_KEY,i),n)}},primaryKey:{get:function(){return r.primaryKey}},key:{get:function(){var e=r.key;return 1===u?e[0]:e.slice(0,u)}},value:{get:function(){return r.value}}}));var r}):a.openCursor(t)}})}})}},zn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return ir(ir({},t),{table:function(n){var i=t.table(n),o=i.schema.primaryKey;return ir(ir({},i),{mutate:function(t){function u(t){var n,u,a,s=an.trans,d=t.keys||dt(o,t);if(!d)throw new Error("Keys missing");return"delete"!==(t="add"===t.type||"put"===t.type?ir(ir({},t),{keys:d}):ir({},t)).type&&(t.values=e([],t.values,!0)),t.keys&&(t.keys=e([],t.keys,!0)),n=i,a=d,("add"===(u=t).type?Promise.resolve([]):n.getMany({trans:u.trans,keys:a,cache:"immutable"})).then(function(e){var n=d.map(function(n,i){var u,a,d,p=e[i],y={onerror:null,onsuccess:null};return"delete"===t.type?c.fire.call(y,n,p,s):"add"===t.type||void 0===p?(u=l.fire.call(y,n,t.values[i],s),null==n&&null!=u&&(t.keys[i]=n=u,o.outbound||h(t.values[i],o.keyPath,n))):(u=ht(p,t.values[i]),(a=f.fire.call(y,u,n,p,s))&&(d=t.values[i],Object.keys(a).forEach(function(e){r(d,e)?d[e]=a[e]:h(d,e,a[e])}))),y});return i.mutate(t).then(function(r){var i,o,u,a,s,c;for(i=r.failures,o=r.results,u=r.numFailures,r=r.lastResult,a=0;a<d.length;++a)s=(o||d)[a],c=n[a],null==s?c.onerror&&c.onerror(i[a]):c.onsuccess&&c.onsuccess("put"===t.type&&e[a]?t.values[a]:s);return{failures:i,results:o,numFailures:u,lastResult:r}}).catch(function(e){return n.forEach(function(t){return t.onerror&&t.onerror(e)}),Promise.reject(e)})})}var a=an.trans,s=a.table(n).hook,c=s.deleting,l=s.creating,f=s.updating;switch(t.type){case"add":if(l.fire===k)break;return a._promise("readwrite",function(){return u(t)},!0);case"put":if(l.fire===k&&f.fire===k)break;return a._promise("readwrite",function(){return u(t)},!0);case"delete":if(c.fire===k)break;return a._promise("readwrite",function(){return u(t)},!0);case"deleteRange":if(c.fire===k)break;return a._promise("readwrite",function(){return function e(t,n,r){return i.query({trans:t,values:!1,query:{index:o,range:n},limit:r}).then(function(i){var o=i.result;return u({type:"delete",keys:o,trans:t}).then(function(i){return 0<i.numFailures?Promise.reject(i.failures[0]):o.length<r?{failures:[],numFailures:0,lastResult:void 0}:e(t,ir(ir({},n),{lower:o[o.length-1],lowerOpen:!0}),r)})})}(t.trans,t.range,1e4)},!0)}return i.mutate(t)}})}})}},Yn={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return ir(ir({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=pt(e.keys,e.trans._cache,"clone"===e.cache);return t?q.resolve(t):n.getMany(e).then(function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?y(t):t},t})},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}},Wn={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Fn(e.MIN_KEY,e.MAX_KEY);return ir(ir({},e),{transaction:function(t,n,r){if(an.subscr&&"readonly"!==n)throw new Yt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(an.querier));return e.transaction(t,n,r)},table:function(r){var i=e.table(r),o=i.schema,u=o.primaryKey,a=o.indexes,s=u.extractKey,c=u.outbound,l=u.autoIncrement&&a.filter(function(e){return e.compound&&e.keyPath.includes(u.keyPath)}),f=ir(ir({},i),{mutate:function(a){function s(e){return e="idb://".concat(t,"/").concat(r,"/").concat(e),p[e]||(p[e]=new Fn)}var c,f,h,d=a.trans,p=a.mutatedParts||(a.mutatedParts={}),y=s(""),m=s(":dels"),v=a.type,b=(w="deleteRange"===a.type?[a.range]:"delete"===a.type?[a.keys]:a.values.length<50?[dt(u,a).filter(function(e){return e}),a.values]:[])[0],g=w[1],w=a.trans._cache;return ar(b)?(y.addKeys(b),(w="delete"===v||b.length===g.length?pt(b,w):null)||m.addKeys(b),(w||g)&&(c=s,f=w,h=g,o.indexes.forEach(function(e){function t(t){return null!=t?e.extractKey(t):null}function n(t){return e.multiEntry&&ar(t)?t.forEach(function(e){return r.addKey(e)}):r.addKey(t)}var r=c(e.name||"");(f||h).forEach(function(e,r){var i=f&&t(f[r]);0!==ie(i,r=h&&t(h[r]))&&(null!=i&&n(i),null!=r&&n(r))})}))):b?(g={from:null!==(g=b.lower)&&void 0!==g?g:e.MIN_KEY,to:null!==(g=b.upper)&&void 0!==g?g:e.MAX_KEY},m.add(g),y.add(g)):(y.add(n),m.add(n),o.indexes.forEach(function(e){return s(e.name).add(n)})),i.mutate(a).then(function(e){return!b||"add"!==a.type&&"put"!==a.type||(y.addKeys(e.results),l&&l.forEach(function(t){for(var n=a.values.map(function(e){return t.extractKey(e)}),r=t.keyPath.findIndex(function(e){return e===u.keyPath}),i=0,o=e.results.length;i<o;++i)n[i][r]=e.results[i];s(t.name).addKeys(n)})),d.mutatedParts=ot(d.mutatedParts||{},p),e})}}),h={get:function(e){return[u,new Fn(e.key)]},getMany:function(e){return[u,(new Fn).addKeys(e.keys)]},count:a=function(t){t=(n=t.query).index;var n=n.range;return[t,new Fn(null!==(t=n.lower)&&void 0!==t?t:e.MIN_KEY,null!==(n=n.upper)&&void 0!==n?n:e.MAX_KEY)]},query:a,openCursor:a};return ur(h).forEach(function(e){f[e]=function(o){var u,a,l,f,d=an.subscr,p=!!d,y=yt(an,i)&&mt(e,o)?o.obsSet={}:d;if(p&&(a=(u=function(e){return e="idb://".concat(t,"/").concat(r,"/").concat(e),y[e]||(y[e]=new Fn)})(""),l=u(":dels"),p=(d=h[e](o))[0],d=d[1],("query"===e&&p.isPrimaryKey&&!o.values?l:u(p.name||"")).add(d),!p.isPrimaryKey)){if("count"!==e)return f="query"===e&&c&&o.values&&i.query(ir(ir({},o),{values:!1})),i[e].apply(this,arguments).then(function(t){var n,r,i;if("query"===e){if(c&&o.values)return f.then(function(e){return e=e.result,a.addKeys(e),t});n=o.values?t.result.map(s):t.result,(o.values?a:l).addKeys(n)}else if("openCursor"===e)return r=t,i=o.values,r&&Object.create(r,{key:{get:function(){return l.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return l.addKey(e),e}},value:{get:function(){return i&&a.addKey(r.primaryKey),r.value}}});return t});l.add(n)}return i[e].apply(this,arguments)}}),f}})}},$n={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return ir(ir({},e),{transaction:function(n,r,i){var o,u,a=e.transaction(n,r,i);return"readwrite"===r&&(u=(o=new AbortController).signal,i=function(i){return function(){var u,s,c,l,f,h,d,p,y,m,b,g,w,_,x,k,O,P;if(o.abort(),"readwrite"===r){for(u=new Set,s=0,c=n;s<c.length;s++)if(l=c[s],f=Nn["idb://".concat(t,"/").concat(l)])if(h=e.table(l),d=f.optimisticOps.filter(function(e){return e.trans===a}),a._explicit&&i&&a.mutatedParts)for(p=0,y=Object.values(f.queries.query);p<y.length;p++)for(m=0,b=(_=y[p]).slice();m<b.length;m++)ut((x=b[m]).obsSet,a.mutatedParts)&&(v(_,x),x.subscribers.forEach(function(e){return u.add(e)}));else if(0<d.length)for(f.optimisticOps=f.optimisticOps.filter(function(e){return e.trans!==a}),g=0,w=Object.values(f.queries.query);g<w.length;g++)for(O=0,P=(_=w[g]).slice();O<P.length;O++)null!=(x=P[O]).res&&a.mutatedParts&&(i&&!x.dirty?(k=Object.isFrozen(x.res),k=gt(x.res,x.req,d,h,x,k),x.dirty?(v(_,x),x.subscribers.forEach(function(e){return u.add(e)})):k!==x.res&&(x.res=k,x.promise=q.resolve({result:k}))):(x.dirty&&v(_,x),x.subscribers.forEach(function(e){return u.add(e)})));u.forEach(function(e){return e()})}}},a.addEventListener("abort",i(!1),{signal:u}),a.addEventListener("error",i(!1),{signal:u}),a.addEventListener("complete",i(!0),{signal:u})),a},table:function(n){var r=e.table(n),i=r.schema.primaryKey;return ir(ir({},r),{mutate:function(e){var o,u=an.trans;return i.outbound||"disabled"===u.db._options.cache||u.explicit||"readwrite"!==u.idbtrans.mode?r.mutate(e):(o=Nn["idb://".concat(t,"/").concat(n)])?(u=r.mutate(e),"add"!==e.type&&"put"!==e.type||!(50<=e.values.length||dt(i,e).some(function(e){return null==e}))?(o.optimisticOps.push(e),e.mutatedParts&&at(e.mutatedParts),u.then(function(t){0<t.numFailures&&(v(o.optimisticOps,e),(t=vt(0,e,t))&&o.optimisticOps.push(t),e.mutatedParts&&at(e.mutatedParts))}),u.catch(function(){v(o.optimisticOps,e),e.mutatedParts&&at(e.mutatedParts)})):u.then(function(t){var n=vt(0,ir(ir({},e),{values:e.values.map(function(e,n){var r;return t.failures[n]||h(e=null!==(r=i.keyPath)&&void 0!==r&&r.includes(".")?y(e):ir({},e),i.keyPath,t.results[n]),e})}),t);o.optimisticOps.push(n),queueMicrotask(function(){return e.mutatedParts&&at(e.mutatedParts)})}),u):r.mutate(e)},query:function(e){if(!yt(an,r)||!mt("query",e))return r.query(e);var i="immutable"===(null===(a=an.trans)||void 0===a?void 0:a.db._options.cache),o=(c=an).requery,u=c.signal,a=function(e,t,n,r){var i,o,u=Nn["idb://".concat(e,"/").concat(t)];if(!u)return[];if(!(t=u.queries[n]))return[null,!1,u,null];if(!(i=t[(r.query?r.query.index.name:null)||""]))return[null,!1,u,null];switch(n){case"query":return(o=i.find(function(e){return e.req.limit===r.limit&&e.req.values===r.values&&wt(e.req.query.range,r.query.range)}))?[o,!0,u,i]:[i.find(function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&function(e,t){return function(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;if(0===(t=ie(e,t))){if(n&&r)return 0;if(n)return 1;if(r)return-1}return t}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;if(0===(t=ie(e,t))){if(n&&r)return 0;if(n)return-1;if(r)return 1}return t}(e.upper,t.upper,e.upperOpen,t.upperOpen)}(e.req.query.range,r.query.range)}),!1,u,i];case"count":return[o=i.find(function(e){return wt(e.req.query.range,r.query.range)}),!!o,u,i]}}(t,n,"query",e),s=a[0],c=a[1],l=a[2],f=a[3];return s&&c?s.obsSet=e.obsSet:(c=r.query(e).then(function(e){var t,n,r=e.result;if(s&&(s.res=r),i){for(t=0,n=r.length;t<n;++t)Object.freeze(r[t]);Object.freeze(r)}else e.result=y(r);return e}).catch(function(e){return f&&s&&v(f,s),Promise.reject(e)}),s={obsSet:e.obsSet,promise:c,subscribers:new Set,type:"query",req:e,dirty:!1},f?f.push(s):(f=[s],(l=l||(Nn["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[e.query.index.name||""]=f)),function(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var r,i;e.subscribers.delete(n),0===e.subscribers.size&&(r=e,i=t,setTimeout(function(){0===r.subscribers.size&&v(i,r)},3e3))})}(s,f,o,u),s.promise.then(function(t){return{result:gt(t.result,e,null==l?void 0:l.optimisticOps,r,s,i)}})}})}})}},xt.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Yt.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Yt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(t){return t._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Ne),n.stores({}),this._state.autoSchema=!1,n)},xt.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||an.letThrough||this._vip)?e():new q(function(e,n){if(t._state.openComplete)return n(new Yt.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new Yt.DatabaseClosed);t.open().catch(k)}t._state.dbReadyPromise.then(e,n)}).then(e)},xt.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;return i&&this.unuse({stack:t,name:i}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:n,level:null==r?10:r,name:i}),e.sort(function(e,t){return e.level-t.level}),this},xt.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return r?e.create!==r:!!n&&e.name!==n})),this},xt.prototype.open=function(){var e=this;return J(un,function(){return function(e){function t(){if(l.openCanceller!==n)throw new Yt.DatabaseClosed("db.open() was cancelled")}var n,r,i,o,u,s,c,l=e._state,f=e._deps.indexedDB;return l.isBeingOpened||e.idbdb?l.dbReadyPromise.then(function(){return l.dbOpenError?bn(l.dbOpenError):e}):(l.isBeingOpened=!0,l.dbOpenError=null,l.openComplete=!1,n=l.openCanceller,r=Math.round(10*e.verno),i=!1,u=l.dbReadyResolve,s=null,c=!1,q.race([n,("undefined"==typeof navigator?q.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){function t(){return indexedDB.databases().finally(e)}o=setInterval(t,100),t()}).finally(function(){return clearInterval(o)}):Promise.resolve()).then(function n(){return new q(function(o,u){if(t(),!f)throw new Yt.MissingAPI;var h=e.name,p=l.autoSchema||!r?f.open(h):f.open(h,r);if(!p)throw new Yt.MissingAPI;p.onerror=Ee(u),p.onblocked=z(e._fireOnBlocked),p.onupgradeneeded=z(function(t){var n;s=p.transaction,l.autoSchema&&!e._options.allowEmptyDB?(p.onerror=Se,s.abort(),p.result.close(),(n=f.deleteDatabase(h)).onsuccess=n.onerror=z(function(){u(new Yt.NoSuchDatabase("Database ".concat(h," doesnt exist")))})):(s.onerror=Ee(u),t=t.oldVersion>Math.pow(2,62)?0:t.oldVersion,c=t<1,e.idbdb=p.result,i&&function(e,t){var n,r,i,o;for(Ve(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version"),n=Ye(0,e.idbdb,t),We(e,e._dbSchema,t),r=0,i=Le(n,e._dbSchema).change;r<i.length;r++)if("object"==typeof(o=function(e){if(e.change.length||e.recreate)return{value:void 0};var n=t.objectStore(e.name);e.add.forEach(function(e){ze(n,e)})}(i[r])))return o.value}(e,s),function(e,t,n,r){var i,o,u,a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=Te("$meta",$e("")[0],[]),e._storeNames.push("$meta")),(i=e._createTransaction("readwrite",e._storeNames,a)).create(n),i._completion.catch(r),o=i._reject.bind(i),u=an.transless||an,Y(function(){return an.trans=i,an.transless=u,0!==t?(De(e,n),s=t,((r=i).storeNames.includes("$meta")?r.table("$meta").get("version").then(function(e){return null!=e?e:s}):q.resolve(s)).then(function(t){return o=t,u=i,a=n,s=[],t=(r=e)._versions,c=r._dbSchema=Ye(0,r.idbdb,a),0!==(t=t.filter(function(e){return e._cfg.version>=o})).length?(t.forEach(function(e){s.push(function(){var t,n,i,s,l,f=c,h=e._cfg.dbschema;if(We(r,f,a),We(r,h,a),c=r._dbSchema=h,(t=Le(f,h)).add.forEach(function(e){Ue(a,e[0],e[1].primKey,e[1].indexes)}),t.change.forEach(function(e){if(e.recreate)throw new Yt.Upgrade("Not yet support for changing primary key");var t=a.objectStore(e.name);e.add.forEach(function(e){return ze(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),ze(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})}),(n=e._cfg.contentUpgrade)&&e._cfg.version>o)return De(r,a),u._memoizedTables={},i=d(h),t.del.forEach(function(e){i[e]=f[e]}),Fe(r,[r.Transaction.prototype]),Me(r,[r.Transaction.prototype],ur(i),i),u.schema=i,(l=Ft(n))&&W(),t=q.follow(function(){var e;(s=n(u))&&l&&(e=$.bind(null,null),s.then(e,e))}),s&&"function"==typeof s.then?q.resolve(s):t.then(function(){return s})}),s.push(function(t){var n,i,o=e._cfg.dbschema;n=o,i=t,[].slice.call(i.db.objectStoreNames).forEach(function(e){return null==n[e]&&i.db.deleteObjectStore(e)}),Fe(r,[r.Transaction.prototype]),Me(r,[r.Transaction.prototype],r._storeNames,r._dbSchema),u.schema=r._dbSchema}),s.push(function(t){r.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(r.idbdb.version/10)===e._cfg.version?(r.idbdb.deleteObjectStore("$meta"),delete r._dbSchema.$meta,r._storeNames=r._storeNames.filter(function(e){return"$meta"!==e})):t.objectStore("$meta").put(e._cfg.version,"version"))})}),function e(){return s.length?q.resolve(s.shift()(u.idbtrans)).then(e):q.resolve()}().then(function(){Ve(c,a)})):q.resolve();var r,o,u,a,s,c}).catch(o)):(ur(a).forEach(function(e){Ue(n,e,a[e].primKey,a[e].indexes)}),De(e,n),void q.follow(function(){return e.on.populate.fire(i)}).catch(o));var r,s})}(e,t/10,s,u))},u),p.onsuccess=z(function(){var t,u,f,d,y,m,v,b;if(s=null,0<(v=a((m=e.idbdb=p.result).objectStoreNames)).length)try{if(b=m.transaction(1===(d=v).length?d[0]:d,"readonly"),l.autoSchema)u=m,f=b,(t=e).verno=u.version/10,f=t._dbSchema=Ye(0,u,f),t._storeNames=a(u.objectStoreNames,0),Me(t,[t._allTables],ur(f),f);else if(We(e,e._dbSchema,b),((y=Le(Ye(0,(y=e).idbdb,b),y._dbSchema)).add.length||y.change.some(function(e){return e.add.length||e.change.length}))&&!i)return m.close(),r=m.version+1,i=!0,o(n());De(e,b)}catch(g){}xn.push(e),m.onversionchange=z(function(t){l.vcFired=!0,e.on("versionchange").fire(t)}),m.onclose=z(function(t){e.on("close").fire(t)}),c&&(y=e._deps,b=h,m=y.indexedDB,y=y.IDBKeyRange,Xe(m)||b===kn||Ge(m,y).put({name:b}).catch(k)),o()},u)}).catch(function(e){switch(null==e?void 0:e.name){case"UnknownError":if(0<l.PR1398_maxLoop)return l.PR1398_maxLoop--,n();break;case"VersionError":if(0<r)return r=0,n()}return q.reject(e)})})]).then(function(){return t(),l.onReadyBeingFired=[],q.resolve(He(function(){return e.on.ready.fire(e.vip)})).then(function t(){if(0<l.onReadyBeingFired.length){var n=l.onReadyBeingFired.reduce(C,k);return l.onReadyBeingFired=[],q.resolve(He(function(){return n(e.vip)})).then(t)}})}).finally(function(){l.openCanceller===n&&(l.onReadyBeingFired=null,l.isBeingOpened=!1)}).catch(function(t){l.dbOpenError=t;try{s&&s.abort()}catch(r){}return n===l.openCanceller&&e._close(),bn(t)}).finally(function(){l.openComplete=!0,u()}).then(function(){var t;return c&&(t={},e.tables.forEach(function(n){n.schema.indexes.forEach(function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new Fn(-1/0,[[[]]]))}),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new Fn(-1/0,[[[]]])}),In(Tn).fire(t),st(t,!0)),e}))}(e)})},xt.prototype._close=function(){var e=this._state,t=xn.indexOf(this);if(0<=t&&xn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(n){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new q(function(t){e.dbReadyResolve=t}),e.openCanceller=new q(function(t,n){e.cancelOpen=n}))},xt.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen;e=this._state,t?(e.isBeingOpened&&e.cancelOpen(new Yt.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new Yt.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},xt.prototype.delete=function(e){var t,n,r=this;return void 0===e&&(e={disableAutoOpen:!0}),t=0<arguments.length&&"object"!=typeof arguments[0],n=this._state,new q(function(i,o){function u(){r.close(e);var t=r._deps.indexedDB.deleteDatabase(r.name);t.onsuccess=z(function(){var e,t,n;e=r._deps,t=r.name,n=e.indexedDB,e=e.IDBKeyRange,Xe(n)||t===kn||Ge(n,e).delete(t).catch(k),i()}),t.onerror=Ee(o),t.onblocked=r._fireOnBlocked}if(t)throw new Yt.InvalidArgument("Invalid closeOptions argument to db.delete()");n.isBeingOpened?n.dbReadyPromise.then(u):u()})},xt.prototype.backendDB=function(){return this.idbdb},xt.prototype.isOpen=function(){return null!==this.idbdb},xt.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},xt.prototype.hasFailed=function(){return null!==this._state.dbOpenError},xt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(xt.prototype,"tables",{get:function(){var e=this;return ur(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),xt.prototype.transaction=function(){var e=function(e,t,n){var r,i=arguments.length;if(i<2)throw new Yt.InvalidArgument("Too few arguments");for(r=new Array(i-1);--i;)r[i-1]=arguments[i];return n=r.pop(),[e,p(r),n]}.apply(this,arguments);return this._transaction.apply(this,e)},xt.prototype._transaction=function(e,t,n){var r,i,o,u,a=this,s=an.trans;s&&s.db===this&&-1===e.indexOf("!")||(s=null),o=-1!==e.indexOf("?"),e=e.replace("!","").replace("?","");try{if(i=t.map(function(e){if("string"!=typeof(e=e instanceof a.Table?e.name:e))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e}),"r"==e||e===On)r=On;else{if("rw"!=e&&e!=Pn)throw new Yt.InvalidArgument("Invalid transaction mode: "+e);r=Pn}if(s){if(s.mode===On&&r===Pn){if(!o)throw new Yt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&i.forEach(function(e){if(s&&-1===s.storeNames.indexOf(e)){if(!o)throw new Yt.SubTransaction("Table "+e+" not included in parent transaction.");s=null}}),o&&s&&!s.active&&(s=null)}}catch(c){return s?s._promise(null,function(e,t){t(c)}):bn(c)}return u=function e(t,n,r,i,o){return q.resolve().then(function(){var u,a,s=an.transless||an,c=t._createTransaction(n,r,t._dbSchema,i);if(c.explicit=!0,s={trans:c,transless:s},i)c.idbtrans=i.idbtrans;else try{c.create(),c.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(l){return l.name===Vt.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(t.close({disableAutoOpen:!1}),t.open().then(function(){return e(t,n,r,null,o)})):bn(l)}return(a=Ft(o))&&W(),s=q.follow(function(){var e;(u=o.call(c,c))&&(a?(e=$.bind(null,null),u.then(e,e)):"function"==typeof u.next&&"function"==typeof u.throw&&(u=lt(u)))},s),(u&&"function"==typeof u.then?q.resolve(u).then(function(e){return c.active?e:bn(new Yt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):s.then(function(){return u})).then(function(e){return i&&c._resolve(),c._completion.then(function(){return e})}).catch(function(e){return c._reject(e),bn(e)})})}.bind(null,this,r,i,s,n),s?s._promise(r,u,"lock"):an.trans?J(an.transless,function(){return a._whenReady(u)}):this._whenReady(u)},xt.prototype.table=function(e){if(!r(this._allTables,e))throw new Yt.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Qn=xt,Lt="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",kt.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},kt.prototype[Lt]=function(){return this},Xn=kt;try{Gn={indexedDB:or.indexedDB||or.mozIndexedDB||or.webkitIndexedDB||or.msIndexedDB,IDBKeyRange:or.IDBKeyRange||or.webkitIDBKeyRange}}catch(nr){Gn={indexedDB:null,IDBKeyRange:null}}return i(Hn=Qn,ir(ir({},$t),{delete:function(e){return new Hn(e,{addons:[]}).delete()},exists:function(e){return new Hn(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return n=(t=Hn.dependencies).indexedDB,t=t.IDBKeyRange,(Xe(n)?Promise.resolve(n.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==kn})}):Ge(n,t).toCollection().primaryKeys()).then(e)}catch(r){return bn(new Yt.MissingAPI)}var t,n},defineClass:function(){return function(e){t(this,e)}},ignoreTransaction:function(e){return an.trans?J(an.transless,e):e()},vip:He,async:function(e){return function(){try{var t=lt(e.apply(this,arguments));return t&&"function"==typeof t.then?t:q.resolve(t)}catch(n){return bn(n)}}},spawn:function(e,t,n){try{var r=lt(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:q.resolve(r)}catch(i){return bn(i)}},currentTransaction:{get:function(){return an.trans||null}},waitFor:function(e,t){return t=q.resolve("function"==typeof e?Hn.ignoreTransaction(e):e).timeout(t||6e4),an.trans?an.trans.waitFor(t):t},Promise:q,debug:{get:function(){return Qt},set:function(e){T(e)}},derive:u,extend:t,props:i,override:s,Events:se,on:In,liveQuery:Ot,extendObservabilitySet:ot,getByKeyPath:f,setByKeyPath:h,delByKeyPath:function(e,t){"string"==typeof t?h(e,t,void 0):"length"in t&&[].map.call(t,function(t){h(e,t,void 0)})},shallowClone:d,deepClone:y,getObjectDiff:ht,cmp:ie,asap:l,minKey:-1/0,addons:[],connections:xn,errnames:Vt,dependencies:Gn,cache:Nn,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Hn.maxKey=Rn(Hn.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(In(Tn,function(e){Zn||(e=new CustomEvent(qn,{detail:e}),Zn=!0,dispatchEvent(e),Zn=!1)}),addEventListener(qn,function(e){e=e.detail,Zn||Pt(e)})),Zn=!1,er=function(){},"undefined"!=typeof BroadcastChannel&&((er=function(){(Jn=new BroadcastChannel(qn)).onmessage=function(e){return e.data&&Pt(e.data)}})(),"function"==typeof Jn.unref&&Jn.unref(),In(Tn,function(e){Zn||Jn.postMessage(e)})),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",function(e){if(!Qn.disableBfCache&&e.persisted){null!=Jn&&Jn.close();for(var t=0,n=xn;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Qn.disableBfCache&&e.persisted&&(er(),Pt({all:new Fn(-1/0,[[]])}))})),q.rejectionMapper=function(e,t){return!e||e instanceof g||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Wt[e.name]?e:(t=new Wt[e.name](t||e.message,e),"stack"in e&&o(t,"stack",{get:function(){return this.inner.stack}}),t)},T(Qt),ir(Qn,Object.freeze({__proto__:null,Dexie:Qn,liveQuery:Ot,Entity:re,cmp:ie,PropModification:Sn,replacePrefix:function(e,t){return new Sn({replacePrefix:[e,t]})},add:function(e){return new Sn({add:e})},remove:function(e){return new Sn({remove:e})},default:Qn,RangeSet:Fn,mergeRanges:et,rangesOverlap:tt}),{default:Qn}),Qn}()),r.exports)),o=Symbol.for("Dexie"),u=globalThis[o]||(globalThis[o]=i);if(i.semVer!==u.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${i.semVer} and ${u.semVer}`);const{liveQuery:a,mergeRanges:s,rangesOverlap:c,RangeSet:l,cmp:f,Entity:h,PropModification:d,replacePrefix:p,add:y,remove:m}=u;export{u as D,e as g};
